{"version":3,"sources":["../static/js/5.fb635d13.chunk.js","screens/journey/JourneyDetailScreen.js","assets/images/portrait-whiteblack.jpg","assets/images/journey/plan-detail-edit-white@2x.png","assets/images/journey/plan-detail-map-white@2x.png","assets/images/journey/modifyInfo@2x.png","assets/images/journey/plan-detail-day@2x.png","assets/images/journey/icon_plan_bus.png"],"names":["webpackJsonp","892","module","__webpack_exports__","__webpack_require__","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","defineProperty","__WEBPACK_IMPORTED_MODULE_0_antd_mobile_lib_modal_style_css__","__WEBPACK_IMPORTED_MODULE_1_antd_mobile_lib_modal__","n","__WEBPACK_IMPORTED_MODULE_1_antd_mobile_lib_modal___default","__WEBPACK_IMPORTED_MODULE_2_antd_mobile_lib_activity_indicator_style_css__","__WEBPACK_IMPORTED_MODULE_3_antd_mobile_lib_activity_indicator__","__WEBPACK_IMPORTED_MODULE_3_antd_mobile_lib_activity_indicator___default","__WEBPACK_IMPORTED_MODULE_4_antd_mobile_lib_nav_bar_style_css__","__WEBPACK_IMPORTED_MODULE_5_antd_mobile_lib_nav_bar__","__WEBPACK_IMPORTED_MODULE_5_antd_mobile_lib_nav_bar___default","__WEBPACK_IMPORTED_MODULE_6_antd_mobile_lib_icon_style_css__","__WEBPACK_IMPORTED_MODULE_7_antd_mobile_lib_icon__","__WEBPACK_IMPORTED_MODULE_7_antd_mobile_lib_icon___default","__WEBPACK_IMPORTED_MODULE_8_antd_mobile_lib_toast_style_css__","__WEBPACK_IMPORTED_MODULE_9_antd_mobile_lib_toast__","__WEBPACK_IMPORTED_MODULE_9_antd_mobile_lib_toast___default","__WEBPACK_IMPORTED_MODULE_10_react__","__WEBPACK_IMPORTED_MODULE_10_react___default","__WEBPACK_IMPORTED_MODULE_11_react_redux__","__WEBPACK_IMPORTED_MODULE_12__views_common_Content__","__WEBPACK_IMPORTED_MODULE_13__core_utils_SysUtil__","__WEBPACK_IMPORTED_MODULE_14__core_utils_IConstant__","__WEBPACK_IMPORTED_MODULE_15_react_dom__","__WEBPACK_IMPORTED_MODULE_15_react_dom___default","__WEBPACK_IMPORTED_MODULE_16__core_utils_HttpClient__","__WEBPACK_IMPORTED_MODULE_17__store_actions_journey_detailAction__","_createClass","defineProperties","target","props","i","length","descriptor","key","protoProps","staticProps","JourneyDetailScreen","_PureComponent","this","_this","getPrototypeOf","journeyTrafficMapTapped","bind","journeyEditTapped","journeyAddTapped","journeyMapLineTapped","doJourneyAdd","goBack","editTitle","headerInfo","dispatch","match","params","journeyId","restoreScrollViewPosition","map","undefined","prevProps","prevState","snapshot","groupList","searchStarted","searchDriveRoute","baiduMapInited","targetJourneyId","a","success","history","replace","_this2","createElement","mode","className","icon","type","onLeftClick","rightContent","style","display","alignItems","height","isMine","onClick","src","alt","ref","view","scrollView","getWrappedInstance","renderHeaderViews","renderGroupViews","isFetching","toast","text","id","_this3","headImg","userImagePath","TourName","CreateDate","BeginDate","split","_this4","group","index","renderGroupView","_this5","planDate","Date","addDays","formatDate","renderGroupHeaderView","item","itemIndex","renderItemView","groupIndex","_this6","getItemIcon","showItemDetail","Name","getItemPlayTime","flex","getPriceValue","getPriceUnit","Address","Telephone","backgroundImage","GetImage","SmallImageFrontUrl","renderTrafficInfoView","_this7","trafficInfo","trafficInfos","_itemType","getItemType","cacheScrollOffset","You","push","Code","Zhu","CanTing","Yu","Gou","PlayTime","BusinesTime","Price","parseFloat","PType","offsetY","findDOMNode","scrollTop","isNaN","scrollViewOffset","scrollToY","_this8","window","BMap","Map","nextGroupIndex","nextItemIndex","startItem","endItem","isValidAddressItem","options","onSearchComplete","results","driving","getStatus","BMAP_STATUS_SUCCESS","plan","getPlan","getDuration","getDistance","DrivingRoute","search","Point","Longitude","Latitude","alert","onPress","_this9","prompt","onChangeName","PlanMainID","_this10","kvDict","planMainID","title","postToPortal","JOURNEY","UpdateTourTitle","then","resp","json","pathname","state","code","mapStateToProps","ownProps","obj","journey","detailScreen","userInfo","getUserInfo","system","UserID","ID","UserAvatar","911","exports","p","951","952","953","954","955"],"mappings":"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","file":"static/js/5.fb635d13.chunk.js","sourcesContent":["webpackJsonp([5],{\n\n/***/ 892:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_antd_mobile_lib_modal_style_css__ = __webpack_require__(39);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_antd_mobile_lib_modal_style_css___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_antd_mobile_lib_modal_style_css__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_antd_mobile_lib_modal__ = __webpack_require__(40);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_antd_mobile_lib_modal___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_antd_mobile_lib_modal__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_antd_mobile_lib_activity_indicator_style_css__ = __webpack_require__(16);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_antd_mobile_lib_activity_indicator_style_css___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_antd_mobile_lib_activity_indicator_style_css__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_antd_mobile_lib_activity_indicator__ = __webpack_require__(17);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_antd_mobile_lib_activity_indicator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_antd_mobile_lib_activity_indicator__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_antd_mobile_lib_nav_bar_style_css__ = __webpack_require__(11);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_antd_mobile_lib_nav_bar_style_css___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_antd_mobile_lib_nav_bar_style_css__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_antd_mobile_lib_nav_bar__ = __webpack_require__(12);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_antd_mobile_lib_nav_bar___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_antd_mobile_lib_nav_bar__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_antd_mobile_lib_icon_style_css__ = __webpack_require__(18);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_antd_mobile_lib_icon_style_css___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_antd_mobile_lib_icon_style_css__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_antd_mobile_lib_icon__ = __webpack_require__(19);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_antd_mobile_lib_icon___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_antd_mobile_lib_icon__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_antd_mobile_lib_toast_style_css__ = __webpack_require__(28);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_antd_mobile_lib_toast_style_css___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_8_antd_mobile_lib_toast_style_css__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_antd_mobile_lib_toast__ = __webpack_require__(29);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_antd_mobile_lib_toast___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_9_antd_mobile_lib_toast__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_react__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_react___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_10_react__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11_react_redux__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__views_common_Content__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__core_utils_SysUtil__ = __webpack_require__(15);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__core_utils_IConstant__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15_react_dom__ = __webpack_require__(14);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15_react_dom___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_15_react_dom__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16__core_utils_HttpClient__ = __webpack_require__(8);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_17__store_actions_journey_detailAction__ = __webpack_require__(296);\nvar _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if(\"value\"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError(\"Cannot call a class as a function\");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");}return call&&(typeof call===\"object\"||typeof call===\"function\")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!==\"function\"&&superClass!==null){throw new TypeError(\"Super expression must either be null or a function, not \"+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var JourneyDetailScreen=function(_PureComponent){_inherits(JourneyDetailScreen,_PureComponent);function JourneyDetailScreen(props){_classCallCheck(this,JourneyDetailScreen);var _this=_possibleConstructorReturn(this,(JourneyDetailScreen.__proto__||Object.getPrototypeOf(JourneyDetailScreen)).call(this,props));_this.journeyTrafficMapTapped=_this.journeyTrafficMapTapped.bind(_this);_this.journeyEditTapped=_this.journeyEditTapped.bind(_this);_this.journeyAddTapped=_this.journeyAddTapped.bind(_this);_this.journeyMapLineTapped=_this.journeyMapLineTapped.bind(_this);_this.doJourneyAdd=_this.doJourneyAdd.bind(_this);_this.goBack=_this.goBack.bind(_this);_this.editTitle=_this.editTitle.bind(_this);return _this;}_createClass(JourneyDetailScreen,[{key:'componentDidMount',value:function componentDidMount(){if(!this.props.headerInfo){this.props.dispatch(Object(__WEBPACK_IMPORTED_MODULE_17__store_actions_journey_detailAction__[\"b\" /* asyncGetDetailAction */])(this.props.match.params.journeyId));}this.restoreScrollViewPosition();}},{key:'componentWillUnmount',value:function componentWillUnmount(){this.map=undefined;}},{key:'componentDidUpdate',value:function componentDidUpdate(prevProps,prevState,snapshot){// 行程详情接口返回数据后，查询交通\nif(this.props.groupList&&!prevProps.groupList){if(!this.searchStarted){this.searchDriveRoute(this.props.groupList,0,0);}}// 百度地图初始化完成后，查询交通\nelse if(this.props.baiduMapInited&&!prevProps.baiduMapInited){if(!this.searchStarted){this.searchDriveRoute(this.props.groupList||prevProps.groupList,0,0);}}if(this.props.targetJourneyId&&!prevProps.targetJourneyId){__WEBPACK_IMPORTED_MODULE_9_antd_mobile_lib_toast___default.a.success('复制成功!');this.searchStarted=false;this.props.history.replace('/journey/detail/'+this.props.targetJourneyId);}if(this.props.match.params.journeyId!==prevProps.match.params.journeyId){this.props.dispatch(Object(__WEBPACK_IMPORTED_MODULE_17__store_actions_journey_detailAction__[\"b\" /* asyncGetDetailAction */])(this.props.match.params.journeyId));}}},{key:'render',value:function render(){var _this2=this;return __WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',null,__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_5_antd_mobile_lib_nav_bar___default.a,{mode:'dark',className:'navBar',icon:__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_7_antd_mobile_lib_icon___default.a,{type:'left'}),onLeftClick:this.goBack,rightContent:__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{style:{display:'flex',alignItems:'center',height:'100%'}},this.props.isMine?__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{className:'journeyDetailRightContentButton',onClick:function onClick(){return _this2.journeyEditTapped();}},__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('img',{className:'journeyDetailRightContentImage',src:__webpack_require__(951),alt:''})):__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{className:'journeyDetailRightContentButton',onClick:function onClick(){return _this2.journeyAddTapped();}},__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('img',{className:'journeyDetailRightContentImage',src:__webpack_require__(287),alt:''})),__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{className:'journeyDetailRightContentButton',onClick:function onClick(){return _this2.journeyMapLineTapped();}},__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('img',{className:'journeyDetailRightContentImage',src:__webpack_require__(952),alt:''})))},'\\u884C\\u7A0B\\u8BE6\\u60C5'),__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_12__views_common_Content__[\"a\" /* default */],{ref:function ref(view){_this2.scrollView=view?view.getWrappedInstance():_this2.scrollView;}},__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{className:'journeyDetailHeaderBg'},this.renderHeaderViews()),this.renderGroupViews(),this.props.isFetching?__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_3_antd_mobile_lib_activity_indicator___default.a,{toast:true,text:'Loading...'}):null,__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{id:'journey_detail_map',style:{display:'none'}})));}},{key:'renderHeaderViews',value:function renderHeaderViews(){var _this3=this;if(!this.props.headerInfo){return null;}return __WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{className:'journeyDetailHeader'},__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('img',{className:'journeyDetailHeaderImage',src:this.props.headerInfo&&this.props.headerInfo.headImg?this.props.headerInfo.headImg:this.props.userImagePath,alt:''}),__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{className:'journeyDetailHeaderTextDiv'},__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{className:'journeyDetailHeaderText2'},this.props.headerInfo.TourName),__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('img',{className:'journeyEditTitleImage',onClick:function onClick(){return _this3.editTitle();},src:__webpack_require__(953),alt:''})),__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{className:'journeyDetailHeaderText'},'\\u7F16\\u53F7: ',this.props.headerInfo.CreateDate.replace(/-/g,'').replace(/:/g,'').replace(' ','')),__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{className:'journeyDetailHeaderText'},'\\u884C\\u7A0B\\u5929\\u6570\\uFF1A',this.props.groupList.length,'\\u5929'),__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{className:'journeyDetailHeaderText'},'\\u51FA\\u53D1\\u65F6\\u95F4\\uFF1A',this.props.headerInfo.BeginDate.split('T')[0]));}},{key:'renderGroupViews',value:function renderGroupViews(){var _this4=this;if(!this.props.groupList||this.props.groupList.length===0){return null;}return this.props.groupList.map(function(group,index){return _this4.renderGroupView(group,index);});}},{key:'renderGroupView',value:function renderGroupView(group,index){var _this5=this;var planDate=new Date(this.props.headerInfo.BeginDate.replace(' ','T')).addDays(index).formatDate('YYYY-MM-DD');return __WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{key:index},this.renderGroupHeaderView(planDate,index),group.map(function(item,itemIndex){return _this5.renderItemView(item,index,itemIndex);}));}},{key:'renderGroupHeaderView',value:function renderGroupHeaderView(planDate,index){return __WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{className:'journeyDetailGroupHeader'},__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{className:'journeyDetailGroupHeaderRow'},__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('img',{className:'journeyDetailGroupHeaderIcon',src:__webpack_require__(954),alt:''}),__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{className:'journeyDetailGroupHeaderText'},'\\u7B2C',index+1,'\\u5929(',planDate,')')));}},{key:'renderItemView',value:function renderItemView(item,groupIndex,itemIndex){var _this6=this;var icon=this.getItemIcon(item);return __WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{key:itemIndex},__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{className:'journeyDetailItemRow',onClick:function onClick(){_this6.showItemDetail(item);}},__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('img',{className:'journeyDetailItemIcon',src:icon,alt:''}),__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{className:'journeyDetailItemRightRow'},__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{className:'journeyDetailItemRightTopRow'},__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{className:'journeyDetailItemTitleRow'},__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{className:'journeyDetailItemTitle'},item.Name),__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{className:'journeyDetailItemPlayTime'},this.getItemPlayTime(item))),__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{style:{flex:1}}),__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{className:'journeyDetailItemPrice'},__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{className:'journeyDetailItemPriceValue'},this.getPriceValue(item)),__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{className:'journeyDetailItemPriceUnit'},this.getPriceUnit(item))),__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('img',{className:'journeyIndexHeaderArrow',src:__webpack_require__(55),alt:''})),__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{className:'journeyDetailItemPlayTime'},'\\u5730\\u5740\\uFF1A',item.Address),item.Telephone&&item.Telephone.length>0?__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{className:'journeyDetailItemPlayTime'},'\\u7535\\u8BDD\\uFF1A',item.Telephone):null,__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{className:'journeyDetailItemImage',style:{backgroundImage:'url('+item.GetImage.SmallImageFrontUrl+')'}}))),this.renderTrafficInfoView(groupIndex,itemIndex));}},{key:'renderTrafficInfoView',value:function renderTrafficInfoView(groupIndex,itemIndex){var _this7=this;var trafficInfo=this.props.trafficInfos[groupIndex+'_'+itemIndex];if(!trafficInfo||trafficInfo.length===0){return null;}return __WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{className:'journeyDetailTrafficRow',onClick:function onClick(){return _this7.journeyTrafficMapTapped(groupIndex,itemIndex);}},__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{className:'journeyDetailTrafficInfo'},__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('img',{className:'journeyDetailTrafficInfoIcon',src:__webpack_require__(955),alt:''}),__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{className:'journeyDetailTrafficInfoText'},trafficInfo)));}},{key:'showItemDetail',value:function showItemDetail(item){var _itemType=this.getItemType(item);this.cacheScrollOffset();if(_itemType===__WEBPACK_IMPORTED_MODULE_14__core_utils_IConstant__[\"h\" /* ItemType */].You){this.props.history.push('/scenic/detail/'+item.Code);}else if(_itemType===__WEBPACK_IMPORTED_MODULE_14__core_utils_IConstant__[\"h\" /* ItemType */].Zhu){this.props.history.push('/hotel/detail/'+item.Code);}else if(_itemType===__WEBPACK_IMPORTED_MODULE_14__core_utils_IConstant__[\"h\" /* ItemType */].CanTing){this.props.history.push('/restaurant/detail/'+item.Code);}else if(_itemType===__WEBPACK_IMPORTED_MODULE_14__core_utils_IConstant__[\"h\" /* ItemType */].Yu){this.props.history.push('/fun/detail/'+item.Code);}else if(_itemType===__WEBPACK_IMPORTED_MODULE_14__core_utils_IConstant__[\"h\" /* ItemType */].Gou){this.props.history.push('/shopping/detail/'+item.Code);}}// 针对 item 提供的便利方法\n},{key:'getItemPlayTime',value:function getItemPlayTime(item){var _itemType=this.getItemType(item);if(_itemType===__WEBPACK_IMPORTED_MODULE_14__core_utils_IConstant__[\"h\" /* ItemType */].You){return item.PlayTime?'建议游玩'+item.PlayTime+'小时':'';}if(_itemType===__WEBPACK_IMPORTED_MODULE_14__core_utils_IConstant__[\"h\" /* ItemType */].Zhu){return item.PlayTime?'时间：'+item.PlayTime:'';}return'营业时间：'+(item.BusinesTime&&item.BusinesTime.length>0?item.BusinesTime:'全天');}},{key:'getItemIcon',value:function getItemIcon(item){var _itemType=this.getItemType(item);if(_itemType===__WEBPACK_IMPORTED_MODULE_14__core_utils_IConstant__[\"h\" /* ItemType */].You){return __webpack_require__(297);}if(_itemType===__WEBPACK_IMPORTED_MODULE_14__core_utils_IConstant__[\"h\" /* ItemType */].Zhu){return __webpack_require__(298);}if(_itemType===__WEBPACK_IMPORTED_MODULE_14__core_utils_IConstant__[\"h\" /* ItemType */].CanTing){return __webpack_require__(299);}if(_itemType===__WEBPACK_IMPORTED_MODULE_14__core_utils_IConstant__[\"h\" /* ItemType */].Yu){return __webpack_require__(301);}return __webpack_require__(300);}},{key:'getPriceValue',value:function getPriceValue(item){var _itemType=this.getItemType(item);if(item.Price===null||parseFloat(item.Price)===0){return'免费';}if(_itemType===__WEBPACK_IMPORTED_MODULE_14__core_utils_IConstant__[\"h\" /* ItemType */].Gou){return'';}return'￥'+item.Price;}},{key:'getPriceUnit',value:function getPriceUnit(item){var _itemType=this.getItemType(item);if(item.Price===null||parseFloat(item.Price)===0){return'';}if(_itemType===__WEBPACK_IMPORTED_MODULE_14__core_utils_IConstant__[\"h\" /* ItemType */].Gou){return'';}if(_itemType===__WEBPACK_IMPORTED_MODULE_14__core_utils_IConstant__[\"h\" /* ItemType */].Zhu){return'起';}return'/人';}},{key:'getItemType',value:function getItemType(item){if(item.PType==='JQ'){return __WEBPACK_IMPORTED_MODULE_14__core_utils_IConstant__[\"h\" /* ItemType */].You;}if(item.PType==='JD'){return __WEBPACK_IMPORTED_MODULE_14__core_utils_IConstant__[\"h\" /* ItemType */].Zhu;}if(item.PType==='CT'){return __WEBPACK_IMPORTED_MODULE_14__core_utils_IConstant__[\"h\" /* ItemType */].CanTing;}if(item.PType==='TL'||item.PType==='YL'){return __WEBPACK_IMPORTED_MODULE_14__core_utils_IConstant__[\"h\" /* ItemType */].Yu;}return __WEBPACK_IMPORTED_MODULE_14__core_utils_IConstant__[\"h\" /* ItemType */].Gou;}// 缓存位置\n},{key:'cacheScrollOffset',value:function cacheScrollOffset(){var offsetY=__WEBPACK_IMPORTED_MODULE_15_react_dom___default.a.findDOMNode(this.scrollView).scrollTop;this.props.dispatch(Object(__WEBPACK_IMPORTED_MODULE_17__store_actions_journey_detailAction__[\"e\" /* setDetailScrollerPositionAction */])(this.props.match.params.journeyId,offsetY));}},{key:'restoreScrollViewPosition',value:function restoreScrollViewPosition(){if(this.scrollView){if(!isNaN(this.props.scrollViewOffset)){this.scrollView.scrollToY(this.props.scrollViewOffset);}else{this.scrollView.scrollToY(0);}}}// 驾车查询\n},{key:'searchDriveRoute',value:function searchDriveRoute(groupList,groupIndex,itemIndex){var _this8=this;if(!window.BMap||!groupList||groupList.length===0||groupIndex>=groupList.length){return;}this.searchStarted=true;// 是否已经开始执行查询交通了\nthis.map=this.map?this.map:new window.BMap.Map('journey_detail_map');var nextGroupIndex=groupIndex;var nextItemIndex=itemIndex+1;if(nextItemIndex>=groupList[groupIndex].length-1){nextGroupIndex+=1;nextItemIndex=0;}var startItem=groupList[groupIndex][itemIndex];var endItem=groupList[groupIndex][itemIndex+1];if(!this.isValidAddressItem(startItem)||!this.isValidAddressItem(endItem)){this.searchDriveRoute(groupList,nextGroupIndex,nextItemIndex);return;}var options={onSearchComplete:function onSearchComplete(results){if(driving.getStatus()===window.BMAP_STATUS_SUCCESS){var plan=results.getPlan(0);var trafficInfo='\\u9A7E\\u8F66 '+plan.getDuration(true)+', '+plan.getDistance(true);var trafficInfos=Object.assign({},_this8.props.trafficInfos);trafficInfos[groupIndex+'_'+itemIndex]=trafficInfo;_this8.props.dispatch(Object(__WEBPACK_IMPORTED_MODULE_17__store_actions_journey_detailAction__[\"f\" /* setTrafficInfosAction */])(_this8.props.match.params.journeyId,trafficInfos));_this8.searchDriveRoute(groupList,nextGroupIndex,nextItemIndex);}}};var driving=new window.BMap.DrivingRoute(this.map,options);driving.search(new window.BMap.Point(startItem.Longitude,startItem.Latitude),new window.BMap.Point(endItem.Longitude,endItem.Latitude));}},{key:'isValidAddressItem',value:function isValidAddressItem(item){return item&&item.Longitude&&item.Latitude&&(item.Longitude+'').length>0&&(item.Latitude+'').length>0&&!isNaN(item.Longitude)&&!isNaN(item.Latitude);}// 行程驾车导航\n},{key:'journeyTrafficMapTapped',value:function journeyTrafficMapTapped(groupIndex,itemIndex){var startItem=this.props.groupList[groupIndex][itemIndex];var endItem=this.props.groupList[groupIndex][itemIndex+1];if(this.isValidAddressItem(startItem)&&this.isValidAddressItem(endItem)){this.cacheScrollOffset();this.props.history.push('/map/mapNav/'+this.props.match.params.journeyId+'/'+startItem.Latitude+'/'+startItem.Longitude+'?fromLat='+endItem.Latitude+'&fromLng='+endItem.Longitude);return;}}//添加推荐行程\n},{key:'journeyAddTapped',value:function journeyAddTapped(){__WEBPACK_IMPORTED_MODULE_1_antd_mobile_lib_modal___default.a.alert('行程复制','是否复制到我的行程?',[{text:'取消',style:'default'},{text:'OK',onPress:this.doJourneyAdd}]);}},{key:'editTitle',value:function editTitle(){var _this9=this;__WEBPACK_IMPORTED_MODULE_1_antd_mobile_lib_modal___default.a.prompt('修改行程名称','给你的行程起个响亮的名字',[{text:'取消'},{text:'确认',onPress:function onPress(value){return _this9.onChangeName(_this9.props.headerInfo.PlanMainID,value);}}],'plain-text',this.props.headerInfo.TourName);}},{key:'onChangeName',value:function onChangeName(id,value){var _this10=this;var kvDict={planMainID:id,title:value};__WEBPACK_IMPORTED_MODULE_16__core_utils_HttpClient__[\"a\" /* default */].postToPortal(__WEBPACK_IMPORTED_MODULE_14__core_utils_IConstant__[\"q\" /* PortalApis */].JOURNEY.UpdateTourTitle,kvDict,null,true).then(function(resp){return resp.json();}).then(function(resp){if(resp){_this10.props.dispatch(Object(__WEBPACK_IMPORTED_MODULE_17__store_actions_journey_detailAction__[\"b\" /* asyncGetDetailAction */])(_this10.props.match.params.journeyId));}});}},{key:'doJourneyAdd',value:function doJourneyAdd(){this.props.dispatch(Object(__WEBPACK_IMPORTED_MODULE_17__store_actions_journey_detailAction__[\"a\" /* asyncCopyToMineAction */])(this.props.match.params.journeyId));}//行程编辑 点击\n},{key:'journeyEditTapped',value:function journeyEditTapped(){this.cacheScrollOffset();this.props.history.push({pathname:'/journey/edit',state:{code:this.props.match.params.journeyId,groupList:this.props.groupList,headerInfo:this.props.headerInfo}});}// 行程地图 \n},{key:'journeyMapLineTapped',value:function journeyMapLineTapped(){this.cacheScrollOffset();this.props.history.push({pathname:'/journey/mapLine',state:{code:this.props.match.params.journeyId,groupList:this.props.groupList}});}},{key:'goBack',value:function goBack(){var journeyId=this.props.match.params.journeyId;var dispatch=this.props.dispatch;this.props.history.goBack();dispatch(Object(__WEBPACK_IMPORTED_MODULE_17__store_actions_journey_detailAction__[\"d\" /* goBackAction */])(journeyId));}}]);return JourneyDetailScreen;}(__WEBPACK_IMPORTED_MODULE_10_react__[\"PureComponent\"]);var mapStateToProps=function mapStateToProps(state,ownProps){var obj=state.journey.detailScreen[ownProps.match.params.journeyId];var userInfo=__WEBPACK_IMPORTED_MODULE_13__core_utils_SysUtil__[\"a\" /* default */].getUserInfo(state);var props=Object.assign({},obj,{baiduMapInited:state.system.baiduMapInited,userImagePath:__webpack_require__(911),userInfo:userInfo});if(obj&&obj.headerInfo){props.isMine=obj.headerInfo.UserID===userInfo.ID;props.userImagePath=props.isMine?userInfo.UserAvatar:obj.headerInfo.headImg?obj.headerInfo.headImg:__webpack_require__(911);}return props;};JourneyDetailScreen=Object(__WEBPACK_IMPORTED_MODULE_11_react_redux__[\"b\" /* connect */])(mapStateToProps)(JourneyDetailScreen);/* harmony default export */ __webpack_exports__[\"default\"] = (JourneyDetailScreen);\n\n/***/ }),\n\n/***/ 911:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__.p + \"static/media/portrait-whiteblack.fba26053.jpg\";\n\n/***/ }),\n\n/***/ 951:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__.p + \"static/media/plan-detail-edit-white@2x.dfd223f6.png\";\n\n/***/ }),\n\n/***/ 952:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__.p + \"static/media/plan-detail-map-white@2x.b2c77e80.png\";\n\n/***/ }),\n\n/***/ 953:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__.p + \"static/media/modifyInfo@2x.121083cf.png\";\n\n/***/ }),\n\n/***/ 954:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__.p + \"static/media/plan-detail-day@2x.f1ad1a5e.png\";\n\n/***/ }),\n\n/***/ 955:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__.p + \"static/media/icon_plan_bus.0ea92f29.png\";\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/js/5.fb635d13.chunk.js","import React, { PureComponent } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { NavBar, Icon, ActivityIndicator, Modal, Toast } from 'antd-mobile';\r\nimport Content from '../../views/common/Content';\r\nimport SysUtil from '../../core/utils/SysUtil';\r\nimport { ItemType } from '../../core/utils/IConstant';\r\nimport ReactDOM from 'react-dom';\r\nimport HttpClient from '../../core/utils/HttpClient';\r\nimport * as IConstant from '../../core/utils/IConstant';\r\n\r\nimport {\r\n    asyncGetDetailAction,\r\n    goBackAction,\r\n    setDetailScrollerPositionAction,\r\n    setTrafficInfosAction,\r\n    asyncCopyToMineAction,\r\n} from '../../store/actions/journey/detailAction';\r\n\r\nclass JourneyDetailScreen extends PureComponent\r\n{\r\n    constructor(props)\r\n    {\r\n        super(props);\r\n\r\n        this.journeyTrafficMapTapped = this.journeyTrafficMapTapped.bind(this);\r\n        this.journeyEditTapped = this.journeyEditTapped.bind(this);\r\n        this.journeyAddTapped = this.journeyAddTapped.bind(this);\r\n        this.journeyMapLineTapped = this.journeyMapLineTapped.bind(this);\r\n        this.doJourneyAdd = this.doJourneyAdd.bind(this);\r\n        this.goBack = this.goBack.bind(this);\r\n        this.editTitle = this.editTitle.bind(this);\r\n    }\r\n\r\n    componentDidMount()\r\n    {\r\n        if (!this.props.headerInfo)\r\n        {\r\n            this.props.dispatch(asyncGetDetailAction(this.props.match.params.journeyId));\r\n        }\r\n        this.restoreScrollViewPosition();\r\n    }\r\n    componentWillUnmount()\r\n    {\r\n        this.map = undefined;\r\n    }\r\n    componentDidUpdate(prevProps, prevState, snapshot)\r\n    {\r\n        // 行程详情接口返回数据后，查询交通\r\n        if (this.props.groupList && !prevProps.groupList)\r\n        {\r\n            if (!this.searchStarted)\r\n            {\r\n                this.searchDriveRoute(this.props.groupList, 0, 0);\r\n            }\r\n        }\r\n        // 百度地图初始化完成后，查询交通\r\n        else if (this.props.baiduMapInited && !prevProps.baiduMapInited)\r\n        {\r\n            if (!this.searchStarted)\r\n            {\r\n                this.searchDriveRoute(this.props.groupList || prevProps.groupList, 0, 0);\r\n            }\r\n        }\r\n        if(this.props.targetJourneyId && !prevProps.targetJourneyId)\r\n        {\r\n            Toast.success('复制成功!');\r\n            this.searchStarted = false;\r\n            this.props.history.replace(`/journey/detail/${this.props.targetJourneyId}`);\r\n        }\r\n        if(this.props.match.params.journeyId !== prevProps.match.params.journeyId)\r\n        {\r\n            this.props.dispatch(asyncGetDetailAction(this.props.match.params.journeyId));\r\n        }\r\n    }\r\n    render()\r\n    {\r\n        return (\r\n            <div>\r\n                <NavBar mode=\"dark\"\r\n                    className=\"navBar\"\r\n                    icon={<Icon type=\"left\" />}\r\n                    onLeftClick={this.goBack}\r\n                    rightContent={\r\n                        <div style={{display:'flex',alignItems:'center',height:'100%'}}>\r\n                            {\r\n                                this.props.isMine ?\r\n\r\n                                    <div className=\"journeyDetailRightContentButton\" onClick={() => this.journeyEditTapped()}>\r\n                                        <img className=\"journeyDetailRightContentImage\" src={require('../../assets/images/journey/plan-detail-edit-white@2x.png')} alt='' />\r\n                                    </div>\r\n                                    :\r\n                                    <div className=\"journeyDetailRightContentButton\" onClick={() => this.journeyAddTapped()}>\r\n                                        <img className=\"journeyDetailRightContentImage\" src={require('../../assets/images/add_public_account@2x.png')} alt='' />\r\n                                    </div>\r\n\r\n                            }\r\n                            <div className=\"journeyDetailRightContentButton\" onClick={() => this.journeyMapLineTapped()}>\r\n                                <img className=\"journeyDetailRightContentImage\" src={require('../../assets/images/journey/plan-detail-map-white@2x.png')} alt='' />\r\n                            </div>\r\n                        </div>\r\n                    }>\r\n                    {/* {this.props.headerInfo ? this.props.headerInfo.TourName : ''} */}\r\n                    行程详情\r\n                </NavBar>\r\n                <Content ref={(view)=>{this.scrollView = view ? view.getWrappedInstance() : this.scrollView;}}>\r\n                    <div className=\"journeyDetailHeaderBg\">\r\n                        {\r\n                            this.renderHeaderViews()\r\n                        }\r\n                    </div>\r\n                    {\r\n                        this.renderGroupViews()\r\n                    }\r\n                    {\r\n                        this.props.isFetching\r\n                            ?\r\n                            <ActivityIndicator\r\n                                toast\r\n                                text=\"Loading...\" />\r\n                            : null\r\n                    }\r\n                    <div id=\"journey_detail_map\" style={{ display: 'none' }} />\r\n                </Content>\r\n            </div>\r\n        );\r\n    }\r\n    renderHeaderViews()\r\n    {\r\n        if (!this.props.headerInfo)\r\n        {\r\n            return null;\r\n        }\r\n        return (\r\n            <div className=\"journeyDetailHeader\">\r\n                <img className=\"journeyDetailHeaderImage\" src={this.props.headerInfo && this.props.headerInfo.headImg ? this.props.headerInfo.headImg : this.props.userImagePath} alt='' />\r\n                <div className=\"journeyDetailHeaderTextDiv\">\r\n                    <div className=\"journeyDetailHeaderText2\">{this.props.headerInfo.TourName}</div>\r\n                    <img className=\"journeyEditTitleImage\" onClick={() => this.editTitle()} src={require('../../assets/images/journey/modifyInfo@2x.png')} alt='' />\r\n                </div>\r\n                <div className=\"journeyDetailHeaderText\">编号: {this.props.headerInfo.CreateDate.replace(/-/g ,'').replace(/:/g ,'').replace(' ','')}</div>\r\n                <div className=\"journeyDetailHeaderText\">行程天数：{this.props.groupList.length}天</div>\r\n                <div className=\"journeyDetailHeaderText\">出发时间：{this.props.headerInfo.BeginDate.split('T')[0]}</div>\r\n            </div>\r\n        );\r\n    }\r\n    renderGroupViews() {\r\n        if (!this.props.groupList || this.props.groupList.length === 0) {\r\n            return null;\r\n        }\r\n        return this.props.groupList.map((group, index) => this.renderGroupView(group, index));\r\n    }\r\n    renderGroupView(group, index) {\r\n        let planDate = new Date(this.props.headerInfo.BeginDate.replace(' ', 'T')).addDays(index).formatDate('YYYY-MM-DD');\r\n        return (\r\n            <div key={index}>\r\n                {\r\n                    this.renderGroupHeaderView(planDate, index)\r\n                }\r\n                {\r\n                    group.map((item, itemIndex) => this.renderItemView(item, index, itemIndex))\r\n                }\r\n            </div>\r\n        );\r\n    }\r\n    renderGroupHeaderView(planDate, index) {\r\n        return (\r\n            <div className=\"journeyDetailGroupHeader\">\r\n                <div className=\"journeyDetailGroupHeaderRow\">\r\n                    <img className=\"journeyDetailGroupHeaderIcon\" src={require('../../assets/images/journey/plan-detail-day@2x.png')} alt='' />\r\n                    <div className=\"journeyDetailGroupHeaderText\">第{index + 1}天({planDate})</div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n    renderItemView(item, groupIndex, itemIndex) {\r\n        let icon = this.getItemIcon(item);\r\n        return (\r\n            <div key={itemIndex}>\r\n                <div className=\"journeyDetailItemRow\"\r\n                    onClick={() => {\r\n                        this.showItemDetail(item);\r\n                    }}>\r\n                    <img className=\"journeyDetailItemIcon\" src={icon} alt='' />\r\n                    <div className=\"journeyDetailItemRightRow\">\r\n                        <div className=\"journeyDetailItemRightTopRow\">\r\n                            <div className=\"journeyDetailItemTitleRow\">\r\n                                <div className=\"journeyDetailItemTitle\">{item.Name}</div>\r\n                                <div className=\"journeyDetailItemPlayTime\">{this.getItemPlayTime(item)}</div>\r\n                            </div>\r\n                            <div style={{ flex: 1 }} />\r\n                            <div className=\"journeyDetailItemPrice\">\r\n                                <div className=\"journeyDetailItemPriceValue\">{this.getPriceValue(item)}</div>\r\n                                <div className=\"journeyDetailItemPriceUnit\">{this.getPriceUnit(item)}</div>\r\n                            </div>\r\n                            <img className=\"journeyIndexHeaderArrow\" src={require('../../assets/images/arrow@2x.png')} alt='' />\r\n                        </div>\r\n                        <div className=\"journeyDetailItemPlayTime\">\r\n                            地址：{item.Address}\r\n                        </div>\r\n                        {\r\n                            (item.Telephone && item.Telephone.length > 0)\r\n                                ?\r\n                                <div className=\"journeyDetailItemPlayTime\">\r\n                                    电话：{item.Telephone}\r\n                                </div>\r\n                                : null\r\n                        }\r\n                        <div className=\"journeyDetailItemImage\" style={{ backgroundImage: `url(${item.GetImage.SmallImageFrontUrl})` }} />\r\n                    </div>\r\n                </div>\r\n                {\r\n                    this.renderTrafficInfoView(groupIndex, itemIndex)\r\n                }\r\n            </div>\r\n        );\r\n    }\r\n    renderTrafficInfoView(groupIndex, itemIndex) {\r\n        let trafficInfo = this.props.trafficInfos[groupIndex + '_' + itemIndex];\r\n        if (!trafficInfo || trafficInfo.length === 0) {\r\n            return null;\r\n        }\r\n        return (\r\n            <div className=\"journeyDetailTrafficRow\" onClick={() => this.journeyTrafficMapTapped(groupIndex, itemIndex)}>\r\n                <div className=\"journeyDetailTrafficInfo\">\r\n                    <img className=\"journeyDetailTrafficInfoIcon\" src={require('../../assets/images/journey/icon_plan_bus.png')} alt='' />\r\n                    <div className=\"journeyDetailTrafficInfoText\">{trafficInfo}</div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n    showItemDetail(item) {\r\n        let _itemType = this.getItemType(item);\r\n        this.cacheScrollOffset();\r\n        if (_itemType === ItemType.You) {\r\n            this.props.history.push(`/scenic/detail/${item.Code}`);\r\n        }\r\n        else if (_itemType === ItemType.Zhu) {\r\n            this.props.history.push(`/hotel/detail/${item.Code}`);\r\n        }\r\n        else if (_itemType === ItemType.CanTing) {\r\n            this.props.history.push(`/restaurant/detail/${item.Code}`);\r\n        }\r\n        else if (_itemType === ItemType.Yu) {\r\n            this.props.history.push(`/fun/detail/${item.Code}`);\r\n        }\r\n        else if (_itemType === ItemType.Gou) {\r\n            this.props.history.push(`/shopping/detail/${item.Code}`);\r\n        }\r\n    }\r\n    // 针对 item 提供的便利方法\r\n    getItemPlayTime(item) {\r\n        let _itemType = this.getItemType(item);\r\n        if (_itemType === ItemType.You) {\r\n            return item.PlayTime ? '建议游玩' + item.PlayTime + '小时' : '';\r\n        }\r\n        if (_itemType === ItemType.Zhu) {\r\n            return item.PlayTime ? '时间：' + item.PlayTime : '';\r\n        }\r\n        return '营业时间：' + ((item.BusinesTime && item.BusinesTime.length > 0) ? item.BusinesTime : '全天');\r\n    }\r\n    getItemIcon(item) {\r\n        let _itemType = this.getItemType(item);\r\n\r\n        if (_itemType === ItemType.You) {\r\n            return require('../../assets/images/journey/icon_plan_since.png');\r\n        }\r\n        if (_itemType === ItemType.Zhu) {\r\n            return require('../../assets/images/journey/icon_plan_hotel.png');\r\n        }\r\n        if (_itemType === ItemType.CanTing) {\r\n            return require('../../assets/images/journey/icon_plan_food.png');\r\n        }\r\n        if (_itemType === ItemType.Yu) {\r\n            return require('../../assets/images/journey/icon_plan_amusement.png');\r\n        }\r\n        return require('../../assets/images/journey/icon_plan_business.png');\r\n    }\r\n    getPriceValue(item) {\r\n        let _itemType = this.getItemType(item);\r\n        if ( item.Price === null || parseFloat(item.Price) === 0) {\r\n            return '免费';\r\n        }\r\n        if (_itemType === ItemType.Gou) {\r\n            return '';\r\n        }\r\n        return '￥' + item.Price;\r\n    }\r\n    getPriceUnit(item) {\r\n        let _itemType = this.getItemType(item);\r\n        if (item.Price === null || parseFloat(item.Price) === 0) {\r\n            return '';\r\n        }\r\n        if (_itemType === ItemType.Gou) {\r\n            return '';\r\n        }\r\n        if (_itemType === ItemType.Zhu) {\r\n            return '起';\r\n        }\r\n        return '/人';\r\n    }\r\n    getItemType(item) {\r\n        if (item.PType === 'JQ') {\r\n            return ItemType.You;\r\n        }\r\n        if (item.PType === 'JD') {\r\n            return ItemType.Zhu;\r\n        }\r\n        if (item.PType === 'CT') {\r\n            return ItemType.CanTing;\r\n        }\r\n        if (item.PType === 'TL' || item.PType === 'YL') {\r\n            return ItemType.Yu;\r\n        }\r\n        return ItemType.Gou;\r\n    }\r\n    // 缓存位置\r\n    cacheScrollOffset() {\r\n        let offsetY = ReactDOM.findDOMNode(this.scrollView).scrollTop;\r\n        this.props.dispatch(setDetailScrollerPositionAction(this.props.match.params.journeyId, offsetY));\r\n    }\r\n    restoreScrollViewPosition() {\r\n        if (this.scrollView) {\r\n            if (!isNaN(this.props.scrollViewOffset)) {\r\n                this.scrollView.scrollToY(this.props.scrollViewOffset);\r\n            }\r\n            else {\r\n                this.scrollView.scrollToY(0);\r\n            }\r\n        }\r\n    }\r\n    // 驾车查询\r\n    searchDriveRoute(groupList, groupIndex, itemIndex) {\r\n        if (!window.BMap\r\n            || !groupList || groupList.length === 0\r\n            || groupIndex >= groupList.length) {\r\n            return;\r\n        }\r\n        this.searchStarted = true;  // 是否已经开始执行查询交通了\r\n        this.map = this.map ? this.map : new window.BMap.Map('journey_detail_map');\r\n        let nextGroupIndex = groupIndex;\r\n        let nextItemIndex = itemIndex + 1;\r\n        if (nextItemIndex >= groupList[groupIndex].length - 1) {\r\n            nextGroupIndex += 1;\r\n            nextItemIndex = 0;\r\n        }\r\n        let startItem = groupList[groupIndex][itemIndex];\r\n        let endItem = groupList[groupIndex][itemIndex + 1];\r\n        if (!this.isValidAddressItem(startItem) || !this.isValidAddressItem(endItem)) {\r\n            this.searchDriveRoute(groupList, nextGroupIndex, nextItemIndex);\r\n            return;\r\n        }\r\n        var options = {\r\n            onSearchComplete: (results) => {\r\n                if (driving.getStatus() === window.BMAP_STATUS_SUCCESS) {\r\n                    var plan = results.getPlan(0);\r\n                    let trafficInfo = `驾车 ${plan.getDuration(true)}, ${plan.getDistance(true)}`;\r\n                    let trafficInfos = { ...this.props.trafficInfos };\r\n                    trafficInfos[groupIndex + '_' + itemIndex] = trafficInfo;\r\n                    this.props.dispatch(setTrafficInfosAction(this.props.match.params.journeyId, trafficInfos));\r\n                    this.searchDriveRoute(groupList, nextGroupIndex, nextItemIndex);\r\n                }\r\n            }\r\n        };\r\n        var driving = new window.BMap.DrivingRoute(this.map, options);\r\n        driving.search(new window.BMap.Point(startItem.Longitude, startItem.Latitude), new window.BMap.Point(endItem.Longitude, endItem.Latitude));\r\n    }\r\n    isValidAddressItem(item) {\r\n        return item\r\n            && item.Longitude && item.Latitude\r\n            && (item.Longitude + '').length > 0 && (item.Latitude + '').length > 0\r\n            && !isNaN(item.Longitude) && !isNaN(item.Latitude);\r\n    }\r\n\r\n    // 行程驾车导航\r\n    journeyTrafficMapTapped(groupIndex, itemIndex) {\r\n        let startItem = this.props.groupList[groupIndex][itemIndex];\r\n        let endItem = this.props.groupList[groupIndex][itemIndex + 1];\r\n        if (this.isValidAddressItem(startItem) && this.isValidAddressItem(endItem)) {\r\n            this.cacheScrollOffset();\r\n            this.props.history.push(`/map/mapNav/${this.props.match.params.journeyId}/${startItem.Latitude}/${startItem.Longitude}?fromLat=${endItem.Latitude}&fromLng=${endItem.Longitude}`);\r\n            return;\r\n        }\r\n    }\r\n\r\n    //添加推荐行程\r\n    journeyAddTapped()\r\n    {\r\n        Modal.alert('行程复制', '是否复制到我的行程?', [\r\n            { text: '取消', style: 'default' },\r\n            { text: 'OK', onPress: this.doJourneyAdd },\r\n        ]);\r\n    }\r\n\r\n    editTitle(){\r\n        Modal.prompt('修改行程名称', '给你的行程起个响亮的名字', [\r\n            { text: '取消' },\r\n            { text: '确认', onPress: value => this.onChangeName(this.props.headerInfo.PlanMainID, value) },\r\n        ], 'plain-text', this.props.headerInfo.TourName);\r\n    }\r\n\r\n    onChangeName(id, value){\r\n        let kvDict = {\r\n            planMainID: id ,\r\n            title: value\r\n        };\r\n        HttpClient.postToPortal(IConstant.PortalApis.JOURNEY.UpdateTourTitle, kvDict, null, true)\r\n            .then((resp) => resp.json()).then((resp) => {\r\n                if (resp) {\r\n                    this.props.dispatch(asyncGetDetailAction(this.props.match.params.journeyId));\r\n                }\r\n            });\r\n    }\r\n\r\n    doJourneyAdd()\r\n    {\r\n        this.props.dispatch(asyncCopyToMineAction(this.props.match.params.journeyId));\r\n    }\r\n\r\n    //行程编辑 点击\r\n    journeyEditTapped() {\r\n        this.cacheScrollOffset();\r\n        this.props.history.push({pathname:'/journey/edit',state:{code:this.props.match.params.journeyId,groupList:this.props.groupList,headerInfo:this.props.headerInfo}});\r\n    }\r\n\r\n    // 行程地图 \r\n    journeyMapLineTapped() {\r\n        this.cacheScrollOffset();\r\n        this.props.history.push({pathname:'/journey/mapLine',state:{code:this.props.match.params.journeyId,groupList:this.props.groupList}});\r\n    }\r\n\r\n    goBack()\r\n    {\r\n        let journeyId = this.props.match.params.journeyId;\r\n        let dispatch = this.props.dispatch;\r\n        this.props.history.goBack();\r\n        dispatch(goBackAction(journeyId));\r\n    }\r\n    \r\n}\r\n\r\nconst mapStateToProps = function (state, ownProps) {\r\n    let obj = state.journey.detailScreen[ownProps.match.params.journeyId];\r\n    let userInfo = SysUtil.getUserInfo(state);\r\n    let props = {\r\n        ...obj,\r\n        baiduMapInited: state.system.baiduMapInited,\r\n        userImagePath: require('../../assets/images/portrait-whiteblack.jpg'),\r\n        userInfo: userInfo,\r\n    };\r\n    if(obj && obj.headerInfo)\r\n    {\r\n        props.isMine = (obj.headerInfo.UserID === userInfo.ID);\r\n        props.userImagePath = props.isMine ? userInfo.UserAvatar : (obj.headerInfo.headImg ? obj.headerInfo.headImg : require('../../assets/images/portrait-whiteblack.jpg'));\r\n    }\r\n    return props;\r\n};\r\n\r\nJourneyDetailScreen = connect(mapStateToProps)(JourneyDetailScreen);\r\n\r\nexport default JourneyDetailScreen;\n\n\n// WEBPACK FOOTER //\n// ./src/screens/journey/JourneyDetailScreen.js","module.exports = __webpack_public_path__ + \"static/media/portrait-whiteblack.fba26053.jpg\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/images/portrait-whiteblack.jpg\n// module id = 911\n// module chunks = 5","module.exports = __webpack_public_path__ + \"static/media/plan-detail-edit-white@2x.dfd223f6.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/images/journey/plan-detail-edit-white@2x.png\n// module id = 951\n// module chunks = 5","module.exports = __webpack_public_path__ + \"static/media/plan-detail-map-white@2x.b2c77e80.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/images/journey/plan-detail-map-white@2x.png\n// module id = 952\n// module chunks = 5","module.exports = __webpack_public_path__ + \"static/media/modifyInfo@2x.121083cf.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/images/journey/modifyInfo@2x.png\n// module id = 953\n// module chunks = 5","module.exports = __webpack_public_path__ + \"static/media/plan-detail-day@2x.f1ad1a5e.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/images/journey/plan-detail-day@2x.png\n// module id = 954\n// module chunks = 5","module.exports = __webpack_public_path__ + \"static/media/icon_plan_bus.0ea92f29.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/images/journey/icon_plan_bus.png\n// module id = 955\n// module chunks = 5"],"sourceRoot":""}