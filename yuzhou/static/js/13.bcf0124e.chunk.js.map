{"version":3,"sources":["../static/js/13.bcf0124e.chunk.js","screens/map/ElementMarkerScreen.js","store/actions/map/elementMarkerAction.js","assets/images/map/icon_line.png"],"names":["webpackJsonp","886","module","__webpack_exports__","__webpack_require__","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","defineProperty","__WEBPACK_IMPORTED_MODULE_0_antd_mobile_lib_nav_bar_style_css__","__WEBPACK_IMPORTED_MODULE_1_antd_mobile_lib_nav_bar__","n","__WEBPACK_IMPORTED_MODULE_1_antd_mobile_lib_nav_bar___default","__WEBPACK_IMPORTED_MODULE_2_antd_mobile_lib_icon_style_css__","__WEBPACK_IMPORTED_MODULE_3_antd_mobile_lib_icon__","__WEBPACK_IMPORTED_MODULE_3_antd_mobile_lib_icon___default","__WEBPACK_IMPORTED_MODULE_4_react__","__WEBPACK_IMPORTED_MODULE_4_react___default","__WEBPACK_IMPORTED_MODULE_5_react_redux__","__WEBPACK_IMPORTED_MODULE_6__views_common_Content__","__WEBPACK_IMPORTED_MODULE_7_react_dom__","__WEBPACK_IMPORTED_MODULE_7_react_dom___default","__WEBPACK_IMPORTED_MODULE_8__common_NativeAppScreen__","__WEBPACK_IMPORTED_MODULE_9__core_utils_IConstant__","__WEBPACK_IMPORTED_MODULE_10__core_utils_Config__","__WEBPACK_IMPORTED_MODULE_11__store_actions_map_elementMarkerAction__","_createClass","defineProperties","target","props","i","length","descriptor","key","protoProps","staticProps","ElementMarkerScreen","_NativeAppScreen","this","_this","getPrototypeOf","name","address","lat","lng","match","params","state","mapHeight","updateWindowDimensions","updateNativeTitle","prevProps","prevState","snapshot","baiduMapInited","initMap","_this2","a","createElement","className","isFromNativeApp","mode","icon","type","onLeftClick","code","dispatch","history","goBack","ref","view","scrollView","getWrappedInstance","id","style","height","markerIcon","window","BMap","Icon","Size","anchor","imageSize","map","Map","centerAndZoom","Point","appCityLongitude","appCityLatitude","addControl","NavigationControl","BMAP_NAVIGATION_CONTROL_SMALL","BMAP_ANCHOR_BOTTOM_RIGHT","enableGeolocation","offset","GeolocationControl","enableAutoLocation","setMapCenter","mapZoom","setZoom","setCenter","centerLng","centerLat","_this3","point","clearOverlays","marker","Marker","lineImageUrl","div","label","Label","setStyle","padding","color","background-color","border","border-radius","transform","setLabel","addEventListener","markerTapped","addOverlay","setMapZoomAndCenterLocation","postMessage","sendMessageToNative","MAP_NAV","toLat","toLng","push","_this4","innerHeight","findDOMNode","parentNode","offsetTop","setState","centerPoint","getCenter","getZoom","mapStateToProps","ownProps","obj","elementMarker","assign","system","native","931","goBackAction","__WEBPACK_IMPORTED_MODULE_0__core_utils_IConstant__","MAP","ELEMENTMARKER","GO_BACK","mapZoomAndCenterLocationChangeAction","getState","_mapZoomAndCenterLocationChangeAction","Promise","resolve","MAPZOOM_AND_CENTERLOCATION_CHANGE","932","exports","p"],"mappings":"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","file":"static/js/13.bcf0124e.chunk.js","sourcesContent":["webpackJsonp([13],{\n\n/***/ 886:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_antd_mobile_lib_nav_bar_style_css__ = __webpack_require__(11);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_antd_mobile_lib_nav_bar_style_css___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_antd_mobile_lib_nav_bar_style_css__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_antd_mobile_lib_nav_bar__ = __webpack_require__(12);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_antd_mobile_lib_nav_bar___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_antd_mobile_lib_nav_bar__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_antd_mobile_lib_icon_style_css__ = __webpack_require__(18);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_antd_mobile_lib_icon_style_css___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_antd_mobile_lib_icon_style_css__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_antd_mobile_lib_icon__ = __webpack_require__(19);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_antd_mobile_lib_icon___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_antd_mobile_lib_icon__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_react__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_react___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_react__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_react_redux__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__views_common_Content__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_react_dom__ = __webpack_require__(14);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_react_dom___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_react_dom__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__common_NativeAppScreen__ = __webpack_require__(70);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__core_utils_IConstant__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__core_utils_Config__ = __webpack_require__(54);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__store_actions_map_elementMarkerAction__ = __webpack_require__(931);\nvar _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if(\"value\"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError(\"Cannot call a class as a function\");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");}return call&&(typeof call===\"object\"||typeof call===\"function\")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!==\"function\"&&superClass!==null){throw new TypeError(\"Super expression must either be null or a function, not \"+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var ElementMarkerScreen=function(_NativeAppScreen){_inherits(ElementMarkerScreen,_NativeAppScreen);function ElementMarkerScreen(props){_classCallCheck(this,ElementMarkerScreen);var _this=_possibleConstructorReturn(this,(ElementMarkerScreen.__proto__||Object.getPrototypeOf(ElementMarkerScreen)).call(this,props));_this.name='';_this.address='';_this.lat='';_this.lng='';_this.name=_this.props.match.params.name;_this.address=_this.props.match.params.address;_this.lat=_this.props.match.params.lat;_this.lng=_this.props.match.params.lng;_this.state={mapHeight:0};return _this;}_createClass(ElementMarkerScreen,[{key:'componentDidMount',value:function componentDidMount(){this.updateWindowDimensions();this.updateNativeTitle(this.name);}},{key:'componentDidUpdate',value:function componentDidUpdate(prevProps,prevState,snapshot){if(this.props.baiduMapInited&&!prevProps.baiduMapInited){this.initMap();}}},{key:'render',value:function render(){var _this2=this;return __WEBPACK_IMPORTED_MODULE_4_react___default.a.createElement('div',{className:this.props.isFromNativeApp?'isFromNativeApp':null},this.props.isFromNativeApp?null:__WEBPACK_IMPORTED_MODULE_4_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_1_antd_mobile_lib_nav_bar___default.a,{mode:'dark',className:'navBar',icon:__WEBPACK_IMPORTED_MODULE_4_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_3_antd_mobile_lib_icon___default.a,{type:'left'}),onLeftClick:function onLeftClick(){var code=_this2.props.match.params.code;var dispatch=_this2.props.dispatch;_this2.props.history.goBack();dispatch(Object(__WEBPACK_IMPORTED_MODULE_11__store_actions_map_elementMarkerAction__[\"a\" /* goBackAction */])(code));}},this.name),__WEBPACK_IMPORTED_MODULE_4_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_6__views_common_Content__[\"a\" /* default */],{ref:function ref(view){_this2.scrollView=view?view.getWrappedInstance():_this2.scrollView;}},__WEBPACK_IMPORTED_MODULE_4_react___default.a.createElement('div',{id:'elementMarkerMap',style:{height:this.state.mapHeight+'px'}})));}},{key:'initMap',value:function initMap(){// 地图标记图片\nthis.markerIcon=new window.BMap.Icon(__webpack_require__(284),new window.BMap.Size(30,30),{anchor:new window.BMap.Size(15,30),imageSize:new window.BMap.Size(30,30)});this.map=this.map?this.map:new window.BMap.Map('elementMarkerMap');this.map.centerAndZoom(new window.BMap.Point(__WEBPACK_IMPORTED_MODULE_10__core_utils_Config__[\"a\" /* default */].instance.appCityLongitude,__WEBPACK_IMPORTED_MODULE_10__core_utils_Config__[\"a\" /* default */].instance.appCityLatitude),16);this.map.addControl(new window.BMap.NavigationControl({type:window.BMAP_NAVIGATION_CONTROL_SMALL,anchor:window.BMAP_ANCHOR_BOTTOM_RIGHT,enableGeolocation:true,offset:new window.BMap.Size(20,20)}));this.map.addControl(new window.BMap.GeolocationControl({enableAutoLocation:false}));this.setMapCenter();if(this.props.mapZoom){this.map.setZoom(this.props.mapZoom);this.map.setCenter(new window.BMap.Point(this.props.centerLng,this.props.centerLat));}}},{key:'setMapCenter',value:function setMapCenter(){var _this3=this;if(this.map&&this.lat&&this.lng){var point=new window.BMap.Point(this.lng,this.lat);this.map.setCenter(point);this.map.clearOverlays();// 创建标注对象并添加到地图\nvar marker=new window.BMap.Marker(point,{icon:this.markerIcon});var lineImageUrl=__webpack_require__(932);var div='\\n            <div style=\"display: flex; flex-direction: row;\">\\n                <div>\\n                    <div style=\"font-size: 14px; text-align: center; min-width:40vw; max-width: 70vw;\">'+this.name+'</div>\\n                    <div style=\"font-size: 12px; text-align: center; min-width:40vw; max-width: 70vw; margin-top: 5px; white-space: normal;\">'+this.address+'</div>\\n                </div>\\n                <div style=\"width: 25px; margin-left: 6px; display: -webkit-flex;display: flex;flex-flow: row;align-items: center;\">\\n                    <img style=\"width: 25px; height: 20px;\" src=\"'+lineImageUrl+'\">\\n                </div>\\n            </div>\\n            ';var label=new window.BMap.Label(div);label.setStyle({'padding':'5px 10px','color':'white','background-color':'#3988d4','border':'0px','border-radius':'3px','transform':'translate(calc(-50% + 11px), calc(-100% - 2px))'});marker.setLabel(label);marker.addEventListener('click',function(){_this3.markerTapped();});label.addEventListener('click',function(){_this3.markerTapped();});this.map.addOverlay(marker);}}},{key:'markerTapped',value:function markerTapped(){this.setMapZoomAndCenterLocation();if(this.props.isFromNativeApp&&window.postMessage){this.sendMessageToNative(__WEBPACK_IMPORTED_MODULE_9__core_utils_IConstant__[\"i\" /* NATIVE_MESSAGE_TYPE */].MAP_NAV,{code:this.props.match.params.code,toLat:this.lat,toLng:this.lng});}else{//导航点击\nthis.props.history.push('/map/mapNav/'+this.props.match.params.code+'/'+this.lat+'/'+this.lng);}}},{key:'updateWindowDimensions',value:function updateWindowDimensions(){var _this4=this;var height=window.innerHeight-__WEBPACK_IMPORTED_MODULE_7_react_dom___default.a.findDOMNode(this).parentNode.offsetTop;this.setState({mapHeight:height},function(){if(_this4.props.baiduMapInited){_this4.initMap();}});}// 保存 地图中心点 和 缩放级\n},{key:'setMapZoomAndCenterLocation',value:function setMapZoomAndCenterLocation(){if(!this.map){return;}var centerPoint=this.map.getCenter();var mapZoom=this.map.getZoom();var centerLat=centerPoint.lat;var centerLng=centerPoint.lng;this.props.dispatch(Object(__WEBPACK_IMPORTED_MODULE_11__store_actions_map_elementMarkerAction__[\"b\" /* mapZoomAndCenterLocationChangeAction */])(this.props.match.params.code,mapZoom,centerLat,centerLng));}}]);return ElementMarkerScreen;}(__WEBPACK_IMPORTED_MODULE_8__common_NativeAppScreen__[\"a\" /* default */]);var mapStateToProps=function mapStateToProps(state,ownProps){var obj=state.map.elementMarker[ownProps.match.params.code];return Object.assign({},obj,{baiduMapInited:state.system.baiduMapInited,isFromNativeApp:state.native.isFromNativeApp});};ElementMarkerScreen=Object(__WEBPACK_IMPORTED_MODULE_5_react_redux__[\"b\" /* connect */])(mapStateToProps)(ElementMarkerScreen);/* harmony default export */ __webpack_exports__[\"default\"] = (ElementMarkerScreen);\n\n/***/ }),\n\n/***/ 931:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = goBackAction;\n/* harmony export (immutable) */ __webpack_exports__[\"b\"] = mapZoomAndCenterLocationChangeAction;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__core_utils_IConstant__ = __webpack_require__(1);\nfunction goBackAction(code){return{type:__WEBPACK_IMPORTED_MODULE_0__core_utils_IConstant__[\"b\" /* Actions */].MAP.ELEMENTMARKER.GO_BACK,code:code};}function mapZoomAndCenterLocationChangeAction(code,mapZoom,centerLat,centerLng){return function(dispatch,getState){dispatch(_mapZoomAndCenterLocationChangeAction(code,mapZoom,centerLat,centerLng));return new Promise(function(resolve){resolve();});};}function _mapZoomAndCenterLocationChangeAction(code,mapZoom,centerLat,centerLng){return{type:__WEBPACK_IMPORTED_MODULE_0__core_utils_IConstant__[\"b\" /* Actions */].MAP.ELEMENTMARKER.MAPZOOM_AND_CENTERLOCATION_CHANGE,code:code,mapZoom:mapZoom,centerLat:centerLat,centerLng:centerLng};}\n\n/***/ }),\n\n/***/ 932:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__.p + \"static/media/icon_line.489cc7de.png\";\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/js/13.bcf0124e.chunk.js","import React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { NavBar, Icon } from 'antd-mobile';\r\nimport Content from '../../views/common/Content';\r\nimport ReactDOM from 'react-dom';\r\nimport NativeAppScreen from '../common/NativeAppScreen';\r\nimport * as IConstant from '../../core/utils/IConstant';\r\nimport Config from '../../core/utils/Config';\r\nimport { \r\n    goBackAction, \r\n    mapZoomAndCenterLocationChangeAction\r\n} from '../../store/actions/map/elementMarkerAction';\r\n\r\nclass ElementMarkerScreen extends NativeAppScreen\r\n{\r\n    name = '';\r\n    address = '';\r\n    lat = '';\r\n    lng = '';\r\n    constructor(props)\r\n    {\r\n        super(props);\r\n        this.name = this.props.match.params.name;\r\n        this.address = this.props.match.params.address;\r\n        this.lat = this.props.match.params.lat;\r\n        this.lng = this.props.match.params.lng;\r\n        this.state = {\r\n            mapHeight: 0,\r\n        };\r\n    }\r\n    componentDidMount()\r\n    {\r\n        this.updateWindowDimensions();\r\n        this.updateNativeTitle(this.name);\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState, snapshot)\r\n    {\r\n        if(this.props.baiduMapInited && !prevProps.baiduMapInited)\r\n        {\r\n            this.initMap();\r\n        }\r\n    }\r\n\r\n    render()\r\n    {\r\n        return (\r\n            <div className={ this.props.isFromNativeApp ? 'isFromNativeApp' : null }>\r\n                {\r\n                    this.props.isFromNativeApp\r\n                        ? null\r\n                        :\r\n                        <NavBar mode=\"dark\" \r\n                            className=\"navBar\"\r\n                            icon={<Icon type=\"left\" />}\r\n                            onLeftClick={() => {\r\n                                let code = this.props.match.params.code;\r\n                                let dispatch = this.props.dispatch;\r\n                                this.props.history.goBack();\r\n                                dispatch(goBackAction(code));\r\n                            }}>\r\n                            {this.name}\r\n                        </NavBar>\r\n                }\r\n                <Content ref={(view)=>{this.scrollView = view ? view.getWrappedInstance() : this.scrollView;}}>\r\n                    <div id=\"elementMarkerMap\" style={{height: (this.state.mapHeight + 'px')}}></div>\r\n                </Content>\r\n            </div>\r\n        );\r\n    }\r\n    \r\n    initMap()\r\n    {\r\n        // 地图标记图片\r\n        this.markerIcon = new window.BMap.Icon(require('../../assets/images/map/common_poi@2x.png'), new window.BMap.Size(30, 30), {\r\n            anchor: new window.BMap.Size(15, 30),\r\n            imageSize: new window.BMap.Size(30, 30)\r\n        });\r\n\r\n        this.map = this.map ? this.map : new window.BMap.Map('elementMarkerMap');\r\n        this.map.centerAndZoom(new window.BMap.Point(Config.instance.appCityLongitude, Config.instance.appCityLatitude), 16);\r\n        this.map.addControl(new window.BMap.NavigationControl({type: window.BMAP_NAVIGATION_CONTROL_SMALL, anchor: window.BMAP_ANCHOR_BOTTOM_RIGHT, enableGeolocation: true, offset: new window.BMap.Size(20, 20)}));\r\n        this.map.addControl(new window.BMap.GeolocationControl({enableAutoLocation: false}));\r\n\r\n        this.setMapCenter();\r\n\r\n        if (this.props.mapZoom)\r\n        {\r\n            this.map.setZoom(this.props.mapZoom);\r\n            this.map.setCenter(new window.BMap.Point(this.props.centerLng, this.props.centerLat));\r\n        }\r\n    }\r\n\r\n    setMapCenter()\r\n    {\r\n        if(this.map && this.lat && this.lng)\r\n        {\r\n            let point = new window.BMap.Point(this.lng, this.lat);\r\n            this.map.setCenter(point);\r\n\r\n            this.map.clearOverlays();\r\n\r\n            // 创建标注对象并添加到地图\r\n            let marker = new window.BMap.Marker(point, {icon: this.markerIcon});\r\n            let lineImageUrl = require('../../assets/images/map/icon_line.png');\r\n            let div = `\r\n            <div style=\"display: flex; flex-direction: row;\">\r\n                <div>\r\n                    <div style=\"font-size: 14px; text-align: center; min-width:40vw; max-width: 70vw;\">` + this.name + `</div>\r\n                    <div style=\"font-size: 12px; text-align: center; min-width:40vw; max-width: 70vw; margin-top: 5px; white-space: normal;\">` + this.address + `</div>\r\n                </div>\r\n                <div style=\"width: 25px; margin-left: 6px; display: -webkit-flex;display: flex;flex-flow: row;align-items: center;\">\r\n                    <img style=\"width: 25px; height: 20px;\" src=\"` + lineImageUrl + `\">\r\n                </div>\r\n            </div>\r\n            `;\r\n            let label = new window.BMap.Label(div);\r\n            label.setStyle({'padding': '5px 10px', 'color': 'white', 'background-color': '#3988d4', 'border': '0px', 'border-radius': '3px', 'transform': 'translate(calc(-50% + 11px), calc(-100% - 2px))'});\r\n            marker.setLabel(label);\r\n\r\n            marker.addEventListener('click', ()=>{\r\n                this.markerTapped();\r\n            });\r\n            label.addEventListener('click', ()=>{\r\n                this.markerTapped();\r\n            });\r\n\r\n            this.map.addOverlay(marker);\r\n        }\r\n    }\r\n    markerTapped()\r\n    {\r\n        this.setMapZoomAndCenterLocation();\r\n        if(this.props.isFromNativeApp && window.postMessage)\r\n        {\r\n            this.sendMessageToNative(IConstant.NATIVE_MESSAGE_TYPE.MAP_NAV, {\r\n                code: this.props.match.params.code,\r\n                toLat: this.lat,\r\n                toLng: this.lng,\r\n            });\r\n        }\r\n        else\r\n        {\r\n            //导航点击\r\n            this.props.history.push(`/map/mapNav/${this.props.match.params.code}/${this.lat}/${this.lng}`);\r\n        }\r\n    }\r\n\r\n    updateWindowDimensions()\r\n    {\r\n        const height = window.innerHeight - ReactDOM.findDOMNode(this).parentNode.offsetTop;\r\n        this.setState({ mapHeight: height }, ()=>{\r\n            if (this.props.baiduMapInited)\r\n            {\r\n                this.initMap();\r\n            }\r\n        });\r\n    }\r\n\r\n    // 保存 地图中心点 和 缩放级\r\n    setMapZoomAndCenterLocation()\r\n    {\r\n        if (!this.map)\r\n        {\r\n            return;\r\n        }\r\n        let centerPoint = this.map.getCenter();\r\n        let mapZoom = this.map.getZoom();\r\n        let centerLat = centerPoint.lat;\r\n        let centerLng = centerPoint.lng;\r\n        this.props.dispatch(mapZoomAndCenterLocationChangeAction(this.props.match.params.code,mapZoom,centerLat,centerLng));\r\n    }\r\n}\r\n\r\nconst mapStateToProps = function(state, ownProps)\r\n{\r\n    let obj = state.map.elementMarker[ownProps.match.params.code];\r\n    return {\r\n        ...obj,\r\n        baiduMapInited: state.system.baiduMapInited,\r\n        isFromNativeApp: state.native.isFromNativeApp,\r\n    };\r\n};\r\n\r\nElementMarkerScreen = connect(mapStateToProps)(ElementMarkerScreen);\r\n\r\nexport default ElementMarkerScreen;\n\n\n// WEBPACK FOOTER //\n// ./src/screens/map/ElementMarkerScreen.js","import * as IConstant from '../../../core/utils/IConstant';\r\n\r\nexport function goBackAction(code)\r\n{\r\n    return {\r\n        type: IConstant.Actions.MAP.ELEMENTMARKER.GO_BACK,\r\n        code:code\r\n    };\r\n}\r\n\r\nexport function mapZoomAndCenterLocationChangeAction(code,mapZoom,centerLat,centerLng)\r\n{\r\n    return function(dispatch, getState)\r\n    {\r\n        dispatch(_mapZoomAndCenterLocationChangeAction(code,mapZoom,centerLat,centerLng));\r\n        return new Promise((resolve)=>{\r\n            resolve();\r\n        });\r\n    };\r\n    \r\n}\r\n\r\nfunction _mapZoomAndCenterLocationChangeAction(code,mapZoom,centerLat,centerLng)\r\n{\r\n    return {\r\n        type: IConstant.Actions.MAP.ELEMENTMARKER.MAPZOOM_AND_CENTERLOCATION_CHANGE,\r\n        code:code,\r\n        mapZoom:mapZoom,\r\n        centerLat: centerLat,\r\n        centerLng: centerLng\r\n    };\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/store/actions/map/elementMarkerAction.js","module.exports = __webpack_public_path__ + \"static/media/icon_line.489cc7de.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/images/map/icon_line.png\n// module id = 932\n// module chunks = 13"],"sourceRoot":""}