webpackJsonp([3],{891:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(24),s=(n.n(a),n(25)),c=n.n(s),u=n(16),l=(n.n(u),n(17)),p=n.n(l),f=n(11),m=(n.n(f),n(12)),h=n.n(m),d=n(0),y=n.n(d),I=n(2),E=n(14),b=n.n(E),w=n(10),v=n(906),g=n(15),C=n(20),j=n(945),k=n(949),O=n(23),N=n(115),_=(n.n(N),function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}()),x=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.showMyJourneyListScreen=n.showMyJourneyListScreen.bind(n),n.onCreateButtonClick=n.onCreateButtonClick.bind(n),n.onRecommendItemClick=n.onRecommendItemClick.bind(n),n.onMineItemClick=n.onMineItemClick.bind(n),n.onRefresh=n.onRefresh.bind(n),n.state={isPullRefresh:!1},n}return i(t,e),_(t,[{key:"componentDidMount",value:function(){var e=this;this.props.mineList.dataList&&this.props.recommendList.dataList&&!this.props.mineList.isRefresh||this.props.dispatch(Object(v.b)(this.props.userId)).then(function(){return e.props.dispatch(Object(v.c)(e.props.userId))}),this.restoreScrollViewPosition()}},{key:"render",value:function(){var e=this;return y.a.createElement("div",null,y.a.createElement(h.a,{mode:"dark",className:"navBar",leftContent:y.a.createElement(O.a,{ref:function(t){e.LeftContentView=t?t.getWrappedInstance():e.scrollView},goBackAction:v.d,history:this.props.history}),onLeftClick:function(){e.LeftContentView.goHome()}},"\u6211\u7684\u884c\u7a0b"),y.a.createElement(w.a,{ref:function(t){e.scrollView=t?t.getWrappedInstance():e.scrollView}},y.a.createElement(c.a,{style:{height:window.innerHeight-45+"px",overflow:"auto"},refreshing:this.state.isPullRefresh,onRefresh:this.onRefresh,ref:function(e){return C.a.fixListViewHeightIssue(e,window.innerHeight-45)}},y.a.createElement(j.a,{onMoreButtonClick:this.showMyJourneyListScreen,onCreateButtonClick:this.onCreateButtonClick,onItemClick:this.onMineItemClick}),y.a.createElement(k.a,{onItemClick:this.onRecommendItemClick}),this.state.isPullRefresh||!this.props.mineList.isFetching&&!this.props.recommendList.isFetching?null:y.a.createElement(p.a,{toast:!0,text:"Loading..."}))))}},{key:"onRefresh",value:function(){var e=this;this.setState({isPullRefresh:!0}),this.props.dispatch(Object(v.d)()),this.props.dispatch(Object(v.b)(this.props.userId)).then(function(){return e.props.dispatch(Object(v.c)(e.props.userId)).then(function(){e.setState({isPullRefresh:!1})})})}},{key:"showMyJourneyListScreen",value:function(){this.cacheScrollOffset(),this.props.userId?this.props.history.push(this.props.match.url+"/list"):this.props.history.push("/me/login")}},{key:"onCreateButtonClick",value:function(){this.cacheScrollOffset(),this.props.userId?this.props.history.push(this.props.match.url+"/create"):this.props.history.push("/me/login")}},{key:"onMineItemClick",value:function(e){this.onItemClick(e,!0)}},{key:"onRecommendItemClick",value:function(e){this.onItemClick(e,!1)}},{key:"onItemClick",value:function(e,t){this.cacheScrollOffset(),this.props.history.push(this.props.match.url+"/detail/"+e.PlanMainID)}},{key:"cacheScrollOffset",value:function(){var e=b.a.findDOMNode(this.scrollView).scrollTop;this.props.dispatch(Object(v.e)(e))}},{key:"restoreScrollViewPosition",value:function(){this.scrollView&&(isNaN(this.props.scrollViewOffset)?this.scrollView.scrollToY(0):this.scrollView.scrollToY(this.props.scrollViewOffset))}}]),t}(d.PureComponent),R=function(e,t){var n=e.journey.indexScreen;return Object.assign({userId:g.a.getUserId(e)},n)};x=Object(I.b)(R)(x),t.default=x},906:function(e,t,n){"use strict";function r(e){return function(t,n){return t(s()),l(e).then(function(e){t(c(e?e.results:[]))}).catch(function(e){t(u(e))})}}function o(e){return function(t,n){return t(p()),h(e).then(function(e){t(m(e?e.results:[]))}).catch(function(e){t(f(e))})}}function i(){return{type:y.b.JOURNEY.INDEX.GO_BACK}}function a(e){return{type:y.b.JOURNEY.INDEX.SET_SCROLL_OFFSET,scrollViewOffset:e}}function s(){return{type:y.b.JOURNEY.INDEX.GET_MINE_LIST_REQUEST}}function c(e){return{type:y.b.JOURNEY.INDEX.GET_MINE_LIST_SUCCESS,dataList:e}}function u(e){return{type:y.b.JOURNEY.INDEX.GET_MINE_LIST_FAILURE,message:e}}function l(e){var t={pageIndex:1,pageSize:4,userID:e};return I.a.getFromPortal(y.q.JOURNEY.GetTourPlanInfo,t).then(function(e){return e.json()})}function p(){return{type:y.b.JOURNEY.INDEX.GET_RECOMMEND_LIST_REQUEST}}function f(e){return{type:y.b.JOURNEY.INDEX.GET_RECOMMEND_LIST_FAILURE,message:e}}function m(e){return{type:y.b.JOURNEY.INDEX.GET_RECOMMEND_LIST_SUCCESS,dataList:e}}function h(e){var t={pageIndex:1,pageSize:1e4};return I.a.getFromPortal(y.q.JOURNEY.GetRecommendTourForHome,t).then(function(e){return e.json()})}function d(e){return{type:y.b.JOURNEY.INDEX.SET_LIST_REFRESH,isRefresh:e}}t.b=r,t.c=o,t.d=i,t.e=a,t.a=d;var y=n(1),I=n(8)},945:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n(0),s=n.n(a),c=n(2),u=n(9),l=n.n(u),p=n(15),f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),m=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),f(t,[{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement("div",{className:"journeyIndexHeaderRow",onClick:this.props.onMoreButtonClick},s.a.createElement("img",{className:"journeyIndexHeaderIcon",src:n(946),alt:""}),s.a.createElement("div",{className:"journeyIndexHeaderTitle"},"\u6211\u7684\u884c\u7a0b"),s.a.createElement("div",{style:{flex:1}}),s.a.createElement("div",{className:"journeyIndexHeaderMore"},"\u66f4\u591a"),s.a.createElement("img",{className:"journeyIndexHeaderArrow",src:n(55),alt:""})),this.props.dataList&&this.props.dataList.length>0?this.renderJourneyListView():this.renderEmptyView(),s.a.createElement("div",{className:"journeyIndexCreateButtonRow"},s.a.createElement("div",{className:"journeyIndexCreateButton",onClick:this.props.onCreateButtonClick},"\u521b\u5efa\u6211\u7684\u884c\u7a0b")))}},{key:"renderJourneyListView",value:function(){var e=this,t=Math.ceil(this.props.dataList.length/2);return Array(t).fill(0).map(function(t,n){return e.renderJourneyRowView(n)})}},{key:"renderJourneyRowView",value:function(e){return s.a.createElement("div",{key:e,style:{marginTop:(0===e?0:15)+"px"},className:"joruneyIndexItemRow"},this.renderJourneyItemView(2*e),this.renderJourneyItemView(2*e+1))}},{key:"renderJourneyItemView",value:function(e){var t=this;if(e>=this.props.dataList.length)return null;var r=this.props.dataList[e],o=(window.innerWidth-30)/2;return s.a.createElement("div",{className:"journeyIndexItem",style:{width:o+"px",marginLeft:"10px"},onClick:function(){t.props.onItemClick&&t.props.onItemClick(r)}},s.a.createElement("img",{src:r.GetImage.ImageFrontUrl,alt:"",style:{width:o+"px",height:.6*o+"px"}}),s.a.createElement("div",{className:"journeyIndexItemTitle"},r.TourName),s.a.createElement("div",{className:"journeyIndexItemStartTime"},"\u51fa\u53d1\u65f6\u95f4\uff1a",r.BeginDate),s.a.createElement("div",{className:"journeyIndexItemIcon"},s.a.createElement("img",{src:n(947),alt:""}),s.a.createElement("div",{className:"journeyIndexItemDay"},r.DayCount,"\u5929")))}},{key:"renderEmptyView",value:function(){var e=window.innerWidth,t=477*e/588;return s.a.createElement("div",{className:"journeyIndexEmptyViews"},s.a.createElement("img",{className:"journeyIndexEmptyImage",style:{width:e,height:t},src:n(948),alt:""}),s.a.createElement("div",{className:"journeyIndexEmptyText"},"\u60a8\u8fd8\u6ca1\u6709\u884c\u7a0b\u8ba1\u5212"))}}]),t}(a.PureComponent);m.propTypes={onItemClick:l.a.func,onMoreButtonClick:l.a.func,onCreateButtonClick:l.a.func};var h=function(e,t){var n=e.journey.indexScreen.mineList;return Object.assign({},n,{userId:p.a.getUserId(e)})};m=Object(c.b)(h)(m),t.a=m},946:function(e,t,n){e.exports=n.p+"static/media/my_journey@2x.33460c8b.png"},947:function(e,t,n){e.exports=n.p+"static/media/my_journey_label@2x.61a60e0b.png"},948:function(e,t,n){e.exports=n.p+"static/media/journey-empty@2x.1d0ff9ec.png"},949:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n(0),s=n.n(a),c=n(2),u=n(9),l=n.n(u),p=n(15),f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),m=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),f(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"journeyIndexRecommendListView"},s.a.createElement("div",{className:"journeyIndexHeaderRow",onClick:this.props.onMoreButtonClick},s.a.createElement("img",{className:"journeyIndexHeaderIcon",src:n(950),alt:""}),s.a.createElement("div",{className:"journeyIndexHeaderTitle"},"\u63a8\u8350\u884c\u7a0b")),this.renderJourneyListView())}},{key:"renderJourneyListView",value:function(){var e=this;return this.props.dataList&&0!==this.props.dataList.length?this.props.dataList.map(function(t,n){return e.renderJourneyItemView(t,n)}):null}},{key:"renderJourneyItemView",value:function(e,t){var n=this,r=window.innerWidth-20,o=.6*r,i=t===this.props.dataList.length-1;return s.a.createElement("div",{key:t,className:"journeyIndexRecommendItem",style:i?{marginBottom:"0px"}:null,onClick:function(){n.props.onItemClick&&n.props.onItemClick(e)}},s.a.createElement("img",{src:e.GetImage.ImageFrontUrl,alt:"",style:{width:r+"px",height:o+"px"}}),s.a.createElement("div",{className:"journeyIndexRecommendItemName"},e.TourName),s.a.createElement("div",{className:"journeyIndexRecommendItemDate"},e.DayCount,"\u5929\u884c\u7a0b | \u51fa\u53d1\u65f6\u95f4\uff1a",e.BeginDate))}}]),t}(a.PureComponent);m.propTypes={onItemClick:l.a.func};var h=function(e,t){var n=e.journey.indexScreen.recommendList;return Object.assign({},n,{userId:p.a.getUserId(e)})};m=Object(c.b)(h)(m),t.a=m},950:function(e,t,n){e.exports=n.p+"static/media/recommend_journey@2x.fc7339d4.png"}});
//# sourceMappingURL=3.45ef835b.chunk.js.map