webpackJsonp([8],{883:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function r(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(11),s=(n.n(a),n(12)),c=n.n(s),l=n(44),u=(n.n(l),n(45)),f=n.n(u),p=n(0),h=n.n(p),d=n(2),m=n(10),y=n(930),E=n(909),g=n(288),b=(n.n(g),n(23)),w=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),C=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onItemClick=n.onItemClick.bind(n),n.showCommonList=n.showCommonList.bind(n),n}return r(t,e),w(t,[{key:"render",value:function(){var e=this,t=window.innerHeight-45;return h.a.createElement("div",null,h.a.createElement(c.a,{mode:"dark",className:"navBar",leftContent:h.a.createElement(b.a,{ref:function(t){e.LeftContentView=t?t.getWrappedInstance():e.scrollView},goBackAction:E.c,history:this.props.history}),onLeftClick:function(){e.LeftContentView.goHome()}},h.a.createElement(f.a,{values:["\u975e\u6e38\u4e0d\u53ef","\u5168\u90e8\u666f\u533a"],tintColor:"white",selectedIndex:0,onValueChange:this.showCommonList})),h.a.createElement(m.a,null,h.a.createElement(y.a,{ref:function(t){t&&(e.listView=t.getWrappedInstance())},onItemClick:this.onItemClick,height:t})))}},{key:"onItemClick",value:function(e){e&&e.GetRelation&&e.GetRelation.Code&&(this.listView&&this.listView.cacheScrollOffset(),this.props.history.push("/scenic/detail/"+e.GetRelation.Code))}},{key:"showCommonList",value:function(){this.listView&&this.listView.cacheScrollOffset(),this.props.history.push("/scenic/list?segment=true")}}]),t}(p.PureComponent);C=Object(d.b)()(C),t.default=C},898:function(e,t,n){e.exports=n.p+"static/media/ico_a_full@2x.a5d6eea0.png"},899:function(e,t,n){e.exports=n.p+"static/media/ico_a_empty@2x.f866e867.png"},909:function(e,t,n){"use strict";function i(){return function(e,t){return e(l()),c().then(function(t){var n=t&&t.results&&t.results.length>0?t.results:[];e(u(n))}).catch(function(t){e(f(t))})}}function o(){return{type:p.b.SCENIC.RECOMMEND_LIST.GO_BACK}}function r(){return function(e,t){return e(a()),new Promise(function(e){e()})}}function a(){return{type:p.b.SCENIC.RECOMMEND_LIST.DELETE}}function s(e){return{type:p.b.SCENIC.RECOMMEND_LIST.SET_LISTVIEW_OFFSET,listViewOffset:e}}function c(e,t,n,i){var o={ModuleEnName:"tuijianjingqu",CatalogIdentifier:"mobile/wanzhuan/you"};return h.a.getFromPortal(p.q.ELEMENTS.AttractionsRecommendList,o).then(function(e){return e.json()})}function l(){return{type:p.b.SCENIC.RECOMMEND_LIST.GET_LIST_REQUEST}}function u(e){return{type:p.b.SCENIC.RECOMMEND_LIST.GET_LIST_SUCCESS,dataList:e}}function f(e){return{type:p.b.SCENIC.RECOMMEND_LIST.GET_LIST_FAILURE,message:e}}t.b=i,t.c=o,t.a=r,t.d=s;var p=n(1),h=n(8)},930:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function r(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n(24),s=(n.n(a),n(25)),c=n.n(s),l=n(16),u=(n.n(l),n(17)),f=n.n(u),p=n(26),h=(n.n(p),n(27)),d=n.n(h),m=n(0),y=n.n(m),E=n(2),g=n(9),b=n.n(g),w=n(14),C=n.n(w),v=n(909),S=n(20),I=n(15),L=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),R=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.renderRow=n.renderRow.bind(n),n.onRefresh=n.onRefresh.bind(n);var r=new d.a.DataSource({rowHasChanged:function(e,t){return e!==t},sectionHeaderHasChanged:function(e,t){return e!==t}});return n.state={dataSource:r.cloneWithRows(n.props.dataList?n.props.dataList:[])},n}return r(t,e),L(t,[{key:"componentDidMount",value:function(){this.props.dataList||this.loadData(),this.listView&&!isNaN(this.props.listViewOffset)&&this.listView.scrollTo(0,this.props.listViewOffset)}},{key:"componentDidUpdate",value:function(e,t,n){this.props.dataList!==e.dataList&&this.setState({dataSource:this.state.dataSource.cloneWithRows(this.props.dataList?this.props.dataList:[])})}},{key:"render",value:function(){return y.a.createElement("div",{className:"scenicListBox",style:{height:this.props.height}},this.renderListView(),this.props.isFetching?y.a.createElement(f.a,{toast:!0,text:"Loading..."}):null)}},{key:"renderListView",value:function(){var e=this;if(this.props.dataList&&this.props.dataList.length>=0){var t=function(e,t){return y.a.createElement("div",{key:e+"-"+t,style:{height:"5px",backgroundColor:"#2d2327"}})};return y.a.createElement(d.a,{ref:function(t){e.listView=t,S.a.fixListViewHeightIssue(t,e.props.height)},dataSource:this.state.dataSource,renderRow:this.renderRow,renderSeparator:t,style:{height:this.props.height,overflow:"auto"},pullToRefresh:y.a.createElement(c.a,{refreshing:this.props.isFetching,onRefresh:this.onRefresh}),initialListSize:this.props.dataList.length,pageSize:20,scrollRenderAheadDistance:500,scrollEventThrottle:50,onEndReachedThreshold:20})}}},{key:"isEmptyString",value:function(e){return!e||0===e.length}},{key:"onRefresh",value:function(){var e=this;this.props.dispatch(Object(v.a)()).then(function(){e.loadData()})}},{key:"renderRow",value:function(e,t,i){var o=this,r=I.a.getScenicStarCount(e.GetRelation&&e.GetRelation.AttractionsStar?e.GetRelation.AttractionsStar:"0"),a=n(898),s=n(899),c=e.GetImage&&e.GetImage.MiddleImageFrontUrl?e.GetImage.MiddleImageFrontUrl:"";return c=c&&c.length>0&&c.indexOf("noPicture")<0?c:e.GetRelation&&e.GetRelation.GetImage&&e.GetRelation.GetImage.MiddleImageFrontUrl?e.GetRelation.GetImage.MiddleImageFrontUrl:"",y.a.createElement("div",{key:i,className:"scenicRecommendListItemBox",onClick:function(){o.props.onItemClick&&o.props.onItemClick(e)}},y.a.createElement("div",{className:"scenicRecommendListItemBg",style:{backgroundImage:"url("+c+")"}},y.a.createElement("div",{className:"scenicRecommendListBottom"},y.a.createElement("div",{className:"scenicDetailHeaderBottomText"},e.Head),y.a.createElement("div",{className:"scenicRecommendListBottomStars"},Array(5).fill(0).map(function(e,t){return y.a.createElement("img",{key:t,className:"scenicDetailHeaderBottomStar",src:t<r?a:s,alt:""})})))))}},{key:"loadData",value:function(){this.props.isFetching||this.props.dispatch(Object(v.b)())}},{key:"cacheScrollOffset",value:function(){if(this.listView){var e=C.a.findDOMNode(this.listView).scrollTop;this.props.dispatch(Object(v.d)(e))}}}]),t}(m.PureComponent);R.propTypes={onItemClick:b.a.func};var O=function(e){return Object.assign({},e.scenic.recommendListScreen)};R=Object(E.b)(O,null,null,{withRef:!0})(R),t.a=R}});
//# sourceMappingURL=8.85a0d149.chunk.js.map