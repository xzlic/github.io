{"version":3,"sources":["../static/js/14.7fb6e18b.chunk.js","screens/journey/JourneyAddPointScreen.js","views/journey/JourneyAddPointItemView.js","store/actions/journey/addPointAction.js"],"names":["webpackJsonp","896","module","__webpack_exports__","__webpack_require__","_toConsumableArray","arr","Array","isArray","i","arr2","length","from","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","defineProperty","__WEBPACK_IMPORTED_MODULE_0_antd_mobile_lib_pull_to_refresh_style_css__","__WEBPACK_IMPORTED_MODULE_1_antd_mobile_lib_pull_to_refresh__","n","__WEBPACK_IMPORTED_MODULE_1_antd_mobile_lib_pull_to_refresh___default","__WEBPACK_IMPORTED_MODULE_2_antd_mobile_lib_activity_indicator_style_css__","__WEBPACK_IMPORTED_MODULE_3_antd_mobile_lib_activity_indicator__","__WEBPACK_IMPORTED_MODULE_3_antd_mobile_lib_activity_indicator___default","__WEBPACK_IMPORTED_MODULE_4_antd_mobile_lib_nav_bar_style_css__","__WEBPACK_IMPORTED_MODULE_5_antd_mobile_lib_nav_bar__","__WEBPACK_IMPORTED_MODULE_5_antd_mobile_lib_nav_bar___default","__WEBPACK_IMPORTED_MODULE_6_antd_mobile_lib_icon_style_css__","__WEBPACK_IMPORTED_MODULE_7_antd_mobile_lib_icon__","__WEBPACK_IMPORTED_MODULE_7_antd_mobile_lib_icon___default","__WEBPACK_IMPORTED_MODULE_8_antd_mobile_lib_list_view_style_css__","__WEBPACK_IMPORTED_MODULE_9_antd_mobile_lib_list_view__","__WEBPACK_IMPORTED_MODULE_9_antd_mobile_lib_list_view___default","__WEBPACK_IMPORTED_MODULE_10_react__","__WEBPACK_IMPORTED_MODULE_10_react___default","__WEBPACK_IMPORTED_MODULE_11_react_redux__","__WEBPACK_IMPORTED_MODULE_12__views_common_Content__","__WEBPACK_IMPORTED_MODULE_13__views_journey_JourneyAddPointItemView__","__WEBPACK_IMPORTED_MODULE_14__core_utils_SysUtil__","__WEBPACK_IMPORTED_MODULE_15__store_actions_journey_addPointAction__","__WEBPACK_IMPORTED_MODULE_16__core_utils_IConstant__","__WEBPACK_IMPORTED_MODULE_17_react_dom__","__WEBPACK_IMPORTED_MODULE_17_react_dom___default","__WEBPACK_IMPORTED_MODULE_18__assets_css_journey_css__","_createClass","defineProperties","target","props","descriptor","key","protoProps","staticProps","JourneyAddPointScreen","_PureComponent","this","_this","getPrototypeOf","code","history","location","state","groupList","dayIndex","pointType","dayList","selectTypeList","item","Code","indexOf","You","Zhu","Chi","Gou","Yu","push","getNavTitle","itemSelectTapped","bind","addSubmitTapped","pointDetailTapped","renderRow","onRefresh","loadNextPage","dataSource","a","DataSource","rowHasChanged","row1","row2","sectionHeaderHasChanged","s1","s2","cloneWithRows","dataList","selectList","dispatch","restoreScrollViewPosition","prevProps","prevState","snapshot","setState","_this2","createElement","className","mode","icon","type","onLeftClick","goBack","rightContent","style","backgroundColor","color","fontSize","height","width","textAlign","lineHeight","borderRadius","naviTitle","renderListView","onClick","isFetching","toast","text","_this3","ref","el","listView","overflow","pullToRefresh","refreshing","onEndReached","initialListSize","pageSize","scrollRenderAheadDistance","scrollEventThrottle","onEndReachedThreshold","sectionID","rowID","userId","itemType","pageIndex","CanTing","index","isSelect","unSelectIndex","selectItem","splice","dataItem","assign","cacheScrollOffset","getEditDoneDayList","noChangeList","j","insertList","isInsert","removeList","isRemove","removeItem","newdayList","insertItem","offsetY","findDOMNode","scrollTop","isNaN","scrollViewOffset","mapStateToProps","ownProps","obj","journey","addPointScreen","getUserId","979","__WEBPACK_IMPORTED_MODULE_0_react__","__WEBPACK_IMPORTED_MODULE_0_react___default","JourneyAddPointItemView","apply","arguments","imgUrl","GetImage","SmallImageFrontUrl","backgroundImage","Name","PlayTime","Price","parseInt","980","goBackAction","journeyId","__WEBPACK_IMPORTED_MODULE_0__core_utils_IConstant__","JOURNEY","ADDPOINT","GO_BACK","asyncGetListAction","getState","_getListRequestAction","_fetchList","then","resp","results","showItem","_getListSuccessAction","catch","error","_getListFailureAction","dataListChangeAction","DATALIST_CHANGE","selectListChangeAction","SELECTLIST_CHANGE","selectPointDoneAction","SELECT_POINT_DONE","setScrollPositionAction","offset","SET_SCROLL_OFFSET","kvDict","__WEBPACK_IMPORTED_MODULE_1__core_utils_HttpClient__","postToPortal","FillTour","json","GET_LIST_REQUEST","result","GET_LIST_SUCCESS","GET_LIST_FAILURE","message"],"mappings":"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","file":"static/js/14.7fb6e18b.chunk.js","sourcesContent":["webpackJsonp([14],{\n\n/***/ 896:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_antd_mobile_lib_pull_to_refresh_style_css__ = __webpack_require__(24);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_antd_mobile_lib_pull_to_refresh_style_css___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_antd_mobile_lib_pull_to_refresh_style_css__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_antd_mobile_lib_pull_to_refresh__ = __webpack_require__(25);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_antd_mobile_lib_pull_to_refresh___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_antd_mobile_lib_pull_to_refresh__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_antd_mobile_lib_activity_indicator_style_css__ = __webpack_require__(16);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_antd_mobile_lib_activity_indicator_style_css___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_antd_mobile_lib_activity_indicator_style_css__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_antd_mobile_lib_activity_indicator__ = __webpack_require__(17);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_antd_mobile_lib_activity_indicator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_antd_mobile_lib_activity_indicator__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_antd_mobile_lib_nav_bar_style_css__ = __webpack_require__(11);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_antd_mobile_lib_nav_bar_style_css___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_antd_mobile_lib_nav_bar_style_css__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_antd_mobile_lib_nav_bar__ = __webpack_require__(12);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_antd_mobile_lib_nav_bar___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_antd_mobile_lib_nav_bar__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_antd_mobile_lib_icon_style_css__ = __webpack_require__(18);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_antd_mobile_lib_icon_style_css___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_antd_mobile_lib_icon_style_css__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_antd_mobile_lib_icon__ = __webpack_require__(19);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_antd_mobile_lib_icon___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_antd_mobile_lib_icon__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_antd_mobile_lib_list_view_style_css__ = __webpack_require__(26);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_antd_mobile_lib_list_view_style_css___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_8_antd_mobile_lib_list_view_style_css__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_antd_mobile_lib_list_view__ = __webpack_require__(27);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_antd_mobile_lib_list_view___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_9_antd_mobile_lib_list_view__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_react__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_react___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_10_react__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11_react_redux__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__views_common_Content__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__views_journey_JourneyAddPointItemView__ = __webpack_require__(979);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__core_utils_SysUtil__ = __webpack_require__(15);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__store_actions_journey_addPointAction__ = __webpack_require__(980);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16__core_utils_IConstant__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_17_react_dom__ = __webpack_require__(14);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_17_react_dom___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_17_react_dom__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_18__assets_css_journey_css__ = __webpack_require__(115);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_18__assets_css_journey_css___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_18__assets_css_journey_css__);\nvar _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if(\"value\"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i];}return arr2;}else{return Array.from(arr);}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError(\"Cannot call a class as a function\");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");}return call&&(typeof call===\"object\"||typeof call===\"function\")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!==\"function\"&&superClass!==null){throw new TypeError(\"Super expression must either be null or a function, not \"+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var JourneyAddPointScreen=function(_PureComponent){_inherits(JourneyAddPointScreen,_PureComponent);//全部行程天的 兴趣点\nfunction JourneyAddPointScreen(props){_classCallCheck(this,JourneyAddPointScreen);var _this=_possibleConstructorReturn(this,(JourneyAddPointScreen.__proto__||Object.getPrototypeOf(JourneyAddPointScreen)).call(this,props));_this.code=_this.props.history.location.state.code;_this.groupList=_this.props.history.location.state.groupList;_this.dayIndex=_this.props.history.location.state.dayIndex;_this.pointType=_this.props.history.location.state.pointType;_this.dayList=_this.groupList&&_this.groupList.length>_this.dayIndex?_this.groupList[_this.dayIndex]:[];_this.selectTypeList=[];for(var i=0;i<_this.dayList.length;i++){var item=_this.dayList[i];var code=item.Code;var isSelectType=code.indexOf('JQ')>=0&&_this.pointType===__WEBPACK_IMPORTED_MODULE_16__core_utils_IConstant__[\"h\" /* ItemType */].You||code.indexOf('JD')>=0&&_this.pointType===__WEBPACK_IMPORTED_MODULE_16__core_utils_IConstant__[\"h\" /* ItemType */].Zhu||code.indexOf('CT')>=0&&_this.pointType===__WEBPACK_IMPORTED_MODULE_16__core_utils_IConstant__[\"h\" /* ItemType */].Chi||code.indexOf('SD')>=0&&_this.pointType===__WEBPACK_IMPORTED_MODULE_16__core_utils_IConstant__[\"h\" /* ItemType */].Gou||code.indexOf('SQ')>=0&&_this.pointType===__WEBPACK_IMPORTED_MODULE_16__core_utils_IConstant__[\"h\" /* ItemType */].Gou||code.indexOf('YL')>=0&&_this.pointType===__WEBPACK_IMPORTED_MODULE_16__core_utils_IConstant__[\"h\" /* ItemType */].Yu;if(isSelectType){_this.selectTypeList.push(item);}}_this.getNavTitle();_this.itemSelectTapped=_this.itemSelectTapped.bind(_this);_this.addSubmitTapped=_this.addSubmitTapped.bind(_this);_this.pointDetailTapped=_this.pointDetailTapped.bind(_this);_this.renderRow=_this.renderRow.bind(_this);_this.onRefresh=_this.onRefresh.bind(_this);_this.loadNextPage=_this.loadNextPage.bind(_this);var dataSource=new __WEBPACK_IMPORTED_MODULE_9_antd_mobile_lib_list_view___default.a.DataSource({rowHasChanged:function rowHasChanged(row1,row2){return row1!==row2;},sectionHeaderHasChanged:function sectionHeaderHasChanged(s1,s2){return s1!==s2;}});_this.state={dataSource:dataSource.cloneWithRows(_this.props.dataList?_this.props.dataList:[])};return _this;}//全部行程天 －－当前类型过滤后的 兴趣点\n_createClass(JourneyAddPointScreen,[{key:'componentDidMount',value:function componentDidMount(){if(!this.props.selectList){this.props.dispatch(Object(__WEBPACK_IMPORTED_MODULE_15__store_actions_journey_addPointAction__[\"d\" /* selectListChangeAction */])(this.code,this.selectTypeList));}if(!this.props.dataList){this.onRefresh();}this.restoreScrollViewPosition();}},{key:'componentWillUnmount',value:function componentWillUnmount(){if(this.props.dataList){var dispatch=this.props.dispatch;dispatch(Object(__WEBPACK_IMPORTED_MODULE_15__store_actions_journey_addPointAction__[\"c\" /* goBackAction */])(this.code));}}},{key:'componentDidUpdate',value:function componentDidUpdate(prevProps,prevState,snapshot){if(this.props.dataList!==prevProps.dataList){var dataSource=new __WEBPACK_IMPORTED_MODULE_9_antd_mobile_lib_list_view___default.a.DataSource({rowHasChanged:function rowHasChanged(row1,row2){return row1!==row2;},sectionHeaderHasChanged:function sectionHeaderHasChanged(s1,s2){return s1!==s2;}});this.setState({dataSource:dataSource.cloneWithRows(this.props.dataList?this.props.dataList:[])});}}},{key:'render',value:function render(){var _this2=this;return __WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{className:'journeyAddPoint'},__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_5_antd_mobile_lib_nav_bar___default.a,{mode:'dark',className:'navBar',icon:__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_7_antd_mobile_lib_icon___default.a,{type:'left'}),onLeftClick:function onLeftClick(){var dispatch=_this2.props.dispatch;_this2.props.history.goBack();dispatch(Object(__WEBPACK_IMPORTED_MODULE_15__store_actions_journey_addPointAction__[\"c\" /* goBackAction */])(_this2.code));},rightContent:__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{style:{backgroundColor:'#00c6ad',color:'#fff',fontSize:'14px',height:'25px',width:'30px',textAlign:'center',lineHeight:'25px',borderRadius:'12px'}},this.props.selectList?this.props.selectList.length:this.selectTypeList.length)},this.naviTitle),__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_12__views_common_Content__[\"a\" /* default */],{style:{backgroundColor:'#edecf2'}},__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{className:'headerBox'},'\\u8BF7\\u9009\\u62E9\\u6B64\\u6B21\\u884C\\u7A0B\\u65B0\\u589E\\u666F\\u70B9(\\u591A\\u9009),\\u8BF7\\u70B9\\u51FB\\u56FE\\u7247\\u9009\\u62E9:'),this.renderListView(),__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement('div',{className:'submitBox',onClick:function onClick(){return _this2.addSubmitTapped();}},'\\u786E\\u5B9A'),this.props.isFetching?__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_3_antd_mobile_lib_activity_indicator___default.a,{toast:true,text:'Loading...'}):null));}},{key:'renderListView',value:function renderListView(){var _this3=this;if(!this.props.dataList||this.props.dataList.length===0){return null;}return __WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_9_antd_mobile_lib_list_view___default.a,{className:'listView',ref:function ref(el){return _this3.listView=el;},dataSource:this.state.dataSource,renderRow:this.renderRow,style:{overflow:'auto'},pullToRefresh:__WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_1_antd_mobile_lib_pull_to_refresh___default.a,{refreshing:this.props.isFetching,onRefresh:this.onRefresh}),onEndReached:this.loadNextPage,initialListSize:this.props.dataList.length,pageSize:20,scrollRenderAheadDistance:500,scrollEventThrottle:50,onEndReachedThreshold:20});}},{key:'renderRow',value:function renderRow(item,sectionID,rowID){return __WEBPACK_IMPORTED_MODULE_10_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_13__views_journey_JourneyAddPointItemView__[\"a\" /* default */],{key:rowID,item:item,itemSelectTapped:this.itemSelectTapped,pointDetailTapped:this.pointDetailTapped});}},{key:'onRefresh',value:function onRefresh(){var pageIndex=1;var userId=this.props.userId?this.props.userId:132;var selectList=this.props.selectList?this.props.selectList:this.selectTypeList;this.props.dispatch(Object(__WEBPACK_IMPORTED_MODULE_15__store_actions_journey_addPointAction__[\"a\" /* asyncGetListAction */])(this.code,userId,this.itemType,pageIndex,selectList));}},{key:'loadNextPage',value:function loadNextPage(){var pageIndex=this.props.pageIndex?this.props.pageIndex+1:1;var userId=this.props.userId?this.props.userId:132;var selectList=this.props.selectList?this.props.selectList:this.selectTypeList;this.props.dispatch(Object(__WEBPACK_IMPORTED_MODULE_15__store_actions_journey_addPointAction__[\"a\" /* asyncGetListAction */])(this.code,userId,this.itemType,pageIndex,selectList));}},{key:'getNavTitle',value:function getNavTitle(){if(this.pointType===__WEBPACK_IMPORTED_MODULE_16__core_utils_IConstant__[\"h\" /* ItemType */].CanTing){this.itemType=2;this.naviTitle='餐厅';}else if(this.pointType===__WEBPACK_IMPORTED_MODULE_16__core_utils_IConstant__[\"h\" /* ItemType */].Zhu){this.itemType=1;this.naviTitle='酒店';}else if(this.pointType===__WEBPACK_IMPORTED_MODULE_16__core_utils_IConstant__[\"h\" /* ItemType */].You){this.itemType=0;this.naviTitle='景点';}else if(this.pointType===__WEBPACK_IMPORTED_MODULE_16__core_utils_IConstant__[\"h\" /* ItemType */].Gou){this.itemType=4;this.naviTitle='购物';}else if(this.pointType===__WEBPACK_IMPORTED_MODULE_16__core_utils_IConstant__[\"h\" /* ItemType */].Yu){this.itemType=3;this.naviTitle='娱乐';}this.naviTitle='新增'+this.naviTitle;}},{key:'itemSelectTapped',value:function itemSelectTapped(item,index){item=Object.assign({},item);var dataList=[].concat(_toConsumableArray(this.props.dataList));var selectList=[].concat(_toConsumableArray(this.props.selectList));if(item.isSelect){//取消\nitem.isSelect=false;var unSelectIndex=void 0;for(var i=0;i<selectList.length;i++){var selectItem=selectList[i];if(item.Code===selectItem.Code){unSelectIndex=i;break;}}selectList.splice(unSelectIndex,1);}else{//选择\nitem.isSelect=true;selectList.push(item);}for(var _i=0;_i<dataList.length;_i++){var dataItem=dataList[_i];if(dataItem.Code===item.Code){dataItem.isSelect=item.isSelect;dataList[_i]=Object.assign({},dataItem);break;}}this.props.dispatch(Object(__WEBPACK_IMPORTED_MODULE_15__store_actions_journey_addPointAction__[\"b\" /* dataListChangeAction */])(this.code,dataList));this.props.dispatch(Object(__WEBPACK_IMPORTED_MODULE_15__store_actions_journey_addPointAction__[\"d\" /* selectListChangeAction */])(this.code,selectList));}},{key:'pointDetailTapped',value:function pointDetailTapped(item){//兴趣点详情\nthis.cacheScrollOffset();var code=item.Code;if(code.indexOf('JQ')>=0){this.props.history.push('/scenic/detail/'+code);}else if(code.indexOf('JD')>=0){this.props.history.push('/hotel/detail/'+code);}else if(code.indexOf('CT')>=0){this.props.history.push('/restaurant/detail/'+code);}else if(code.indexOf('SD')>=0||code.indexOf('SQ')>=0){this.props.history.push('/shopping/detail/'+code);}else if(code.indexOf('YL')>=0){this.props.history.push('/fun/detail/'+code);}}// 确定\n},{key:'addSubmitTapped',value:function addSubmitTapped(){var dayList=this.getEditDoneDayList();var groupList=[].concat(_toConsumableArray(this.groupList));groupList[this.dayIndex]=dayList;var dispatch=this.props.dispatch;dispatch(Object(__WEBPACK_IMPORTED_MODULE_15__store_actions_journey_addPointAction__[\"e\" /* selectPointDoneAction */])(this.code,groupList));this.props.history.goBack();dispatch(Object(__WEBPACK_IMPORTED_MODULE_15__store_actions_journey_addPointAction__[\"c\" /* goBackAction */])(this.code));}},{key:'getEditDoneDayList',value:function getEditDoneDayList(){var dayList=[].concat(_toConsumableArray(this.dayList));var selectList=[].concat(_toConsumableArray(this.props.selectList));var noChangeList=[];//未改变的\nfor(var i=0;i<selectList.length;i++){var selectItem=selectList[i];for(var j=0;j<this.selectTypeList.length;j++){var item=this.selectTypeList[j];if(selectItem.Code===item.Code){noChangeList.push(selectItem);break;}}}var insertList=[];//新增加的\nfor(var _i2=0;_i2<selectList.length;_i2++){var _selectItem=selectList[_i2];var isInsert=true;for(var _j=0;_j<noChangeList.length;_j++){var _item=noChangeList[_j];if(_selectItem.Code===_item.Code){isInsert=false;break;}}if(isInsert){insertList.push(_selectItem);}}var removeList=[];//被删除的\nfor(var _i3=0;_i3<this.selectTypeList.length;_i3++){var _selectItem2=selectList[_i3];var isRemove=true;for(var _j2=0;_j2<noChangeList.length;_j2++){var _item2=noChangeList[_j2];if(_selectItem2.Code===_item2.Code){isRemove=false;break;}}if(isRemove){removeList.push(_selectItem2);}}//删除 \nfor(var _i4=0;_i4<removeList.length;_i4++){var removeItem=removeList[_i4];var newdayList=[].concat(_toConsumableArray(dayList));for(var _j3=0;_j3<newdayList.length;_j3++){var _item3=newdayList[_j3];if(removeItem.Code===_item3.Code){dayList.splice(_j3,1);break;}}}//新增\nfor(var _i5=0;_i5<insertList.length;_i5++){var insertItem=insertList[_i5];dayList.push(insertItem);}return dayList;}// 缓存位置\n},{key:'cacheScrollOffset',value:function cacheScrollOffset(){var offsetY=__WEBPACK_IMPORTED_MODULE_17_react_dom___default.a.findDOMNode(this.listView).scrollTop;this.props.dispatch(Object(__WEBPACK_IMPORTED_MODULE_15__store_actions_journey_addPointAction__[\"f\" /* setScrollPositionAction */])(this.code,offsetY));}},{key:'restoreScrollViewPosition',value:function restoreScrollViewPosition(){if(this.listView&&!isNaN(this.props.scrollViewOffset)){__WEBPACK_IMPORTED_MODULE_17_react_dom___default.a.findDOMNode(this.listView).scrollTop=this.props.scrollViewOffset;}}}]);return JourneyAddPointScreen;}(__WEBPACK_IMPORTED_MODULE_10_react__[\"PureComponent\"]);var mapStateToProps=function mapStateToProps(state,ownProps){var obj=state.journey.addPointScreen[ownProps.history.location.state.code];return Object.assign({},obj,{userId:__WEBPACK_IMPORTED_MODULE_14__core_utils_SysUtil__[\"a\" /* default */].getUserId(state)});};JourneyAddPointScreen=Object(__WEBPACK_IMPORTED_MODULE_11_react_redux__[\"b\" /* connect */])(mapStateToProps)(JourneyAddPointScreen);/* harmony default export */ __webpack_exports__[\"default\"] = (JourneyAddPointScreen);\n\n/***/ }),\n\n/***/ 979:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_react__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_react___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_react__);\nvar _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if(\"value\"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError(\"Cannot call a class as a function\");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");}return call&&(typeof call===\"object\"||typeof call===\"function\")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!==\"function\"&&superClass!==null){throw new TypeError(\"Super expression must either be null or a function, not \"+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var JourneyAddPointItemView=function(_PureComponent){_inherits(JourneyAddPointItemView,_PureComponent);function JourneyAddPointItemView(){_classCallCheck(this,JourneyAddPointItemView);return _possibleConstructorReturn(this,(JourneyAddPointItemView.__proto__||Object.getPrototypeOf(JourneyAddPointItemView)).apply(this,arguments));}_createClass(JourneyAddPointItemView,[{key:'render',value:function render(){var _this2=this;var item=this.props.item;var imgUrl=item.GetImage.SmallImageFrontUrl?item.GetImage.SmallImageFrontUrl:'';// console.log(`...render(${item.Code})`);\nreturn __WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('div',{className:'rowItem'},__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('div',{className:'rowImage',style:{backgroundImage:'url('+imgUrl+')'},onClick:function onClick(){return _this2.props.itemSelectTapped(item);}},item.isSelect?__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('div',{className:'selectHighBg'}):null),__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('div',{className:'rowRight',onClick:function onClick(){return _this2.props.pointDetailTapped(item);}},__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('div',{className:'rowInfo'},__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('div',{className:'pointName'},item.Name),__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('div',{className:'pointName'},'\\u6E38\\u73A9\\u65F6\\u95F4\\uFF1A',item.PlayTime,'\\u5C0F\\u65F6'),item.Price&&item.Price.length>0?__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('div',{className:'pointPrice'},parseInt(item.Price,10)>0?'￥'+item.Price+'人':'免费'):null),__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('div',{className:'rowMore'},'\\u8BE6\\u60C5>')));}}]);return JourneyAddPointItemView;}(__WEBPACK_IMPORTED_MODULE_0_react__[\"PureComponent\"]);/* harmony default export */ __webpack_exports__[\"a\"] = (JourneyAddPointItemView);\n\n/***/ }),\n\n/***/ 980:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"c\"] = goBackAction;\n/* unused harmony export isFetchingChangeAction */\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = asyncGetListAction;\n/* harmony export (immutable) */ __webpack_exports__[\"b\"] = dataListChangeAction;\n/* harmony export (immutable) */ __webpack_exports__[\"d\"] = selectListChangeAction;\n/* harmony export (immutable) */ __webpack_exports__[\"e\"] = selectPointDoneAction;\n/* harmony export (immutable) */ __webpack_exports__[\"f\"] = setScrollPositionAction;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__core_utils_IConstant__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_utils_HttpClient__ = __webpack_require__(8);\nfunction goBackAction(journeyId){return{type:__WEBPACK_IMPORTED_MODULE_0__core_utils_IConstant__[\"b\" /* Actions */].JOURNEY.ADDPOINT.GO_BACK,journeyId:journeyId};}function isFetchingChangeAction(journeyId,isFetching){return{type:__WEBPACK_IMPORTED_MODULE_0__core_utils_IConstant__[\"b\" /* Actions */].JOURNEY.ADDPOINT.IS_FETCHING_CHANGE,journeyId:journeyId,isFetching:isFetching};}function asyncGetListAction(journeyId,userId,itemType,pageIndex,dayList){return function(dispatch,getState){dispatch(_getListRequestAction(journeyId,pageIndex));return _fetchList(journeyId,userId,itemType,pageIndex).then(function(resp){var dataList=resp.results;for(var i=0;i<dataList.length;i++){var showItem=dataList[i];for(var j=0;j<dayList.length;j++){var selectItem=dayList[j];if(showItem.Code===selectItem.Code){showItem.isSelect=true;break;}}}dispatch(_getListSuccessAction(journeyId,pageIndex,dataList));}).catch(function(error){dispatch(_getListFailureAction(journeyId,pageIndex,error));});};}function dataListChangeAction(journeyId,dataList){return{type:__WEBPACK_IMPORTED_MODULE_0__core_utils_IConstant__[\"b\" /* Actions */].JOURNEY.ADDPOINT.DATALIST_CHANGE,journeyId:journeyId,dataList:dataList};}function selectListChangeAction(journeyId,selectList){return{type:__WEBPACK_IMPORTED_MODULE_0__core_utils_IConstant__[\"b\" /* Actions */].JOURNEY.ADDPOINT.SELECTLIST_CHANGE,journeyId:journeyId,selectList:selectList};}function selectPointDoneAction(journeyId,groupList){return{type:__WEBPACK_IMPORTED_MODULE_0__core_utils_IConstant__[\"b\" /* Actions */].JOURNEY.ADDPOINT.SELECT_POINT_DONE,journeyId:journeyId,groupList:groupList};}function setScrollPositionAction(journeyId,offset){return{type:__WEBPACK_IMPORTED_MODULE_0__core_utils_IConstant__[\"b\" /* Actions */].JOURNEY.ADDPOINT.SET_SCROLL_OFFSET,scrollViewOffset:offset,journeyId:journeyId};}function _fetchList(journeyId,userId,itemType,pageIndex){var kvDict={key:itemType,pageIndex:pageIndex,pageSize:10};return __WEBPACK_IMPORTED_MODULE_1__core_utils_HttpClient__[\"a\" /* default */].postToPortal(__WEBPACK_IMPORTED_MODULE_0__core_utils_IConstant__[\"q\" /* PortalApis */].JOURNEY.FillTour,kvDict,null,true).then(function(resp){return resp.json();});}function _getListRequestAction(journeyId,pageIndex){return{type:__WEBPACK_IMPORTED_MODULE_0__core_utils_IConstant__[\"b\" /* Actions */].JOURNEY.ADDPOINT.GET_LIST_REQUEST,journeyId:journeyId,pageIndex:pageIndex};}function _getListSuccessAction(journeyId,pageIndex,result){return{type:__WEBPACK_IMPORTED_MODULE_0__core_utils_IConstant__[\"b\" /* Actions */].JOURNEY.ADDPOINT.GET_LIST_SUCCESS,journeyId:journeyId,pageIndex:pageIndex,result:result};}function _getListFailureAction(journeyId,pageIndex,error){return{type:__WEBPACK_IMPORTED_MODULE_0__core_utils_IConstant__[\"b\" /* Actions */].JOURNEY.ADDPOINT.GET_LIST_FAILURE,journeyId:journeyId,pageIndex:pageIndex,message:error};}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/js/14.7fb6e18b.chunk.js","import React, { PureComponent } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { NavBar, Icon, ActivityIndicator,ListView ,PullToRefresh} from 'antd-mobile';\r\nimport Content from '../../views/common/Content';\r\nimport JourneyAddPointItemView from '../../views/journey/JourneyAddPointItemView';\r\nimport SysUtil from '../../core/utils/SysUtil';\r\nimport { goBackAction,selectPointDoneAction ,asyncGetListAction,dataListChangeAction,selectListChangeAction,setScrollPositionAction } from '../../store/actions/journey/addPointAction';\r\nimport { ItemType } from '../../core/utils/IConstant';\r\nimport ReactDOM from 'react-dom';\r\n\r\nimport '../../assets/css/journey.css';\r\n\r\nclass JourneyAddPointScreen extends PureComponent\r\n{\r\n    code;\r\n    groupList;\r\n    dayIndex;\r\n    dayList; //全部行程天的 兴趣点\r\n    selectTypeList;  //全部行程天 －－当前类型过滤后的 兴趣点\r\n    pointType;\r\n    constructor(props)\r\n    {\r\n        super(props);\r\n\r\n        this.code = this.props.history.location.state.code;\r\n        this.groupList = this.props.history.location.state.groupList;\r\n        this.dayIndex = this.props.history.location.state.dayIndex; \r\n        this.pointType = this.props.history.location.state.pointType;\r\n        this.dayList = this.groupList && this.groupList.length > this.dayIndex ? this.groupList[this.dayIndex] : [];\r\n        this.selectTypeList = [];\r\n        for (let i = 0 ; i < this.dayList.length; i++)\r\n        {\r\n            let item = this.dayList[i];\r\n            let code = item.Code;\r\n            let isSelectType = (code.indexOf('JQ') >= 0 && this.pointType === ItemType.You) ||\r\n                                (code.indexOf('JD') >= 0 && this.pointType === ItemType.Zhu) ||\r\n                                (code.indexOf('CT') >= 0 && this.pointType === ItemType.Chi) ||\r\n                                (code.indexOf('SD') >= 0 && this.pointType === ItemType.Gou) ||\r\n                                (code.indexOf('SQ') >= 0 && this.pointType === ItemType.Gou) ||\r\n                                (code.indexOf('YL') >= 0 && this.pointType === ItemType.Yu); \r\n            if (isSelectType) {\r\n                this.selectTypeList.push(item);\r\n            }\r\n        }\r\n        \r\n        this.getNavTitle();\r\n\r\n        this.itemSelectTapped = this.itemSelectTapped.bind(this);\r\n        this.addSubmitTapped = this.addSubmitTapped.bind(this);\r\n        this.pointDetailTapped = this.pointDetailTapped.bind(this);\r\n        this.renderRow = this.renderRow.bind(this);\r\n        this.onRefresh = this.onRefresh.bind(this);\r\n        this.loadNextPage = this.loadNextPage.bind(this);\r\n\r\n        const dataSource = new ListView.DataSource({\r\n            rowHasChanged: (row1, row2) => row1 !== row2,\r\n            sectionHeaderHasChanged: (s1, s2) => s1 !== s2,\r\n        });\r\n\r\n        this.state = {\r\n            dataSource: dataSource.cloneWithRows(this.props.dataList ? this.props.dataList : []),\r\n        };\r\n    }\r\n    componentDidMount()\r\n    {\r\n        if (!this.props.selectList)\r\n        {\r\n            this.props.dispatch(selectListChangeAction(this.code,this.selectTypeList));\r\n        }\r\n        if (!this.props.dataList)\r\n        {\r\n            this.onRefresh();\r\n        }\r\n        this.restoreScrollViewPosition();\r\n    }\r\n    componentWillUnmount()\r\n    {\r\n        if (this.props.dataList) {\r\n            let dispatch = this.props.dispatch;\r\n            dispatch(goBackAction(this.code));\r\n        }\r\n    }\r\n    componentDidUpdate(prevProps, prevState, snapshot)\r\n    {\r\n        if(this.props.dataList !== prevProps.dataList)\r\n        {\r\n            const dataSource = new ListView.DataSource({\r\n                rowHasChanged: (row1, row2) => row1 !== row2,\r\n                sectionHeaderHasChanged: (s1, s2) => s1 !== s2,\r\n            });\r\n            this.setState({dataSource: dataSource.cloneWithRows(this.props.dataList ? this.props.dataList : [])});\r\n        }\r\n    }\r\n\r\n    render()\r\n    {\r\n        return (\r\n            <div className=\"journeyAddPoint\" >\r\n                <NavBar mode=\"dark\" \r\n                    className=\"navBar\"\r\n                    icon={<Icon type=\"left\" />}\r\n                    onLeftClick={() => {\r\n                        let dispatch = this.props.dispatch;\r\n                        this.props.history.goBack();\r\n                        dispatch(goBackAction(this.code));\r\n                    }}\r\n                    rightContent={<div style={{backgroundColor:'#00c6ad',color:'#fff',fontSize:'14px',height:'25px',width:'30px',textAlign:'center',lineHeight:'25px',borderRadius:'12px'}}>{this.props.selectList ? this.props.selectList.length : this.selectTypeList.length}</div>}>\r\n                    {this.naviTitle}\r\n                </NavBar>\r\n                <Content style={{backgroundColor:'#edecf2'}}>\r\n                    <div className=\"headerBox\">请选择此次行程新增景点(多选),请点击图片选择:</div>\r\n                    {\r\n                        this.renderListView()\r\n                    }\r\n                    <div className=\"submitBox\" onClick={()=>this.addSubmitTapped()}>确定</div>\r\n                    {\r\n                        this.props.isFetching\r\n                            ?\r\n                            <ActivityIndicator \r\n                                toast\r\n                                text=\"Loading...\" />\r\n                            :null\r\n                    }\r\n                </Content>\r\n            </div>\r\n        );\r\n    }\r\n    \r\n    renderListView()\r\n    {\r\n        if(!this.props.dataList || this.props.dataList.length === 0)\r\n        {\r\n            return null;\r\n        }\r\n        return (\r\n            <ListView\r\n                className=\"listView\"\r\n                ref={el => this.listView = el}\r\n                dataSource={this.state.dataSource}\r\n                renderRow={this.renderRow}\r\n                style={{\r\n                    overflow: 'auto',\r\n                }}\r\n                pullToRefresh={<PullToRefresh\r\n                    refreshing={this.props.isFetching}\r\n                    onRefresh={this.onRefresh}\r\n                />}\r\n                onEndReached={this.loadNextPage}\r\n                initialListSize={this.props.dataList.length}\r\n                pageSize={20}\r\n                scrollRenderAheadDistance={500}\r\n                scrollEventThrottle={50}\r\n                onEndReachedThreshold={20}/>\r\n        );\r\n    }\r\n\r\n    renderRow(item, sectionID, rowID)\r\n    {\r\n        return <JourneyAddPointItemView key={rowID}\r\n            item={item}\r\n            itemSelectTapped={this.itemSelectTapped}\r\n            pointDetailTapped={this.pointDetailTapped}/>;\r\n    }\r\n\r\n    onRefresh()\r\n    {\r\n        let pageIndex = 1;\r\n        let userId = this.props.userId ? this.props.userId : 132;\r\n        let selectList = this.props.selectList ? this.props.selectList : this.selectTypeList;\r\n        this.props.dispatch(asyncGetListAction(this.code,userId,this.itemType,pageIndex,selectList));\r\n    }\r\n    loadNextPage()\r\n    {\r\n        let pageIndex = this.props.pageIndex ? (this.props.pageIndex + 1) : 1;\r\n        let userId = this.props.userId ? this.props.userId : 132;\r\n        let selectList = this.props.selectList ? this.props.selectList : this.selectTypeList;\r\n        this.props.dispatch(asyncGetListAction(this.code,userId,this.itemType,pageIndex,selectList));\r\n    }\r\n\r\n    getNavTitle()\r\n    {\r\n        if (this.pointType === ItemType.CanTing) {\r\n            this.itemType = 2;\r\n            this.naviTitle = '餐厅';\r\n        } else if (this.pointType === ItemType.Zhu) {\r\n            this.itemType = 1;\r\n            this.naviTitle = '酒店';\r\n        } else if (this.pointType === ItemType.You) {\r\n            this.itemType = 0;\r\n            this.naviTitle = '景点';\r\n        } else if (this.pointType === ItemType.Gou) {\r\n            this.itemType = 4;\r\n            this.naviTitle = '购物';\r\n        } else if (this.pointType === ItemType.Yu) {\r\n            this.itemType = 3;\r\n            this.naviTitle = '娱乐';\r\n        }\r\n        this.naviTitle = '新增' + this.naviTitle;\r\n    }\r\n\r\n    itemSelectTapped(item,index)\r\n    {\r\n        item = {...item};\r\n        let dataList = [...this.props.dataList];\r\n        let selectList = [...this.props.selectList];\r\n        if (item.isSelect)\r\n        {\r\n            //取消\r\n            item.isSelect = false;\r\n            let unSelectIndex;\r\n            \r\n            for (let i = 0; i < selectList.length; i++) {\r\n                let selectItem = selectList[i];\r\n                if (item.Code === selectItem.Code) {\r\n                    unSelectIndex = i;\r\n                    break;\r\n                }\r\n            }\r\n            selectList.splice(unSelectIndex,1);\r\n        }\r\n        else\r\n        {\r\n            //选择\r\n            item.isSelect = true;\r\n            selectList.push(item);\r\n        }\r\n        for (let i = 0 ; i < dataList.length; i++)\r\n        {\r\n            let dataItem = dataList[i];\r\n            if(dataItem.Code === item.Code)\r\n            {\r\n                dataItem.isSelect = item.isSelect;\r\n                dataList[i] = {...dataItem};\r\n                break;\r\n            }\r\n        }\r\n        this.props.dispatch(dataListChangeAction(this.code,dataList));\r\n        this.props.dispatch(selectListChangeAction(this.code,selectList));\r\n    }\r\n\r\n    pointDetailTapped(item)\r\n    {\r\n        //兴趣点详情\r\n        this.cacheScrollOffset();\r\n        let code = item.Code;\r\n        if (code.indexOf('JQ') >= 0) {\r\n            this.props.history.push(`/scenic/detail/${code}`);\r\n        }\r\n        else if(code.indexOf('JD') >= 0)\r\n        {\r\n            this.props.history.push(`/hotel/detail/${code}`);\r\n        }\r\n        else if(code.indexOf('CT') >= 0)\r\n        {\r\n            this.props.history.push(`/restaurant/detail/${code}`);\r\n        }\r\n        else if(code.indexOf('SD') >= 0 || code.indexOf('SQ') >= 0)\r\n        {\r\n            this.props.history.push(`/shopping/detail/${code}`);\r\n        }\r\n        else if(code.indexOf('YL') >= 0)\r\n        {\r\n            this.props.history.push(`/fun/detail/${code}`);\r\n        }\r\n    }\r\n\r\n    // 确定\r\n    addSubmitTapped()\r\n    {\r\n        let dayList = this.getEditDoneDayList();\r\n        let groupList = [...this.groupList];\r\n        groupList[this.dayIndex] = dayList;\r\n\r\n        let dispatch = this.props.dispatch;\r\n        dispatch(selectPointDoneAction(this.code,groupList));\r\n        this.props.history.goBack();\r\n        dispatch(goBackAction(this.code));\r\n    }\r\n\r\n    getEditDoneDayList()\r\n    {\r\n        let dayList = [...this.dayList];\r\n        let selectList = [...this.props.selectList];\r\n\r\n        let noChangeList = []; //未改变的\r\n        for (let i = 0; i < selectList.length; i++)\r\n        {\r\n            let selectItem = selectList[i];\r\n            for (let j = 0; j < this.selectTypeList.length; j++)\r\n            {\r\n                let item = this.selectTypeList[j];\r\n                if (selectItem.Code === item.Code)\r\n                {\r\n                    noChangeList.push(selectItem);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        let insertList = []; //新增加的\r\n        for(let i = 0; i < selectList.length; i++)\r\n        {\r\n            let selectItem = selectList[i];\r\n            let isInsert = true;\r\n            for (let j = 0; j < noChangeList.length; j++)\r\n            {\r\n                let item = noChangeList[j];\r\n                if (selectItem.Code === item.Code)\r\n                {\r\n                    isInsert = false;\r\n                    break;\r\n                }\r\n            }\r\n            if (isInsert)\r\n            {\r\n                insertList.push(selectItem);\r\n            }\r\n        }\r\n\r\n        let removeList = []; //被删除的\r\n        for(let i = 0; i < this.selectTypeList.length; i++)\r\n        {\r\n            let selectItem = selectList[i];\r\n            let isRemove = true;\r\n            for (let j = 0; j < noChangeList.length; j++)\r\n            {\r\n                let item = noChangeList[j];\r\n                if (selectItem.Code === item.Code)\r\n                {\r\n                    isRemove = false;\r\n                    break;\r\n                }\r\n            }\r\n            if (isRemove)\r\n            {\r\n                removeList.push(selectItem);\r\n            }\r\n        }\r\n\r\n        //删除 \r\n        for (let i = 0; i < removeList.length; i++)\r\n        {\r\n            let removeItem = removeList[i];\r\n            let newdayList = [...dayList];\r\n            for (let j =0; j < newdayList.length; j++)\r\n            {\r\n                let item = newdayList[j];\r\n                if (removeItem.Code === item.Code)\r\n                {\r\n                    dayList.splice(j,1);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        //新增\r\n        for (let i = 0; i < insertList.length; i++)\r\n        {\r\n            let insertItem = insertList[i];\r\n            dayList.push(insertItem);\r\n        }\r\n        return dayList;\r\n    }\r\n\r\n    // 缓存位置\r\n    cacheScrollOffset() {\r\n        let offsetY = ReactDOM.findDOMNode(this.listView).scrollTop;\r\n        this.props.dispatch(setScrollPositionAction(this.code, offsetY));\r\n    }\r\n    restoreScrollViewPosition() {\r\n        if (this.listView && !isNaN(this.props.scrollViewOffset)){\r\n            ReactDOM.findDOMNode(this.listView).scrollTop = this.props.scrollViewOffset;\r\n        }\r\n    }\r\n}\r\n\r\nconst mapStateToProps = function(state, ownProps)\r\n{\r\n    let obj = state.journey.addPointScreen[ownProps.history.location.state.code];\r\n    return {\r\n        ...obj,\r\n        userId: SysUtil.getUserId(state),\r\n    };\r\n};\r\n\r\nJourneyAddPointScreen = connect(mapStateToProps)(JourneyAddPointScreen);\r\n\r\nexport default JourneyAddPointScreen;\n\n\n// WEBPACK FOOTER //\n// ./src/screens/journey/JourneyAddPointScreen.js","import React, { PureComponent } from 'react';\r\n\r\nexport default class JourneyAddPointItemView extends PureComponent\r\n{\r\n    render()\r\n    {\r\n        let item = this.props.item;\r\n        let imgUrl = item.GetImage.SmallImageFrontUrl ? item.GetImage.SmallImageFrontUrl : '';\r\n        // console.log(`...render(${item.Code})`);\r\n        return (\r\n            <div className=\"rowItem\">\r\n                <div className=\"rowImage\" style={{backgroundImage: `url(${imgUrl})`}} onClick={()=>this.props.itemSelectTapped(item)}>\r\n                    {\r\n                        item.isSelect\r\n                            ?\r\n                            <div className=\"selectHighBg\"/>\r\n                            :\r\n                            null\r\n                    }\r\n                </div>\r\n                <div className=\"rowRight\" onClick={()=>this.props.pointDetailTapped(item)}>\r\n                    <div className=\"rowInfo\">\r\n                        <div className=\"pointName\">{item.Name}</div>\r\n                        <div className=\"pointName\">游玩时间：{item.PlayTime}小时</div>\r\n                        {\r\n                            item.Price && item.Price.length > 0 ?\r\n                                <div className=\"pointPrice\">{ parseInt(item.Price,10) > 0  ? ('￥' + item.Price + '人') : '免费'}</div>\r\n                                :\r\n                                null\r\n                        }\r\n                    </div>\r\n                    <div className=\"rowMore\">详情></div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/views/journey/JourneyAddPointItemView.js","import * as IConstant from '../../../core/utils/IConstant';\r\nimport HttpClient from '../../../core/utils/HttpClient';\r\n\r\nexport function goBackAction(journeyId)\r\n{\r\n    return {\r\n        type: IConstant.Actions.JOURNEY.ADDPOINT.GO_BACK,\r\n        journeyId,\r\n    };\r\n}\r\n\r\nexport function isFetchingChangeAction(journeyId,isFetching)\r\n{\r\n    return {\r\n        type: IConstant.Actions.JOURNEY.ADDPOINT.IS_FETCHING_CHANGE,\r\n        journeyId,\r\n        isFetching:isFetching\r\n    };\r\n}\r\n\r\nexport function asyncGetListAction(journeyId,userId,itemType, pageIndex,dayList)\r\n{\r\n    return function(dispatch, getState)\r\n    {\r\n        dispatch(_getListRequestAction(journeyId, pageIndex));\r\n        return _fetchList(journeyId,userId,itemType, pageIndex).then((resp)=>{\r\n            let dataList = resp.results;\r\n            for (let i = 0 ; i < dataList.length; i++)\r\n            {\r\n                let showItem = dataList[i];\r\n                for (let j = 0 ; j < dayList.length; j++)\r\n                {\r\n                    let selectItem = dayList[j];\r\n                    if (showItem.Code === selectItem.Code)\r\n                    {\r\n                        showItem.isSelect = true;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            dispatch(_getListSuccessAction(journeyId, pageIndex, dataList));\r\n        }).catch((error)=>{\r\n            dispatch(_getListFailureAction(journeyId, pageIndex, error));\r\n        });\r\n    };\r\n}\r\n\r\nexport function dataListChangeAction(journeyId,dataList)\r\n{\r\n    return {\r\n        type: IConstant.Actions.JOURNEY.ADDPOINT.DATALIST_CHANGE,\r\n        journeyId,\r\n        dataList:dataList\r\n    };\r\n}\r\n\r\nexport function selectListChangeAction(journeyId,selectList)\r\n{\r\n    return {\r\n        type: IConstant.Actions.JOURNEY.ADDPOINT.SELECTLIST_CHANGE,\r\n        journeyId,\r\n        selectList\r\n    };\r\n}\r\n\r\nexport function selectPointDoneAction(journeyId,groupList)\r\n{\r\n    return {\r\n        type: IConstant.Actions.JOURNEY.ADDPOINT.SELECT_POINT_DONE,\r\n        journeyId,\r\n        groupList\r\n    };\r\n}\r\n\r\nexport function setScrollPositionAction(journeyId,offset)\r\n{\r\n    return {\r\n        type: IConstant.Actions.JOURNEY.ADDPOINT.SET_SCROLL_OFFSET,\r\n        scrollViewOffset: offset,\r\n        journeyId,\r\n    };\r\n}\r\n\r\nfunction _fetchList(journeyId,userId,itemType, pageIndex)\r\n{\r\n    let kvDict = {\r\n        key: itemType,\r\n        pageIndex: pageIndex,\r\n        pageSize: 10\r\n    };\r\n    return HttpClient.postToPortal(IConstant.PortalApis.JOURNEY.FillTour, kvDict, null, true)\r\n        .then((resp) => resp.json());\r\n}\r\n\r\nfunction _getListRequestAction(journeyId, pageIndex)\r\n{\r\n    return {\r\n        type: IConstant.Actions.JOURNEY.ADDPOINT.GET_LIST_REQUEST,\r\n        journeyId, \r\n        pageIndex,\r\n    };\r\n}\r\n\r\nfunction _getListSuccessAction(journeyId, pageIndex,result)\r\n{\r\n    return {\r\n        type: IConstant.Actions.JOURNEY.ADDPOINT.GET_LIST_SUCCESS,\r\n        journeyId, \r\n        pageIndex,\r\n        result\r\n    };\r\n}\r\n\r\nfunction _getListFailureAction(journeyId, pageIndex,error)\r\n{\r\n    return {\r\n        type: IConstant.Actions.JOURNEY.ADDPOINT.GET_LIST_FAILURE,\r\n        journeyId, \r\n        pageIndex,\r\n        message: error\r\n    };\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/store/actions/journey/addPointAction.js"],"sourceRoot":""}