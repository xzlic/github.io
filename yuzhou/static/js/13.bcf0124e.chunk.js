webpackJsonp([13],{886:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function o(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=n(11),p=(n.n(r),n(12)),s=n.n(p),c=n(18),d=(n.n(c),n(19)),l=n.n(d),m=n(0),h=n.n(m),u=n(2),w=n(10),f=n(14),v=n.n(f),M=n(70),y=n(1),b=n(54),g=n(931),A=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),O=function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="",n.address="",n.lat="",n.lng="",n.name=n.props.match.params.name,n.address=n.props.match.params.address,n.lat=n.props.match.params.lat,n.lng=n.props.match.params.lng,n.state={mapHeight:0},n}return o(t,e),A(t,[{key:"componentDidMount",value:function(){this.updateWindowDimensions(),this.updateNativeTitle(this.name)}},{key:"componentDidUpdate",value:function(e,t,n){this.props.baiduMapInited&&!e.baiduMapInited&&this.initMap()}},{key:"render",value:function(){var e=this;return h.a.createElement("div",{className:this.props.isFromNativeApp?"isFromNativeApp":null},this.props.isFromNativeApp?null:h.a.createElement(s.a,{mode:"dark",className:"navBar",icon:h.a.createElement(l.a,{type:"left"}),onLeftClick:function(){var t=e.props.match.params.code,n=e.props.dispatch;e.props.history.goBack(),n(Object(g.a)(t))}},this.name),h.a.createElement(w.a,{ref:function(t){e.scrollView=t?t.getWrappedInstance():e.scrollView}},h.a.createElement("div",{id:"elementMarkerMap",style:{height:this.state.mapHeight+"px"}})))}},{key:"initMap",value:function(){this.markerIcon=new window.BMap.Icon(n(284),new window.BMap.Size(30,30),{anchor:new window.BMap.Size(15,30),imageSize:new window.BMap.Size(30,30)}),this.map=this.map?this.map:new window.BMap.Map("elementMarkerMap"),this.map.centerAndZoom(new window.BMap.Point(b.a.instance.appCityLongitude,b.a.instance.appCityLatitude),16),this.map.addControl(new window.BMap.NavigationControl({type:window.BMAP_NAVIGATION_CONTROL_SMALL,anchor:window.BMAP_ANCHOR_BOTTOM_RIGHT,enableGeolocation:!0,offset:new window.BMap.Size(20,20)})),this.map.addControl(new window.BMap.GeolocationControl({enableAutoLocation:!1})),this.setMapCenter(),this.props.mapZoom&&(this.map.setZoom(this.props.mapZoom),this.map.setCenter(new window.BMap.Point(this.props.centerLng,this.props.centerLat)))}},{key:"setMapCenter",value:function(){var e=this;if(this.map&&this.lat&&this.lng){var t=new window.BMap.Point(this.lng,this.lat);this.map.setCenter(t),this.map.clearOverlays();var a=new window.BMap.Marker(t,{icon:this.markerIcon}),i=n(932),o='\n            <div style="display: flex; flex-direction: row;">\n                <div>\n                    <div style="font-size: 14px; text-align: center; min-width:40vw; max-width: 70vw;">'+this.name+'</div>\n                    <div style="font-size: 12px; text-align: center; min-width:40vw; max-width: 70vw; margin-top: 5px; white-space: normal;">'+this.address+'</div>\n                </div>\n                <div style="width: 25px; margin-left: 6px; display: -webkit-flex;display: flex;flex-flow: row;align-items: center;">\n                    <img style="width: 25px; height: 20px;" src="'+i+'">\n                </div>\n            </div>\n            ',r=new window.BMap.Label(o);r.setStyle({padding:"5px 10px",color:"white","background-color":"#3988d4",border:"0px","border-radius":"3px",transform:"translate(calc(-50% + 11px), calc(-100% - 2px))"}),a.setLabel(r),a.addEventListener("click",function(){e.markerTapped()}),r.addEventListener("click",function(){e.markerTapped()}),this.map.addOverlay(a)}}},{key:"markerTapped",value:function(){this.setMapZoomAndCenterLocation(),this.props.isFromNativeApp&&window.postMessage?this.sendMessageToNative(y.i.MAP_NAV,{code:this.props.match.params.code,toLat:this.lat,toLng:this.lng}):this.props.history.push("/map/mapNav/"+this.props.match.params.code+"/"+this.lat+"/"+this.lng)}},{key:"updateWindowDimensions",value:function(){var e=this,t=window.innerHeight-v.a.findDOMNode(this).parentNode.offsetTop;this.setState({mapHeight:t},function(){e.props.baiduMapInited&&e.initMap()})}},{key:"setMapZoomAndCenterLocation",value:function(){if(this.map){var e=this.map.getCenter(),t=this.map.getZoom(),n=e.lat,a=e.lng;this.props.dispatch(Object(g.b)(this.props.match.params.code,t,n,a))}}}]),t}(M.a),k=function(e,t){var n=e.map.elementMarker[t.match.params.code];return Object.assign({},n,{baiduMapInited:e.system.baiduMapInited,isFromNativeApp:e.native.isFromNativeApp})};O=Object(u.b)(k)(O),t.default=O},931:function(e,t,n){"use strict";function a(e){return{type:r.b.MAP.ELEMENTMARKER.GO_BACK,code:e}}function i(e,t,n,a){return function(i,r){return i(o(e,t,n,a)),new Promise(function(e){e()})}}function o(e,t,n,a){return{type:r.b.MAP.ELEMENTMARKER.MAPZOOM_AND_CENTERLOCATION_CHANGE,code:e,mapZoom:t,centerLat:n,centerLng:a}}t.a=a,t.b=i;var r=n(1)},932:function(e,t,n){e.exports=n.p+"static/media/icon_line.489cc7de.png"}});
//# sourceMappingURL=13.bcf0124e.chunk.js.map