{"version":3,"sources":["../static/js/10.21a710ce.chunk.js","screens/journey/JourneyMapLineScreen.js","store/actions/journey/mapLineAction.js","assets/images/journey/point-start@2x.png","assets/images/journey/point-bet@2x.png","assets/images/journey/map-point@2x.png"],"names":["webpackJsonp","894","module","__webpack_exports__","__webpack_require__","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","defineProperty","__WEBPACK_IMPORTED_MODULE_0_antd_mobile_lib_activity_indicator_style_css__","__WEBPACK_IMPORTED_MODULE_1_antd_mobile_lib_activity_indicator__","n","__WEBPACK_IMPORTED_MODULE_1_antd_mobile_lib_activity_indicator___default","__WEBPACK_IMPORTED_MODULE_2_antd_mobile_lib_nav_bar_style_css__","__WEBPACK_IMPORTED_MODULE_3_antd_mobile_lib_nav_bar__","__WEBPACK_IMPORTED_MODULE_3_antd_mobile_lib_nav_bar___default","__WEBPACK_IMPORTED_MODULE_4_antd_mobile_lib_icon_style_css__","__WEBPACK_IMPORTED_MODULE_5_antd_mobile_lib_icon__","__WEBPACK_IMPORTED_MODULE_5_antd_mobile_lib_icon___default","__WEBPACK_IMPORTED_MODULE_6_react__","__WEBPACK_IMPORTED_MODULE_6_react___default","__WEBPACK_IMPORTED_MODULE_7_react_redux__","__WEBPACK_IMPORTED_MODULE_8__views_common_Content__","__WEBPACK_IMPORTED_MODULE_9_react_dom__","__WEBPACK_IMPORTED_MODULE_9_react_dom___default","__WEBPACK_IMPORTED_MODULE_10__core_utils_Config__","__WEBPACK_IMPORTED_MODULE_11__store_actions_journey_mapLineAction__","__WEBPACK_IMPORTED_MODULE_12__assets_css_journey_css__","_createClass","defineProperties","target","props","i","length","descriptor","key","protoProps","staticProps","JourneyMapLineScreen","_PureComponent","this","_this","getPrototypeOf","markerIcon","undefined","selectIcon","darkIcon","markerList","code","history","location","state","groupList","daysClick","bind","journeyPointTapped","mapHeight","dispatch","updateWindowDimensions","prevProps","prevState","snapshot","baiduMapInited","baiduMapInitedDone","dayIndex","addMarkerAndLine","_this2","a","createElement","className","mode","icon","type","onLeftClick","goBack","renderTopScrollView","id","ref","view","mapView","style","height","bottomBox","renderBottomScrollView","isFetching","toast","text","_this3","topBox","onClick","map","dayItem","_this4","showList","item","index","src","GetImage","SmallImageFrontUrl","alt","getPointTypeName","Code","Name","PlayTime","parseInt","Price","bottomChildW","window","innerWidth","BMap","Icon","Size","anchor","imageSize","Map","centerAndZoom","Point","appCityLongitude","appCityLatitude","addControl","NavigationControl","BMAP_NAVIGATION_CONTROL_SMALL","BMAP_ANCHOR_TOP_RIGHT","enableGeolocation","offset","GeolocationControl","enableAutoLocation","BMAP_ANCHOR_TOP_LEFT","addEventListener","deSelectPoi","_this5","innerHeight","findDOMNode","parentNode","offsetTop","setState","mapZoom","setZoom","setCenter","centerLng","centerLat","scrollLeft","topScrollX","bottomScrollX","initMap","getBottomShowList","dayList","j","push","_this6","clearOverlays","showCount","pointList","point","Longitude","Latitude","markLabelString","lableColor","isHighMarker","fontSize","toString","iconSize","size","markStyle","width","markContent","marker","Marker","label","Label","setStyle","color","backgroundColor","border","setLabel","addOverlay","titleStr","address","Address","indexStr","opts","title","content","infoWindow","InfoWindow","refreshMarkerStatus","openInfoWindow","setIcon","getLabel","Number","viewport","getViewport","zoom","center","polyline","Polyline","strokeColor","strokeWeight","strokeOpacity","strokeStyle","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","err","return","console","log","typeCodeList","typeNameList","typeName","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","name","indexOf","setMapZoomAndCenterLocation","setTopBottomScrollX","centerPoint","getCenter","getZoom","lat","lng","mapStateToProps","ownProps","obj","journey","mapLineScreen","assign","system","969","goBackAction","journeyId","__WEBPACK_IMPORTED_MODULE_0__core_utils_IConstant__","JOURNEY","MAPLINE","GO_BACK","isFetchingChangeAction","IS_FETCHING_CHANGE","dayIndexChangeAction","DAYINDEX_CHANGE","mapZoomAndCenterLocationChangeAction","getState","_mapZoomAndCenterLocationChangeAction","Promise","resolve","MAPZOOM_AND_CENTERLOCATION_CHANGE","topBottomScrollXChangeAction","TOP_BOTTOM_SCROLLX_CHANGE","970","exports","p","971","972"],"mappings":"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","file":"static/js/10.21a710ce.chunk.js","sourcesContent":["webpackJsonp([10],{\n\n/***/ 894:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_antd_mobile_lib_activity_indicator_style_css__ = __webpack_require__(16);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_antd_mobile_lib_activity_indicator_style_css___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_antd_mobile_lib_activity_indicator_style_css__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_antd_mobile_lib_activity_indicator__ = __webpack_require__(17);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_antd_mobile_lib_activity_indicator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_antd_mobile_lib_activity_indicator__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_antd_mobile_lib_nav_bar_style_css__ = __webpack_require__(11);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_antd_mobile_lib_nav_bar_style_css___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_antd_mobile_lib_nav_bar_style_css__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_antd_mobile_lib_nav_bar__ = __webpack_require__(12);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_antd_mobile_lib_nav_bar___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_antd_mobile_lib_nav_bar__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_antd_mobile_lib_icon_style_css__ = __webpack_require__(18);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_antd_mobile_lib_icon_style_css___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_antd_mobile_lib_icon_style_css__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_antd_mobile_lib_icon__ = __webpack_require__(19);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_antd_mobile_lib_icon___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_antd_mobile_lib_icon__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_react__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_react___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_react__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_react_redux__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__views_common_Content__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_react_dom__ = __webpack_require__(14);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_react_dom___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_9_react_dom__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__core_utils_Config__ = __webpack_require__(54);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__store_actions_journey_mapLineAction__ = __webpack_require__(969);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__assets_css_journey_css__ = __webpack_require__(115);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__assets_css_journey_css___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_12__assets_css_journey_css__);\nvar _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if(\"value\"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError(\"Cannot call a class as a function\");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");}return call&&(typeof call===\"object\"||typeof call===\"function\")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!==\"function\"&&superClass!==null){throw new TypeError(\"Super expression must either be null or a function, not \"+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var JourneyMapLineScreen=function(_PureComponent){_inherits(JourneyMapLineScreen,_PureComponent);// mark 集合\nfunction JourneyMapLineScreen(props){_classCallCheck(this,JourneyMapLineScreen);var _this=_possibleConstructorReturn(this,(JourneyMapLineScreen.__proto__||Object.getPrototypeOf(JourneyMapLineScreen)).call(this,props));_this.markerIcon=undefined;_this.selectIcon=undefined;_this.darkIcon=undefined;_this.markerList=[];_this.code=_this.props.history.location.state.code;_this.groupList=_this.props.history.location.state.groupList;_this.daysClick=_this.daysClick.bind(_this);_this.journeyPointTapped=_this.journeyPointTapped.bind(_this);_this.state={mapHeight:0};return _this;}_createClass(JourneyMapLineScreen,[{key:'componentDidMount',value:function componentDidMount(){this.props.dispatch(Object(__WEBPACK_IMPORTED_MODULE_11__store_actions_journey_mapLineAction__[\"c\" /* isFetchingChangeAction */])(this.code,true));this.updateWindowDimensions();}},{key:'componentDidUpdate',value:function componentDidUpdate(prevProps,prevState,snapshot){if(this.props.baiduMapInited&&!prevProps.baiduMapInited){this.baiduMapInitedDone();}if(this.props.dayIndex!==prevProps.dayIndex){this.addMarkerAndLine(this.props.dayIndex);}}},{key:'render',value:function render(){var _this2=this;return __WEBPACK_IMPORTED_MODULE_6_react___default.a.createElement('div',{className:'journeyMapLine'},__WEBPACK_IMPORTED_MODULE_6_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_3_antd_mobile_lib_nav_bar___default.a,{mode:'dark',className:'navBar',icon:__WEBPACK_IMPORTED_MODULE_6_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_5_antd_mobile_lib_icon___default.a,{type:'left'}),onLeftClick:function onLeftClick(){var code=_this2.code;var dispatch=_this2.props.dispatch;_this2.props.history.goBack();dispatch(Object(__WEBPACK_IMPORTED_MODULE_11__store_actions_journey_mapLineAction__[\"b\" /* goBackAction */])(code));}},'\\u884C\\u7A0B\\u5730\\u56FE'),__WEBPACK_IMPORTED_MODULE_6_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_8__views_common_Content__[\"a\" /* default */],null,this.renderTopScrollView(),__WEBPACK_IMPORTED_MODULE_6_react___default.a.createElement('div',{id:'journeyMapLine',ref:function ref(view){_this2.mapView=view;},style:{height:this.state.mapHeight+'px'}}),__WEBPACK_IMPORTED_MODULE_6_react___default.a.createElement('div',{className:'bottomBox',ref:function ref(view){_this2.bottomBox=view;}},this.renderBottomScrollView()),this.props.isFetching?__WEBPACK_IMPORTED_MODULE_6_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_1_antd_mobile_lib_activity_indicator___default.a,{toast:true,text:'Loading...'}):null));}},{key:'renderTopScrollView',value:function renderTopScrollView(){var _this3=this;return __WEBPACK_IMPORTED_MODULE_6_react___default.a.createElement('div',{className:'topBar',ref:function ref(view){_this3.topBox=view;}},__WEBPACK_IMPORTED_MODULE_6_react___default.a.createElement('div',{className:'days-item'},this.props.dayIndex===0?__WEBPACK_IMPORTED_MODULE_6_react___default.a.createElement('p',{className:'days-select',onClick:function onClick(){return _this3.daysClick(0);}},'\\u5168\\u90E8'):__WEBPACK_IMPORTED_MODULE_6_react___default.a.createElement('p',{className:'days-noSelect',onClick:function onClick(){return _this3.daysClick(0);}},'\\u5168\\u90E8')),!this.groupList||this.groupList.length===0?null:this.groupList.map(function(dayItem,dayIndex){return __WEBPACK_IMPORTED_MODULE_6_react___default.a.createElement('div',{className:'days-item',key:dayIndex},_this3.props.dayIndex===dayIndex+1?__WEBPACK_IMPORTED_MODULE_6_react___default.a.createElement('p',{className:'days-select',onClick:function onClick(){return _this3.daysClick(dayIndex+1);}},'\\u7B2C',dayIndex+1,'\\u5929'):__WEBPACK_IMPORTED_MODULE_6_react___default.a.createElement('p',{className:'days-noSelect',onClick:function onClick(){return _this3.daysClick(dayIndex+1);}},'\\u7B2C',dayIndex+1,'\\u5929'));}));}},{key:'renderBottomScrollView',value:function renderBottomScrollView(){var _this4=this;if(!this.props.showList||this.props.showList.length===0){return null;}return this.props.showList.map(function(item,index){return __WEBPACK_IMPORTED_MODULE_6_react___default.a.createElement('div',{className:'routemap-bottom-item',key:index,onClick:function onClick(){return _this4.journeyPointTapped(item);}},__WEBPACK_IMPORTED_MODULE_6_react___default.a.createElement('div',{className:'routemap-bottom-left'},__WEBPACK_IMPORTED_MODULE_6_react___default.a.createElement('img',{src:item.GetImage.SmallImageFrontUrl,alt:''}),__WEBPACK_IMPORTED_MODULE_6_react___default.a.createElement('div',{className:'routemap_type'},_this4.getPointTypeName(item.Code))),__WEBPACK_IMPORTED_MODULE_6_react___default.a.createElement('div',{className:'routemap-bottom-detail'},__WEBPACK_IMPORTED_MODULE_6_react___default.a.createElement('p',null,item.Name),item.PlayTime&&parseInt(item.PlayTime,10)>0?__WEBPACK_IMPORTED_MODULE_6_react___default.a.createElement('p',null,'\\u6E38\\u73A9\\u65F6\\u95F4\\uFF1A',item.PlayTime,'\\u5C0F\\u65F6'):null,item.Price&&parseInt(item.Price,10)>0?__WEBPACK_IMPORTED_MODULE_6_react___default.a.createElement('span',null,__WEBPACK_IMPORTED_MODULE_6_react___default.a.createElement('p',null,'\\u4EF7\\u683C\\uFF1A'),__WEBPACK_IMPORTED_MODULE_6_react___default.a.createElement('p',null,'\\xA5',item.Price)):null));});}},{key:'initMap',value:function initMap(){if(this.map){return;}this.bottomChildW=window.innerWidth-50;// 地图标记图片\nthis.markerIcon=new window.BMap.Icon(__webpack_require__(970),new window.BMap.Size(30,30),{anchor:new window.BMap.Size(15,30),imageSize:new window.BMap.Size(30,30)});// 高亮选择 icon\nthis.selectIcon=new window.BMap.Icon(__webpack_require__(971),new window.BMap.Size(30,30),{anchor:new window.BMap.Size(15,30),imageSize:new window.BMap.Size(30,30)});// 灰色 非选择icon\nthis.darkIcon=new window.BMap.Icon(__webpack_require__(972),new window.BMap.Size(30,30),{anchor:new window.BMap.Size(15,30),imageSize:new window.BMap.Size(30,30)});this.map=this.map?this.map:new window.BMap.Map('journeyMapLine');this.map.centerAndZoom(new window.BMap.Point(__WEBPACK_IMPORTED_MODULE_10__core_utils_Config__[\"a\" /* default */].instance.appCityLongitude,__WEBPACK_IMPORTED_MODULE_10__core_utils_Config__[\"a\" /* default */].instance.appCityLatitude),16);this.map.addControl(new window.BMap.NavigationControl({type:window.BMAP_NAVIGATION_CONTROL_SMALL,anchor:window.BMAP_ANCHOR_TOP_RIGHT,enableGeolocation:true,offset:new window.BMap.Size(20,20)}));this.map.addControl(new window.BMap.GeolocationControl({enableAutoLocation:false,anchor:window.BMAP_ANCHOR_TOP_LEFT}));this.map.addEventListener('click',this.deSelectPoi);this.map.addEventListener('dragstart',this.deSelectPoi);}},{key:'updateWindowDimensions',value:function updateWindowDimensions(){var _this5=this;var height=window.innerHeight-__WEBPACK_IMPORTED_MODULE_9_react_dom___default.a.findDOMNode(this).parentNode.offsetTop-40;this.setState({mapHeight:height},function(){if(_this5.props.baiduMapInited){_this5.baiduMapInitedDone();if(_this5.props.showList&&_this5.props.mapZoom){_this5.addMarkerAndLine(_this5.props.dayIndex);_this5.map.setZoom(_this5.props.mapZoom);_this5.map.setCenter(new window.BMap.Point(_this5.props.centerLng,_this5.props.centerLat));__WEBPACK_IMPORTED_MODULE_9_react_dom___default.a.findDOMNode(_this5.topBox).scrollLeft=_this5.props.topScrollX;__WEBPACK_IMPORTED_MODULE_9_react_dom___default.a.findDOMNode(_this5.bottomBox).scrollLeft=_this5.props.bottomScrollX;}}});}},{key:'baiduMapInitedDone',value:function baiduMapInitedDone(){this.initMap();var dayIndex=this.props.dayIndex?this.props.dayIndex:0;this.daysClick(dayIndex);}},{key:'daysClick',value:function daysClick(dayIndex){if(!this.map||!this.groupList){return;}if(this.props.dayIndex&&this.props.dayIndex===dayIndex){return;}//移动 scroll 的位置\n__WEBPACK_IMPORTED_MODULE_9_react_dom___default.a.findDOMNode(this.bottomBox).scrollLeft=0;var showList=this.getBottomShowList(dayIndex);this.props.dispatch(Object(__WEBPACK_IMPORTED_MODULE_11__store_actions_journey_mapLineAction__[\"a\" /* dayIndexChangeAction */])(this.code,dayIndex,showList));}// 获取 底部滑动 展示的数据\n},{key:'getBottomShowList',value:function getBottomShowList(dayIndex){if(dayIndex>0&&this.groupList.length>=dayIndex){return this.groupList[dayIndex-1];}var showList=[];for(var i=0;i<this.groupList.length;i++){var dayList=this.groupList[i];for(var j=0;j<dayList.length;j++){showList.push(dayList[j]);}}return showList;}// 放置 大头针 和线\n},{key:'addMarkerAndLine',value:function addMarkerAndLine(dayIndex){var _this6=this;this.props.dispatch(Object(__WEBPACK_IMPORTED_MODULE_11__store_actions_journey_mapLineAction__[\"c\" /* isFetchingChangeAction */])(this.code,false));if(!this.map||!this.groupList){return;}this.map.clearOverlays();var showCount=0;var pointList=[];//连线 数据\nthis.markerList=[];// 高亮 mark\nfor(var i=0;i<this.groupList.length;i++){var dayList=this.groupList[i];var _loop=function _loop(j){var item=dayList[j];var point=new window.BMap.Point(item.Longitude,item.Latitude);var markLabelString='D'+(i+1);var icon=_this6.darkIcon;var lableColor='#404666';var isHighMarker=dayIndex===0||dayIndex!==0&&i===dayIndex-1;var fontSize='10px';var offset=new window.BMap.Size(4,1);//(8,5);\nif(isHighMarker){showCount+=1;markLabelString=showCount.toString();icon=_this6.markerIcon;lableColor='#00e6ae';fontSize='13px';offset=new window.BMap.Size(3,1);pointList.push(point);}var iconSize=icon.size;var markStyle='width:'+(iconSize.width/2+5)+'px;height:'+(iconSize.height/2+5)+'px; line-height: '+(iconSize.height/2+5)+'px;';var markContent='<div style=\\'text-align: center;'+markStyle+'\\'>'+markLabelString+'</div>';var marker=new window.BMap.Marker(point,{icon:icon});var label=new window.BMap.Label(markContent,{offset:offset});label.setStyle({color:lableColor,fontSize:fontSize,backgroundColor:'clear',border:'0'});marker.setLabel(label);_this6.map.addOverlay(marker);var titleStr=item.Name;var address=item.Address;var indexStr=(showCount-1).toString();marker.addEventListener('click',function(){//信息窗\nvar opts={width:100,// 信息窗口宽度\nheight:80,// 信息窗口高度\ntitle:'',// 信息窗口标题\noffset:new window.BMap.Size(0,-30)};var content='<span style=\\'font-size:14px;color:#444\\'>'+titleStr+'</span>';content=content+'<br><span style=\\'font-size:13px;color:#888\\'>地址:'+address+'</span>';var infoWindow=new window.BMap.InfoWindow(content,opts);infoWindow.addEventListener('close',function(){this.refreshMarkerStatus();}.bind(this));this.map.openInfoWindow(infoWindow,point);//开启信息窗口\nif(isHighMarker){this.refreshMarkerStatus();marker.setIcon(this.selectIcon);var selectLabel=marker.getLabel();selectLabel.setStyle({color:'#ffffff',fontSize:'13px',backgroundColor:'clear',border:'0'});//移动 scroll 的位置\n__WEBPACK_IMPORTED_MODULE_9_react_dom___default.a.findDOMNode(this.bottomBox).scrollLeft=10+this.bottomChildW*Number(indexStr);}}.bind(_this6));if(isHighMarker){_this6.markerList.push(marker);}_this6.map.centerAndZoom(point,15);};for(var j=0;j<dayList.length;j++){_loop(j);}}if(pointList.length>0){// 设置缩放级别、中心点，并将所有的标记点显示出来\nvar viewport=this.map.getViewport(pointList);viewport.zoom=viewport.zoom>15?pointList.length<=2?15:viewport.zoom:viewport.zoom;// console.log(viewport.zoom);\nthis.map.centerAndZoom(viewport.center,viewport.zoom);// 连线\nvar polyline=new window.BMap.Polyline(pointList,{strokeColor:'#00e6ae',strokeWeight:1,strokeOpacity:1,strokeStyle:'dashed'});this.map.addOverlay(polyline);}}},{key:'refreshMarkerStatus',value:function refreshMarkerStatus(){var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=this.markerList[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var _marker=_step.value;_marker.setIcon(this.markerIcon);var label=_marker.getLabel();label.setStyle({color:'#00e6ae',fontSize:'13px',backgroundColor:'clear',border:'0'});}}catch(err){_didIteratorError=true;_iteratorError=err;}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return();}}finally{if(_didIteratorError){throw _iteratorError;}}}}},{key:'getPointTypeName',value:function getPointTypeName(code){if(code.length===0){console.log('detail code null!!!');return'';}var typeCodeList=['JQ','JD','CT','CP','YL','SQ','SD','WD','SP'];var typeNameList=['景区','酒店','餐馆','美食','娱乐','商圈','商场','商铺','商品'];//景区，酒店，餐馆，美食,娱乐，购物（商圈），购物（商场），c2c商铺,c2c商品\nvar typeName='';var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=typeCodeList[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var name=_step2.value;if(code.indexOf(name)>=0){typeName=typeNameList[typeCodeList.indexOf(name)];break;}}}catch(err){_didIteratorError2=true;_iteratorError2=err;}finally{try{if(!_iteratorNormalCompletion2&&_iterator2.return){_iterator2.return();}}finally{if(_didIteratorError2){throw _iteratorError2;}}}return typeName;}// 兴趣点点击\n},{key:'journeyPointTapped',value:function journeyPointTapped(item){if(!item){return;}this.setMapZoomAndCenterLocation();this.setTopBottomScrollX();var code=item.Code;if(code.indexOf('JQ')>=0){this.props.history.push('/scenic/detail/'+code);}else if(code.indexOf('JD')>=0){this.props.history.push('/hotel/detail/'+code);}else if(code.indexOf('CT')>=0){this.props.history.push('/restaurant/detail/'+code);}else if(code.indexOf('SD')>=0||code.indexOf('SQ')>=0){this.props.history.push('/shopping/detail/'+code);}else if(code.indexOf('YL')>=0){this.props.history.push('/fun/detail/'+code);}}// 保存 地图中心点 和 缩放级\n},{key:'setMapZoomAndCenterLocation',value:function setMapZoomAndCenterLocation(){if(!this.map){return;}var centerPoint=this.map.getCenter();var mapZoom=this.map.getZoom();var centerLat=centerPoint.lat;var centerLng=centerPoint.lng;this.props.dispatch(Object(__WEBPACK_IMPORTED_MODULE_11__store_actions_journey_mapLineAction__[\"d\" /* mapZoomAndCenterLocationChangeAction */])(this.code,mapZoom,centerLat,centerLng));}// 保存 top 和 bottom x滑动位置\n},{key:'setTopBottomScrollX',value:function setTopBottomScrollX(){var topScrollX=__WEBPACK_IMPORTED_MODULE_9_react_dom___default.a.findDOMNode(this.topBox).scrollLeft;var bottomScrollX=__WEBPACK_IMPORTED_MODULE_9_react_dom___default.a.findDOMNode(this.bottomBox).scrollLeft;this.props.dispatch(Object(__WEBPACK_IMPORTED_MODULE_11__store_actions_journey_mapLineAction__[\"e\" /* topBottomScrollXChangeAction */])(this.code,topScrollX,bottomScrollX));}}]);return JourneyMapLineScreen;}(__WEBPACK_IMPORTED_MODULE_6_react__[\"PureComponent\"]);var mapStateToProps=function mapStateToProps(state,ownProps){var obj=state.journey.mapLineScreen[ownProps.history.location.state.code];return Object.assign({},obj,{baiduMapInited:state.system.baiduMapInited});};JourneyMapLineScreen=Object(__WEBPACK_IMPORTED_MODULE_7_react_redux__[\"b\" /* connect */])(mapStateToProps)(JourneyMapLineScreen);/* harmony default export */ __webpack_exports__[\"default\"] = (JourneyMapLineScreen);\n\n/***/ }),\n\n/***/ 969:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"b\"] = goBackAction;\n/* harmony export (immutable) */ __webpack_exports__[\"c\"] = isFetchingChangeAction;\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = dayIndexChangeAction;\n/* harmony export (immutable) */ __webpack_exports__[\"d\"] = mapZoomAndCenterLocationChangeAction;\n/* harmony export (immutable) */ __webpack_exports__[\"e\"] = topBottomScrollXChangeAction;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__core_utils_IConstant__ = __webpack_require__(1);\nfunction goBackAction(journeyId){return{type:__WEBPACK_IMPORTED_MODULE_0__core_utils_IConstant__[\"b\" /* Actions */].JOURNEY.MAPLINE.GO_BACK,journeyId:journeyId};}function isFetchingChangeAction(journeyId,isFetching){return{type:__WEBPACK_IMPORTED_MODULE_0__core_utils_IConstant__[\"b\" /* Actions */].JOURNEY.MAPLINE.IS_FETCHING_CHANGE,journeyId:journeyId,isFetching:isFetching};}function dayIndexChangeAction(journeyId,dayIndex,showList){return{type:__WEBPACK_IMPORTED_MODULE_0__core_utils_IConstant__[\"b\" /* Actions */].JOURNEY.MAPLINE.DAYINDEX_CHANGE,journeyId:journeyId,dayIndex:dayIndex,showList:showList};}function mapZoomAndCenterLocationChangeAction(journeyId,mapZoom,centerLat,centerLng){return function(dispatch,getState){dispatch(_mapZoomAndCenterLocationChangeAction(journeyId,mapZoom,centerLat,centerLng));return new Promise(function(resolve){resolve();});};}function _mapZoomAndCenterLocationChangeAction(journeyId,mapZoom,centerLat,centerLng){return{type:__WEBPACK_IMPORTED_MODULE_0__core_utils_IConstant__[\"b\" /* Actions */].JOURNEY.MAPLINE.MAPZOOM_AND_CENTERLOCATION_CHANGE,journeyId:journeyId,mapZoom:mapZoom,centerLat:centerLat,centerLng:centerLng};}function topBottomScrollXChangeAction(journeyId,topScrollX,bottomScrollX){return{type:__WEBPACK_IMPORTED_MODULE_0__core_utils_IConstant__[\"b\" /* Actions */].JOURNEY.MAPLINE.TOP_BOTTOM_SCROLLX_CHANGE,journeyId:journeyId,topScrollX:topScrollX,bottomScrollX:bottomScrollX};}\n\n/***/ }),\n\n/***/ 970:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__.p + \"static/media/point-start@2x.90e9061b.png\";\n\n/***/ }),\n\n/***/ 971:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__.p + \"static/media/point-bet@2x.d5a8cd2e.png\";\n\n/***/ }),\n\n/***/ 972:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__.p + \"static/media/map-point@2x.dc2b3a9d.png\";\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/js/10.21a710ce.chunk.js","import React, { PureComponent } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { NavBar, Icon , ActivityIndicator } from 'antd-mobile';\r\nimport Content from '../../views/common/Content';\r\nimport ReactDOM from 'react-dom';\r\nimport Config from '../../core/utils/Config';\r\nimport { goBackAction, isFetchingChangeAction, dayIndexChangeAction, mapZoomAndCenterLocationChangeAction, topBottomScrollXChangeAction } from '../../store/actions/journey/mapLineAction';\r\nimport '../../assets/css/journey.css';\r\n\r\nclass JourneyMapLineScreen extends PureComponent {\r\n    code;\r\n    groupList;\r\n    markerIcon = undefined;\r\n    selectIcon = undefined;\r\n    darkIcon = undefined;\r\n    markerList = []; // mark 集合\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.code = this.props.history.location.state.code;\r\n        this.groupList = this.props.history.location.state.groupList;\r\n\r\n        this.daysClick = this.daysClick.bind(this);\r\n        this.journeyPointTapped = this.journeyPointTapped.bind(this);\r\n\r\n        this.state = {\r\n            mapHeight: 0,\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.props.dispatch(isFetchingChangeAction(this.code,true));\r\n        this.updateWindowDimensions();\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState, snapshot)\r\n    {\r\n        if (this.props.baiduMapInited && !prevProps.baiduMapInited)\r\n        {\r\n            this.baiduMapInitedDone();\r\n        }\r\n\r\n        if ( this.props.dayIndex !== prevProps.dayIndex )\r\n        {\r\n            this.addMarkerAndLine(this.props.dayIndex);\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"journeyMapLine\">\r\n                <NavBar mode=\"dark\"\r\n                    className=\"navBar\"\r\n                    icon={<Icon type=\"left\" />}\r\n                    onLeftClick={() => {\r\n                        let code = this.code;\r\n                        let dispatch = this.props.dispatch;\r\n                        this.props.history.goBack();\r\n                        dispatch(goBackAction(code));\r\n                    }}>\r\n                    行程地图\r\n                </NavBar>\r\n                <Content>\r\n                    {\r\n                        this.renderTopScrollView()\r\n                    }\r\n                    <div id=\"journeyMapLine\" ref={(view) => { this.mapView = view; }} style={{ height: (this.state.mapHeight + 'px') }}></div>\r\n                    <div className=\"bottomBox\" ref={(view) => { this.bottomBox = view; }}>\r\n                        {\r\n                            this.renderBottomScrollView()\r\n                        }\r\n                    </div>\r\n                    {\r\n                        this.props.isFetching\r\n                            ?\r\n                            <ActivityIndicator\r\n                                toast\r\n                                text=\"Loading...\" />\r\n                            : null\r\n                    }\r\n                </Content>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    renderTopScrollView() {\r\n        return (\r\n            <div className=\"topBar\" ref={(view) => { this.topBox = view; }}>\r\n                <div className=\"days-item\">\r\n                    {\r\n                        this.props.dayIndex === 0 ?\r\n                            <p className=\"days-select\" onClick={() => this.daysClick(0)}>全部</p>\r\n                            :\r\n                            <p className=\"days-noSelect\" onClick={() => this.daysClick(0)}>全部</p>\r\n                    }\r\n                </div>\r\n                {\r\n                    !this.groupList || this.groupList.length === 0 ?\r\n                        null\r\n                        :\r\n                        this.groupList.map((dayItem, dayIndex) =>\r\n                            <div className=\"days-item\" key={dayIndex}>\r\n                                {\r\n                                    this.props.dayIndex === (dayIndex + 1)\r\n                                        ?\r\n                                        <p className=\"days-select\" onClick={() => this.daysClick(dayIndex + 1)}>第{dayIndex + 1}天</p>\r\n                                        :\r\n                                        <p className=\"days-noSelect\" onClick={() => this.daysClick(dayIndex + 1)}>第{dayIndex + 1}天</p>\r\n                                }\r\n                            </div>)\r\n                }\r\n            </div>\r\n        );\r\n    }\r\n\r\n    renderBottomScrollView() {\r\n        if (!this.props.showList || this.props.showList.length === 0) {\r\n            return null;\r\n        }\r\n        return (\r\n            this.props.showList.map((item, index) =>\r\n                <div className=\"routemap-bottom-item\" key={index} onClick={() => this.journeyPointTapped(item)}>\r\n                    <div className=\"routemap-bottom-left\">\r\n                        <img src={item.GetImage.SmallImageFrontUrl} alt='' />\r\n                        <div className=\"routemap_type\">{this.getPointTypeName(item.Code)}</div>\r\n                    </div>\r\n                    <div className=\"routemap-bottom-detail\">\r\n                        <p>{item.Name}</p>\r\n                        {\r\n                            item.PlayTime && parseInt(item.PlayTime,10) > 0\r\n                                ?\r\n                                <p>游玩时间：{item.PlayTime}小时</p>\r\n                                :\r\n                                null\r\n                        }\r\n                        {\r\n                            item.Price && parseInt(item.Price,10) > 0\r\n                                ?\r\n                                <span>\r\n                                    <p>价格：</p>\r\n                                    <p>¥{item.Price}</p>\r\n                                </span>\r\n                                :\r\n                                null\r\n                        }\r\n                    </div>\r\n                </div>\r\n            )\r\n        );\r\n    }\r\n\r\n    initMap() {\r\n        if (this.map) {\r\n            return;\r\n        }\r\n\r\n        this.bottomChildW = (window.innerWidth - 50);\r\n        // 地图标记图片\r\n        this.markerIcon = new window.BMap.Icon(require('../../assets/images/journey/point-start@2x.png'), new window.BMap.Size(30, 30), {\r\n            anchor: new window.BMap.Size(15, 30),\r\n            imageSize: new window.BMap.Size(30, 30)\r\n        });\r\n\r\n        // 高亮选择 icon\r\n        this.selectIcon = new window.BMap.Icon(require('../../assets/images/journey/point-bet@2x.png'), new window.BMap.Size(30, 30), {\r\n            anchor: new window.BMap.Size(15, 30),\r\n            imageSize: new window.BMap.Size(30, 30)\r\n        });\r\n\r\n        // 灰色 非选择icon\r\n        this.darkIcon = new window.BMap.Icon(require('../../assets/images/journey/map-point@2x.png'), new window.BMap.Size(30, 30), {\r\n            anchor: new window.BMap.Size(15, 30),\r\n            imageSize: new window.BMap.Size(30, 30)\r\n        });\r\n\r\n        this.map = this.map ? this.map : new window.BMap.Map('journeyMapLine');\r\n        this.map.centerAndZoom(new window.BMap.Point(Config.instance.appCityLongitude, Config.instance.appCityLatitude), 16);\r\n        this.map.addControl(new window.BMap.NavigationControl({ type: window.BMAP_NAVIGATION_CONTROL_SMALL, anchor: window.BMAP_ANCHOR_TOP_RIGHT, enableGeolocation: true, offset: new window.BMap.Size(20, 20) }));\r\n        this.map.addControl(new window.BMap.GeolocationControl({ enableAutoLocation: false, anchor: window.BMAP_ANCHOR_TOP_LEFT }));\r\n\r\n        this.map.addEventListener('click', this.deSelectPoi);\r\n        this.map.addEventListener('dragstart', this.deSelectPoi);\r\n    }\r\n\r\n    updateWindowDimensions() {\r\n        const height = window.innerHeight - ReactDOM.findDOMNode(this).parentNode.offsetTop - 40;\r\n        this.setState({ mapHeight: height }, () => {\r\n            if (this.props.baiduMapInited) {\r\n                this.baiduMapInitedDone();\r\n\r\n                if (this.props.showList && this.props.mapZoom)\r\n                {\r\n                    this.addMarkerAndLine(this.props.dayIndex);\r\n                    this.map.setZoom(this.props.mapZoom);\r\n                    this.map.setCenter(new window.BMap.Point(this.props.centerLng, this.props.centerLat));\r\n                    ReactDOM.findDOMNode(this.topBox).scrollLeft = this.props.topScrollX;\r\n                    ReactDOM.findDOMNode(this.bottomBox).scrollLeft = this.props.bottomScrollX;\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    baiduMapInitedDone() {\r\n        this.initMap();\r\n        let dayIndex = this.props.dayIndex ? this.props.dayIndex : 0;\r\n        this.daysClick(dayIndex);\r\n    }\r\n\r\n    daysClick(dayIndex) {\r\n        if (!this.map || !this.groupList) {\r\n            return;\r\n        }\r\n        if (this.props.dayIndex && this.props.dayIndex === dayIndex) {\r\n            return;\r\n        }\r\n        //移动 scroll 的位置\r\n        ReactDOM.findDOMNode(this.bottomBox).scrollLeft = 0;\r\n        let showList = this.getBottomShowList(dayIndex);\r\n        this.props.dispatch(dayIndexChangeAction(this.code, dayIndex, showList));\r\n    }\r\n\r\n    // 获取 底部滑动 展示的数据\r\n    getBottomShowList(dayIndex) {\r\n        if (dayIndex > 0 && this.groupList.length >= dayIndex) {\r\n            return this.groupList[dayIndex - 1];\r\n        }\r\n        let showList = [];\r\n        for (let i = 0; i < this.groupList.length; i++) {\r\n            let dayList = this.groupList[i];\r\n            for (let j = 0; j < dayList.length; j++) {\r\n                showList.push(dayList[j]);\r\n            }\r\n        }\r\n        return showList;\r\n    }\r\n\r\n    // 放置 大头针 和线\r\n    addMarkerAndLine(dayIndex) {\r\n        this.props.dispatch(isFetchingChangeAction(this.code,false));\r\n        if (!this.map || !this.groupList) {\r\n            return;\r\n        }\r\n        this.map.clearOverlays();\r\n\r\n        let showCount = 0;\r\n        let pointList = [];//连线 数据\r\n        this.markerList = [];// 高亮 mark\r\n        for (let i = 0; i < this.groupList.length; i++) {\r\n            let dayList = this.groupList[i];\r\n            for (let j = 0; j < dayList.length; j++) {\r\n                let item = dayList[j];\r\n                let point = new window.BMap.Point(item.Longitude, item.Latitude);\r\n                let markLabelString = ('D' + (i + 1));\r\n                let icon = this.darkIcon;\r\n                let lableColor = '#404666';\r\n                let isHighMarker = (dayIndex === 0 || (dayIndex !== 0 && i === (dayIndex - 1)));\r\n                let fontSize = '10px';\r\n                let offset = new window.BMap.Size(4, 1);//(8,5);\r\n\r\n                if (isHighMarker) {\r\n                    showCount += 1;\r\n                    markLabelString = showCount.toString();\r\n                    icon = this.markerIcon;\r\n                    lableColor = '#00e6ae';\r\n                    fontSize = '13px';\r\n                    offset = new window.BMap.Size(3, 1);\r\n                    pointList.push(point);\r\n                }\r\n                let iconSize = icon.size;\r\n                let markStyle = 'width:' + (iconSize.width / 2 + 5) + 'px;height:' + (iconSize.height / 2 + 5) + 'px; line-height: ' + (iconSize.height / 2 + 5) + 'px;';\r\n                let markContent = '<div style=\\'text-align: center;' + markStyle + '\\'>' + markLabelString + '</div>';\r\n                let marker = new window.BMap.Marker(point, { icon: icon });\r\n                let label = new window.BMap.Label(markContent, { offset: offset });\r\n                label.setStyle({ color: lableColor, fontSize: fontSize, backgroundColor: 'clear', border: '0' });\r\n                marker.setLabel(label);\r\n                this.map.addOverlay(marker);\r\n\r\n                let titleStr = item.Name;\r\n                let address = item.Address;\r\n                let indexStr = (showCount - 1).toString();\r\n\r\n                marker.addEventListener('click', function () {\r\n                    //信息窗\r\n                    var opts = {\r\n                        width: 100,     // 信息窗口宽度\r\n                        height: 80,     // 信息窗口高度\r\n                        title: '', // 信息窗口标题\r\n                        offset: new window.BMap.Size(0, -30)\r\n                    };\r\n                    let content = '<span style=\\'font-size:14px;color:#444\\'>' + titleStr + '</span>';\r\n                    content = content + '<br><span style=\\'font-size:13px;color:#888\\'>地址:' + address + '</span>';\r\n                    var infoWindow = new window.BMap.InfoWindow(content, opts);\r\n                    infoWindow.addEventListener('close', function () {\r\n                        this.refreshMarkerStatus();\r\n                    }.bind(this));\r\n\r\n                    this.map.openInfoWindow(infoWindow, point); //开启信息窗口\r\n                    if (isHighMarker) {\r\n                        this.refreshMarkerStatus();\r\n                        marker.setIcon(this.selectIcon);\r\n                        let selectLabel = marker.getLabel();\r\n                        selectLabel.setStyle({ color: '#ffffff', fontSize: '13px', backgroundColor: 'clear', border: '0' });\r\n\r\n                        //移动 scroll 的位置\r\n                        ReactDOM.findDOMNode(this.bottomBox).scrollLeft = (10 + this.bottomChildW * Number(indexStr));\r\n                    }\r\n\r\n                }.bind(this));\r\n\r\n                if (isHighMarker) {\r\n                    this.markerList.push(marker);\r\n                }\r\n\r\n                this.map.centerAndZoom(point, 15);\r\n            }\r\n        }\r\n\r\n        if (pointList.length > 0) {\r\n            // 设置缩放级别、中心点，并将所有的标记点显示出来\r\n            let viewport = this.map.getViewport(pointList);\r\n            viewport.zoom = viewport.zoom > 15 ? (pointList.length <= 2 ? 15 : viewport.zoom) : viewport.zoom;\r\n            // console.log(viewport.zoom);\r\n            this.map.centerAndZoom(viewport.center, viewport.zoom);\r\n\r\n            // 连线\r\n            let polyline = new window.BMap.Polyline(pointList,\r\n                { strokeColor: '#00e6ae', strokeWeight: 1, strokeOpacity: 1, strokeStyle: 'dashed' }\r\n            );\r\n            this.map.addOverlay(polyline);\r\n        }\r\n    }\r\n\r\n    refreshMarkerStatus() {\r\n        for (let marker of this.markerList) {\r\n            marker.setIcon(this.markerIcon);\r\n            let label = marker.getLabel();\r\n            label.setStyle({ color: '#00e6ae', fontSize: '13px', backgroundColor: 'clear', border: '0' });\r\n        }\r\n    }\r\n\r\n    getPointTypeName(code) {\r\n        if (code.length === 0) {\r\n            console.log('detail code null!!!');\r\n            return '';\r\n        }\r\n\r\n        let typeCodeList = ['JQ', 'JD', 'CT', 'CP', 'YL', 'SQ', 'SD', 'WD', 'SP'];\r\n        let typeNameList = ['景区', '酒店', '餐馆', '美食', '娱乐', '商圈', '商场', '商铺', '商品'];\r\n        //景区，酒店，餐馆，美食,娱乐，购物（商圈），购物（商场），c2c商铺,c2c商品\r\n\r\n        let typeName = '';\r\n        for (let name of typeCodeList) {\r\n            if (code.indexOf(name) >= 0) {\r\n                typeName = typeNameList[typeCodeList.indexOf(name)];\r\n                break;\r\n            }\r\n        }\r\n\r\n        return typeName;\r\n    }\r\n\r\n    // 兴趣点点击\r\n    journeyPointTapped(item) {\r\n        if (!item) {\r\n            return;\r\n        }\r\n\r\n        this.setMapZoomAndCenterLocation();\r\n        this.setTopBottomScrollX();\r\n        let code = item.Code;\r\n        if (code.indexOf('JQ') >= 0) {\r\n            this.props.history.push(`/scenic/detail/${code}`);\r\n        }\r\n        else if(code.indexOf('JD') >= 0)\r\n        {\r\n            this.props.history.push(`/hotel/detail/${code}`);\r\n        }\r\n        else if(code.indexOf('CT') >= 0)\r\n        {\r\n            this.props.history.push(`/restaurant/detail/${code}`);\r\n        }\r\n        else if(code.indexOf('SD') >= 0 || code.indexOf('SQ') >= 0)\r\n        {\r\n            this.props.history.push(`/shopping/detail/${code}`);\r\n        }\r\n        else if(code.indexOf('YL') >= 0)\r\n        {\r\n            this.props.history.push(`/fun/detail/${code}`);\r\n        }\r\n        \r\n    }\r\n\r\n    // 保存 地图中心点 和 缩放级\r\n    setMapZoomAndCenterLocation()\r\n    {\r\n        if (!this.map)\r\n        {\r\n            return;\r\n        }\r\n        let centerPoint = this.map.getCenter();\r\n        let mapZoom = this.map.getZoom();\r\n        let centerLat = centerPoint.lat;\r\n        let centerLng = centerPoint.lng;\r\n        this.props.dispatch(mapZoomAndCenterLocationChangeAction(this.code,mapZoom,centerLat,centerLng));\r\n    }\r\n\r\n    // 保存 top 和 bottom x滑动位置\r\n    setTopBottomScrollX()\r\n    {\r\n        let topScrollX = ReactDOM.findDOMNode(this.topBox).scrollLeft;\r\n        let bottomScrollX = ReactDOM.findDOMNode(this.bottomBox).scrollLeft;\r\n        this.props.dispatch(topBottomScrollXChangeAction(this.code,topScrollX,bottomScrollX));\r\n    }\r\n}\r\n\r\nconst mapStateToProps = function (state, ownProps) {\r\n    let obj = state.journey.mapLineScreen[ownProps.history.location.state.code];\r\n    return {\r\n        ...obj,\r\n        baiduMapInited: state.system.baiduMapInited,\r\n    };\r\n};\r\n\r\nJourneyMapLineScreen = connect(mapStateToProps)(JourneyMapLineScreen);\r\n\r\nexport default JourneyMapLineScreen;\n\n\n// WEBPACK FOOTER //\n// ./src/screens/journey/JourneyMapLineScreen.js","import * as IConstant from '../../../core/utils/IConstant';\r\n\r\nexport function goBackAction(journeyId)\r\n{\r\n    return {\r\n        type: IConstant.Actions.JOURNEY.MAPLINE.GO_BACK,\r\n        journeyId,\r\n    };\r\n}\r\n\r\nexport function isFetchingChangeAction(journeyId,isFetching)\r\n{\r\n    return {\r\n        type: IConstant.Actions.JOURNEY.MAPLINE.IS_FETCHING_CHANGE,\r\n        journeyId,\r\n        isFetching:isFetching\r\n    };\r\n}\r\n\r\nexport function dayIndexChangeAction(journeyId,dayIndex,showList)\r\n{\r\n    return {\r\n        type: IConstant.Actions.JOURNEY.MAPLINE.DAYINDEX_CHANGE,\r\n        journeyId,\r\n        dayIndex:dayIndex,\r\n        showList: showList\r\n    };\r\n}\r\n\r\nexport function mapZoomAndCenterLocationChangeAction(journeyId,mapZoom,centerLat,centerLng)\r\n{\r\n    return function(dispatch, getState)\r\n    {\r\n        dispatch(_mapZoomAndCenterLocationChangeAction(journeyId,mapZoom,centerLat,centerLng));\r\n        return new Promise((resolve)=>{\r\n            resolve();\r\n        });\r\n    };\r\n    \r\n}\r\n\r\nfunction _mapZoomAndCenterLocationChangeAction(journeyId,mapZoom,centerLat,centerLng)\r\n{\r\n    return {\r\n        type: IConstant.Actions.JOURNEY.MAPLINE.MAPZOOM_AND_CENTERLOCATION_CHANGE,\r\n        journeyId,\r\n        mapZoom:mapZoom,\r\n        centerLat: centerLat,\r\n        centerLng: centerLng\r\n    };\r\n}\r\n\r\nexport function topBottomScrollXChangeAction(journeyId,topScrollX,bottomScrollX)\r\n{\r\n    return {\r\n        type: IConstant.Actions.JOURNEY.MAPLINE.TOP_BOTTOM_SCROLLX_CHANGE,\r\n        journeyId,\r\n        topScrollX:topScrollX,\r\n        bottomScrollX: bottomScrollX\r\n    };\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/store/actions/journey/mapLineAction.js","module.exports = __webpack_public_path__ + \"static/media/point-start@2x.90e9061b.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/images/journey/point-start@2x.png\n// module id = 970\n// module chunks = 10","module.exports = __webpack_public_path__ + \"static/media/point-bet@2x.d5a8cd2e.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/images/journey/point-bet@2x.png\n// module id = 971\n// module chunks = 10","module.exports = __webpack_public_path__ + \"static/media/map-point@2x.dc2b3a9d.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/images/journey/map-point@2x.png\n// module id = 972\n// module chunks = 10"],"sourceRoot":""}