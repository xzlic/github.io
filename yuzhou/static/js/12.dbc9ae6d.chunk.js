webpackJsonp([12],{882:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function o(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(42),a=(n.n(s),n(43)),c=n.n(a),l=n(11),u=(n.n(l),n(12)),f=n.n(u),p=n(0),h=n.n(p),m=n(2),y=n(10),d=n(14),E=n.n(d),S=n(900),I=n(897),w=n(41),C=n(23),L=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),g=function(e){function t(e){r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.showSceneryDetail=n.showSceneryDetail.bind(n),n.showImageBrowser=n.showImageBrowser.bind(n),n.state={showImageBrowser:!1,imageList:[]},n}return o(t,e),L(t,[{key:"componentDidUpdate",value:function(e,t,n){e.match.params.sceneryCode!==this.props.match.params.sceneryCode&&this.restoreScrollViewPosition(this.props)}},{key:"componentDidMount",value:function(){this.restoreScrollViewPosition(this.props)}},{key:"render",value:function(){var e=this;return h.a.createElement("div",null,h.a.createElement(f.a,{mode:"dark",className:"navBar",leftContent:h.a.createElement(C.a,{ref:function(t){e.LeftContentView=t?t.getWrappedInstance():e.scrollView},goBackAction:function(){},history:this.props.history}),onLeftClick:function(){e.LeftContentView.goHome()}},"\u666f\u70b9\u8be6\u60c5"),h.a.createElement(y.a,{ref:function(t){e.scrollView=t?t.getWrappedInstance():e.scrollView}},this.renderHeaderView(),this.renderBasicView(),h.a.createElement("div",{className:"homeSplitSpace"}),this.renderOtherSceneryListView(),h.a.createElement(w.a,{ref:function(t){e.photoBrowserView=t?t.getWrappedInstance():e.scrollView}})))}},{key:"renderHeaderView",value:function(){if(!this.isValidData())return null;var e=this.getSelectedSceneryIndex(),t=this.props.sceneryList[e];return t.GetImage&&t.GetImage.ImageList&&0!==t.GetImage.ImageList.length?h.a.createElement("div",{className:"scenicDetailHeader",onClick:this.showImageBrowser},h.a.createElement(c.a,{className:"scenicDetailHeaderImgSlider",autoplay:!0,dots:!1,swiping:!0,infinite:!0,selectedIndex:0,swipeSpeed:35},t.GetImage.ImageList.map(function(e,t){return h.a.createElement("div",{key:t,className:"scenicDetailHeaderImg",style:{backgroundImage:"url("+e.ImgSrc+")"}})})),h.a.createElement("div",{className:"scenicDetailHeaderBottom"},h.a.createElement("div",{className:"scenicDetailHeaderBottomText",style:{marginTop:"130px"}},t.CnName))):null}},{key:"renderBasicView",value:function(){if(!this.isValidData())return null;var e=this.props.sceneryList[this.getSelectedSceneryIndex()];return h.a.createElement("div",null,h.a.createElement("div",{className:"scenicDetailInfoRows sceneryDetailInfoRows"},h.a.createElement("div",{className:"scenicDetailInfoRow"},h.a.createElement("div",{className:"scenicDetailInfoLabel"},"\u666f\u70b9\u4ecb\u7ecd"),h.a.createElement("div",{className:"scenicDetailInfoValue scenicDetailMultDesc"},e.Scenerydesc))))}},{key:"renderOtherSceneryListView",value:function(){if(!this.isValidData())return null;var e=this.getSelectedSceneryIndex(),t=this.props.sceneryList.slice(0,e).concat(this.props.sceneryList.slice(e+1));return t&&0!==t.length?h.a.createElement("div",null,h.a.createElement("div",{className:"scenicDetailInfoLabel sceneryDetailInfoLabel"},"\u5176\u4ed6\u666f\u70b9"),h.a.createElement(S.a,{sceneryList:t,showSceneryDetail:this.showSceneryDetail})):null}},{key:"isValidData",value:function(){return this.props.sceneryList&&this.props.sceneryList.length>0&&this.props.match.params.sceneryCode&&this.props.match.params.sceneryCode.length>0}},{key:"getSelectedSceneryIndex",value:function(){if(!this.isValidData())return-1;for(var e=0;e<this.props.sceneryList.length;e++){if(this.props.sceneryList[e].Code===this.props.match.params.sceneryCode)return e}return-1}},{key:"cacheScrollOffset",value:function(){var e=E.a.findDOMNode(this.scrollView).scrollTop;this.props.dispatch(Object(I.f)(this.props.match.params.scenicCode,this.props.match.params.sceneryCode,e))}},{key:"restoreScrollViewPosition",value:function(e){this.scrollView&&(isNaN(e.scrollViewOffset)?this.scrollView.scrollToY(0):this.scrollView.scrollToY(e.scrollViewOffset))}},{key:"showSceneryDetail",value:function(e){this.cacheScrollOffset(),this.props.history.push("/scenic/scenery-detail/"+this.props.match.params.scenicCode+"/"+e.Code)}},{key:"showImageBrowser",value:function(){var e=this.getSelectedSceneryIndex(),t=this.props.sceneryList[e];if(!t.GetImage||!t.GetImage.ImageList||0===t.GetImage.ImageList.length)return null;for(var n=[],r=0;r<t.GetImage.ImageList.length;r++){var i=t.GetImage.ImageList[r];n.push(i.ImgSrc.replace("Small","Large"))}this.photoBrowserView.open(n)}}]),t}(p.PureComponent),T=function(e,t){var n=e.scenic.detailScreen[t.match.params.scenicCode];return n=n||{},{sceneryList:n.sceneryList,scrollViewOffset:n["sceneryDetailScreenScrollViewOffset_"+t.match.params.sceneryCode]}};g=Object(m.b)(T)(g),t.default=g},897:function(e,t,n){"use strict";function r(e){return{type:L.b.SCENIC.DETAIL.GO_BACK,code:e}}function i(e){return function(t,n){return t(I(e)),S(e).then(function(n){n=n&&n.results&&n.results.length>0?n.results[0]:n,t(w(e,n))}).catch(function(n){t(C(e,n))})}}function o(e){return function(t,n){return t(y(e)),m(e).then(function(n){n=n?n.results:[],t(d(e,n))}).catch(function(n){t(E(e,n))})}}function s(e){return function(t,n){return t(f(e)),u(e).then(function(n){n=n?n.results:[],t(p(e,n))}).catch(function(n){t(h(e,n))})}}function a(e,t){return{type:L.b.SCENIC.DETAIL.SET_DETAIL_SCROLL_OFFSET,code:e,scrollViewOffset:t}}function c(e,t){return{type:L.b.SCENIC.DETAIL.SET_SCENERY_LIST_SCROLL_OFFSET,code:e,scrollViewOffset:t}}function l(e,t,n){return{type:L.b.SCENIC.DETAIL.SET_SCENERY_DETAIL_SCROLL_OFFSET,code:e,sceneryCode:t,scrollViewOffset:n}}function u(e){var t={ConditionParams:{Params:{Code:e}}};return g.a.postToPortalWithUrl(g.a.HOST_E_BUSINESS,L.q.ELEMENTS.SceneryList,t).then(function(e){return e.json()})}function f(e){return{type:L.b.SCENIC.DETAIL.GET_SCENERY_LIST_REQUEST,code:e}}function p(e,t){return{type:L.b.SCENIC.DETAIL.GET_SCENERY_LIST_SUCCESS,code:e,sceneryList:t}}function h(e,t){return{type:L.b.SCENIC.DETAIL.GET_SCENERY_LIST_FAILURE,code:e,message:t}}function m(e){var t={ConditionParams:{Params:{Code:e,PlayDate:(new Date).formatDate("YYYY-MM-DD")}}};return g.a.postToPortalWithUrl(g.a.HOST_E_BUSINESS,L.q.ELEMENTS.AttractionsTicketList,t).then(function(e){return e.json()})}function y(e){return{type:L.b.SCENIC.DETAIL.GET_TICKET_LIST_REQUEST,code:e}}function d(e,t){return{type:L.b.SCENIC.DETAIL.GET_TICKET_LIST_SUCCESS,code:e,ticketList:t}}function E(e,t){return{type:L.b.SCENIC.DETAIL.GET_TICKET_LIST_FAILURE,code:e,message:t}}function S(e){var t={ConditionParams:{Params:{Code:e}}};return g.a.postToPortalWithUrl(g.a.HOST_E_BUSINESS,L.q.ELEMENTS.AttractionsDetail,t).then(function(e){return e.json()})}function I(e){return{type:L.b.SCENIC.DETAIL.GET_DETAIL_REQUEST,code:e}}function w(e,t){return{type:L.b.SCENIC.DETAIL.GET_DETAIL_SUCCESS,code:e,detailItem:t}}function C(e,t){return{type:L.b.SCENIC.DETAIL.GET_DETAIL_FAILURE,code:e,message:t}}t.d=r,t.a=i,t.c=o,t.b=s,t.e=a,t.g=c,t.f=l;var L=n(1),g=n(8)},900:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function o(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=n(0),a=n.n(s),c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function(e){function t(){var e,n,o,s;r(this,t);for(var a=arguments.length,c=Array(a),l=0;l<a;l++)c[l]=arguments[l];return n=o=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),o.columnCount=3,s=n,i(o,s)}return o(t,e),c(t,[{key:"render",value:function(){return this.renderSceneryListView()}},{key:"renderSceneryListView",value:function(){var e=this;if(!this.props.sceneryList||0===this.props.sceneryList.length)return null;for(var t=[],n=Math.ceil(this.props.sceneryList.length/this.columnCount),r=0;r<n;r++)t[r]=this.props.sceneryList.slice(r*this.columnCount,(r+1)*this.columnCount);return t.map(function(n,r){return e.renderSceneryRowView(n,r,r===t.length-1)})}},{key:"renderSceneryRowView",value:function(e,t,n){var r=this,i=(window.innerWidth-12*(this.columnCount+1))/this.columnCount,o=.75*i;return a.a.createElement("div",{key:t,className:"sceneryListRow",style:n?{marginBottom:"12px"}:{}},e.map(function(e,t){return a.a.createElement("div",{key:t,onClick:function(){r.props.showSceneryDetail&&r.props.showSceneryDetail(e)},className:"sceneryListRowItem",style:{width:i+"px",height:o+"px"}},a.a.createElement("img",{className:"sceneryListRowImg",src:e.GetImage?e.GetImage.ImageFrontUrl:"",style:{width:i+"px",height:o+"px"},alt:""}),a.a.createElement("div",{className:"sceneryListRowTitle"},e.CnName))}))}}]),t}(s.PureComponent);t.a=l}});
//# sourceMappingURL=12.dbc9ae6d.chunk.js.map