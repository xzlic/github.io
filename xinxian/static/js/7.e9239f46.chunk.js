webpackJsonp([7],{861:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(35),c=(n.n(a),n(36)),o=n.n(c),l=n(11),u=(n.n(l),n(12)),p=n.n(u),f=n(9),h=(n.n(f),n(10)),m=n.n(h),y=n(0),d=n.n(y),E=n(2),S=n(13),I=n(16),g=n.n(I),w=n(869),L=n(865),C=n(45),v=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),T=function(e){function t(e){r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.showSceneryDetail=n.showSceneryDetail.bind(n),n.showImageBrowser=n.showImageBrowser.bind(n),n.state={showImageBrowser:!1,imageList:[]},n}return s(t,e),v(t,[{key:"componentWillReceiveProps",value:function(e){this.props.match.params.sceneryCode!==e.match.params.sceneryCode&&this.restoreScrollViewPosition(e)}},{key:"componentDidMount",value:function(){this.restoreScrollViewPosition(this.props)}},{key:"render",value:function(){var e=this;return d.a.createElement("div",null,d.a.createElement(p.a,{mode:"dark",className:"navBar",icon:d.a.createElement(m.a,{type:"left"}),onLeftClick:function(){e.props.history.goBack()}},"\u666f\u70b9\u8be6\u60c5"),d.a.createElement(S.a,{ref:function(t){e.scrollView=t}},this.renderHeaderView(),this.renderBasicView(),d.a.createElement("div",{className:"homeSplitSpace"}),this.renderOtherSceneryListView(),d.a.createElement(C.a,{imageList:this.state.imageList,isOpen:this.state.showImageBrowser,hiddenImageBrowser:function(){e.setState({showImageBrowser:!1})}})))}},{key:"renderHeaderView",value:function(){if(!this.isValidData())return null;var e=this.getSelectedSceneryIndex(),t=this.props.sceneryList[e];return t.GetImage&&t.GetImage.ImageList&&0!==t.GetImage.ImageList.length?d.a.createElement("div",{className:"scenicDetailHeader",onClick:this.showImageBrowser},d.a.createElement(o.a,{className:"scenicDetailHeaderImgSlider",autoplay:!0,dots:!1,swiping:!0,infinite:!0,selectedIndex:0,swipeSpeed:35},t.GetImage.ImageList.map(function(e,t){return d.a.createElement("div",{key:t,className:"scenicDetailHeaderImg",style:{backgroundImage:"url("+e.ImgSrc+")"}})})),d.a.createElement("div",{className:"scenicDetailHeaderBottom"},d.a.createElement("div",{className:"scenicDetailHeaderBottomText",style:{marginTop:"130px"}},t.CnName))):null}},{key:"renderBasicView",value:function(){if(!this.isValidData())return null;var e=this.props.sceneryList[this.getSelectedSceneryIndex()];return d.a.createElement("div",null,d.a.createElement("div",{className:"scenicDetailInfoRows sceneryDetailInfoRows"},d.a.createElement("div",{className:"scenicDetailInfoRow"},d.a.createElement("div",{className:"scenicDetailInfoLabel"},"\u666f\u70b9\u4ecb\u7ecd"),d.a.createElement("div",{className:"scenicDetailInfoValue scenicDetailMultDesc"},e.Scenerydesc))))}},{key:"renderOtherSceneryListView",value:function(){if(!this.isValidData())return null;var e=this.getSelectedSceneryIndex(),t=this.props.sceneryList.slice(0,e).concat(this.props.sceneryList.slice(e+1));return t&&0!==t.length?d.a.createElement("div",null,d.a.createElement("div",{className:"scenicDetailInfoLabel sceneryDetailInfoLabel"},"\u5176\u4ed6\u666f\u70b9"),d.a.createElement(w.a,{sceneryList:t,showSceneryDetail:this.showSceneryDetail})):null}},{key:"isValidData",value:function(){return this.props.sceneryList&&this.props.sceneryList.length>0&&this.props.match.params.sceneryCode&&this.props.match.params.sceneryCode.length>0}},{key:"getSelectedSceneryIndex",value:function(){if(!this.isValidData())return-1;for(var e=0;e<this.props.sceneryList.length;e++){if(this.props.sceneryList[e].Code===this.props.match.params.sceneryCode)return e}return-1}},{key:"cacheScrollOffset",value:function(){var e=g.a.findDOMNode(this.scrollView).scrollTop;this.props.dispatch(Object(L.f)(this.props.match.params.scenicCode,this.props.match.params.sceneryCode,e))}},{key:"restoreScrollViewPosition",value:function(e){this.scrollView&&(isNaN(e.scrollViewOffset)?this.scrollView.scrollToY(0):this.scrollView.scrollToY(e.scrollViewOffset))}},{key:"showSceneryDetail",value:function(e){this.cacheScrollOffset(),this.props.history.push("/scenic/scenery-detail/"+this.props.match.params.scenicCode+"/"+e.Code)}},{key:"showImageBrowser",value:function(){var e=this.getSelectedSceneryIndex(),t=this.props.sceneryList[e];if(!t.GetImage||!t.GetImage.ImageList||0===t.GetImage.ImageList.length)return null;if(!this.state.imageList||this.state.imageList.length<=0){for(var n=[],r=0;r<t.GetImage.ImageList.length;r++){var i=t.GetImage.ImageList[r];n.push({src:i.ImgSrc.replace("Small","Large")})}this.setState({showImageBrowser:!0,imageList:n})}else this.setState({showImageBrowser:!0})}}]),t}(y.Component),_=function(e,t){var n=e.scenic.detailScreen[t.match.params.scenicCode];return n=n||{},{sceneryList:n.sceneryList,scrollViewOffset:n["sceneryDetailScreenScrollViewOffset_"+t.match.params.sceneryCode]}};T=Object(E.b)(_)(T),t.default=T},865:function(e,t,n){"use strict";function r(e){return{type:L.c.SCENIC.DETAIL.GO_BACK,code:e}}function i(e){return function(t,n){return t(I(e)),S(e).then(function(n){n=n&&n.results&&n.results.length>0?n.results[0]:n,t(g(e,n))}).catch(function(n){t(w(e,n))})}}function s(e){return function(t,n){return t(y(e)),m(e).then(function(n){n=n?n.results:[],t(d(e,n))}).catch(function(n){t(E(e,n))})}}function a(e){return function(t,n){return t(p(e)),u(e).then(function(n){n=n?n.results:[],t(f(e,n))}).catch(function(n){t(h(e,n))})}}function c(e,t){return{type:L.c.SCENIC.DETAIL.SET_DETAIL_SCROLL_OFFSET,code:e,scrollViewOffset:t}}function o(e,t){return{type:L.c.SCENIC.DETAIL.SET_SCENERY_LIST_SCROLL_OFFSET,code:e,scrollViewOffset:t}}function l(e,t,n){return{type:L.c.SCENIC.DETAIL.SET_SCENERY_DETAIL_SCROLL_OFFSET,code:e,sceneryCode:t,scrollViewOffset:n}}function u(e){var t=C.a.HOST_E_BUSINESS+"/api/Attractions/GetSceneryList",n={type:"app",Code:e};return C.a.getData(t,n).then(function(e){return e.json()})}function p(e){return{type:L.c.SCENIC.DETAIL.GET_SCENERY_LIST_REQUEST,code:e}}function f(e,t){return{type:L.c.SCENIC.DETAIL.GET_SCENERY_LIST_SUCCESS,code:e,sceneryList:t}}function h(e,t){return{type:L.c.SCENIC.DETAIL.GET_SCENERY_LIST_FAILURE,code:e,message:t}}function m(e){var t=C.a.HOST_E_BUSINESS+"/api/Attractions/GetTicketList",n=new Date,r=n.getFullYear()+"-"+(n.getMonth()+1)+"-"+n.getDate(),i={type:"app",Code:e,selecttime:r};return C.a.getData(t,i).then(function(e){return e.json()})}function y(e){return{type:L.c.SCENIC.DETAIL.GET_TICKET_LIST_REQUEST,code:e}}function d(e,t){return{type:L.c.SCENIC.DETAIL.GET_TICKET_LIST_SUCCESS,code:e,ticketList:t}}function E(e,t){return{type:L.c.SCENIC.DETAIL.GET_TICKET_LIST_FAILURE,code:e,message:t}}function S(e){var t=C.a.HOST_E_BUSINESS+"/api/Attractions/GetAttractionsDetail",n={type:"app",Code:e};return C.a.getData(t,n).then(function(e){return e.json()})}function I(e){return{type:L.c.SCENIC.DETAIL.GET_DETAIL_REQUEST,code:e}}function g(e,t){return{type:L.c.SCENIC.DETAIL.GET_DETAIL_SUCCESS,code:e,detailItem:t}}function w(e,t){return{type:L.c.SCENIC.DETAIL.GET_DETAIL_FAILURE,code:e,message:t}}t.d=r,t.a=i,t.c=s,t.b=a,t.e=c,t.g=o,t.f=l;var L=n(1),C=n(8)},869:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n(0),c=n.n(a),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function(e){function t(){var e,n,s,a;r(this,t);for(var c=arguments.length,o=Array(c),l=0;l<c;l++)o[l]=arguments[l];return n=s=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),s.columnCount=3,a=n,i(s,a)}return s(t,e),o(t,[{key:"render",value:function(){return this.renderSceneryListView()}},{key:"renderSceneryListView",value:function(){var e=this;if(!this.props.sceneryList||0===this.props.sceneryList.length)return null;for(var t=[],n=Math.ceil(this.props.sceneryList.length/this.columnCount),r=0;r<n;r++)t[r]=this.props.sceneryList.slice(r*this.columnCount,(r+1)*this.columnCount);return t.map(function(n,r){return e.renderSceneryRowView(n,r,r===t.length-1)})}},{key:"renderSceneryRowView",value:function(e,t,n){var r=this,i=(window.innerWidth-12*(this.columnCount+1))/this.columnCount,s=.75*i;return c.a.createElement("div",{key:t,className:"sceneryListRow",style:n?{marginBottom:"12px"}:{}},e.map(function(e,t){return c.a.createElement("div",{key:t,onClick:function(){r.props.showSceneryDetail&&r.props.showSceneryDetail(e)},className:"sceneryListRowItem",style:{width:i+"px",height:s+"px"}},c.a.createElement("img",{className:"sceneryListRowImg",src:e.GetImage?e.GetImage.ImageFrontUrl:"",style:{width:i+"px",height:s+"px"},alt:""}),c.a.createElement("div",{className:"sceneryListRowTitle"},e.CnName))}))}}]),t}(a.Component);t.a=l}});
//# sourceMappingURL=7.e9239f46.chunk.js.map