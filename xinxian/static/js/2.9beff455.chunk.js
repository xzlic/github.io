webpackJsonp([2],{862:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function o(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(11),s=(n.n(a),n(12)),c=n.n(s),l=n(39),u=(n.n(l),n(40)),f=n.n(u),p=n(9),h=(n.n(p),n(10)),d=n.n(h),m=n(0),E=n.n(m),y=n(2),v=n(13),w=n(906),b=n(872),S=n(272),C=(n.n(S),function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}()),_=function(e){function t(e){i(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onItemClick=n.onItemClick.bind(n),n.goBack=n.goBack.bind(n),n.showCommonList=n.showCommonList.bind(n),n}return o(t,e),C(t,[{key:"render",value:function(){var e=this,t=window.innerHeight-45;return E.a.createElement("div",null,E.a.createElement(c.a,{mode:"dark",className:"navBar",icon:E.a.createElement(d.a,{type:"left"}),onLeftClick:this.goBack},E.a.createElement(f.a,{values:["\u975e\u6e38\u4e0d\u53ef","\u5168\u90e8\u666f\u533a"],tintColor:"white",selectedIndex:0,onValueChange:this.showCommonList})),E.a.createElement(v.a,null,E.a.createElement(w.a,{ref:function(t){t&&(e.listView=t.getWrappedInstance())},onItemClick:this.onItemClick,height:t})))}},{key:"onItemClick",value:function(e){e&&(this.listView&&this.listView.cacheScrollOffset(),this.props.history.push("/scenic/detail/"+e.WEB_BASE_ATTRACTIONS_Code))}},{key:"goBack",value:function(){var e=this.props.dispatch;this.props.history.goBack(),e(Object(b.c)())}},{key:"showCommonList",value:function(){this.listView&&this.listView.cacheScrollOffset(),this.props.history.push("/scenic/list?segment=true")}}]),t}(m.Component);_=Object(y.b)()(_),t.default=_},867:function(e,t,n){e.exports=n.p+"static/media/ico_a_full@2x.a5d6eea0.png"},868:function(e,t,n){e.exports=n.p+"static/media/ico_a_empty@2x.f866e867.png"},872:function(e,t,n){"use strict";function i(){return function(e,t){return e(l()),c().then(function(t){var n=t&&t.results&&t.results.length>0?t.results[0].value:[];e(u(n))}).catch(function(t){e(f(t))})}}function r(){return{type:p.c.SCENIC.RECOMMEND_LIST.GO_BACK}}function o(){return function(e,t){return e(a()),new Promise(function(e){e()})}}function a(){return{type:p.c.SCENIC.RECOMMEND_LIST.DELETE}}function s(e){return{type:p.c.SCENIC.RECOMMEND_LIST.SET_LISTVIEW_OFFSET,listViewOffset:e}}function c(e,t,n,i){var r=h.a.HOST_PORTAL+"/Api/CMSService/GetModuleData",o={format:"json",Identifier:"mobile/wanzhuan/you"};return h.a.getData(r,o).then(function(e){return e.json()})}function l(){return{type:p.c.SCENIC.RECOMMEND_LIST.GET_LIST_REQUEST}}function u(e){return{type:p.c.SCENIC.RECOMMEND_LIST.GET_LIST_SUCCESS,dataList:e}}function f(e){return{type:p.c.SCENIC.RECOMMEND_LIST.GET_LIST_FAILURE,message:e}}t.b=i,t.c=r,t.a=o,t.d=s;var p=n(1),h=n(8)},906:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function o(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n(23),s=(n.n(a),n(24)),c=n.n(s),l=n(17),u=(n.n(l),n(18)),f=n.n(u),p=n(25),h=(n.n(p),n(26)),d=n.n(h),m=n(0),E=n.n(m),y=n(2),v=n(6),w=n.n(v),b=n(16),S=n.n(b),C=n(872),_=n(21),g=n(1),O=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),T=function(e){function t(e){i(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.renderRow=n.renderRow.bind(n),n.onRefresh=n.onRefresh.bind(n);var o=new d.a.DataSource({rowHasChanged:function(e,t){return e!==t},sectionHeaderHasChanged:function(e,t){return e!==t}});return n.state={dataSource:o.cloneWithRows(n.props.dataList?n.props.dataList:[])},n}return o(t,e),O(t,[{key:"componentDidMount",value:function(){this.props.dataList||this.loadData(),this.listView&&!isNaN(this.props.listViewOffset)&&this.listView.scrollTo(0,this.props.listViewOffset)}},{key:"componentWillReceiveProps",value:function(e){this.props.dataList!==e.dataList&&this.setState({dataSource:this.state.dataSource.cloneWithRows(e.dataList?e.dataList:[])})}},{key:"render",value:function(){return E.a.createElement("div",{className:"scenicListBox",style:{height:this.props.height}},this.renderListView(),this.props.isFetching?E.a.createElement(f.a,{toast:!0,text:"Loading..."}):null)}},{key:"renderListView",value:function(){var e=this;if(this.props.dataList&&this.props.dataList.length>=0){var t=function(e,t){return E.a.createElement("div",{key:e+"-"+t,style:{height:"5px",backgroundColor:"#2d2327"}})};return E.a.createElement(d.a,{ref:function(t){e.listView=t,_.a.fixListViewHeightIssue(t,e.props.height)},dataSource:this.state.dataSource,renderRow:this.renderRow,renderSeparator:t,style:{height:this.props.height,overflow:"auto"},pullToRefresh:E.a.createElement(c.a,{refreshing:this.props.isFetching,onRefresh:this.onRefresh}),initialListSize:this.props.dataList.length,pageSize:20,scrollRenderAheadDistance:500,scrollEventThrottle:50,onEndReachedThreshold:20})}}},{key:"isEmptyString",value:function(e){return!e||0===e.length}},{key:"onRefresh",value:function(){var e=this;this.props.dispatch(Object(C.a)()).then(function(){e.loadData()})}},{key:"renderRow",value:function(e,t,i){var r=this,o=g.h[e.WEB_BASE_ATTRACTIONS_AttractionsStar];o=o||0;var a=n(867),s=n(868);return E.a.createElement("div",{key:i,className:"scenicRecommendListItemBox",onClick:function(){r.props.onItemClick&&r.props.onItemClick(e)}},E.a.createElement("div",{className:"scenicRecommendListItemBg",style:{backgroundImage:"url("+e.WEB_BASE_ATTRACTIONS_F_MiddleImage+")"}},E.a.createElement("div",{className:"scenicRecommendListBottom"},E.a.createElement("div",{className:"scenicDetailHeaderBottomText"},e.WEB_BASE_ATTRACTIONS_CnName),E.a.createElement("div",{className:"scenicRecommendListBottomStars"},new Array(5).fill(0).map(function(e,t){return E.a.createElement("img",{key:t,className:"scenicDetailHeaderBottomStar",src:t<o?a:s,alt:""})})))))}},{key:"loadData",value:function(){this.props.isFetching||this.props.dispatch(Object(C.b)())}},{key:"cacheScrollOffset",value:function(){if(this.listView){var e=S.a.findDOMNode(this.listView).scrollTop;this.props.dispatch(Object(C.d)(e))}}}]),t}(m.Component);T.propTypes={onItemClick:w.a.func};var L=function(e){return Object.assign({},e.scenic.recommendListScreen)};T=Object(y.b)(L,null,null,{withRef:!0})(T),t.a=T}});
//# sourceMappingURL=2.9beff455.chunk.js.map