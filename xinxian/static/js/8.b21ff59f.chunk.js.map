{"version":3,"sources":["../static/js/8.b21ff59f.chunk.js","screens/map/ElementMarkerScreen.js","store/actions/map/elementMarkerAction.js","assets/images/map/icon_line.png"],"names":["webpackJsonp","864","module","__webpack_exports__","__webpack_require__","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","defineProperty","__WEBPACK_IMPORTED_MODULE_0_antd_mobile_lib_nav_bar_style_css__","__WEBPACK_IMPORTED_MODULE_1_antd_mobile_lib_nav_bar__","n","__WEBPACK_IMPORTED_MODULE_1_antd_mobile_lib_nav_bar___default","__WEBPACK_IMPORTED_MODULE_2_antd_mobile_lib_icon_style_css__","__WEBPACK_IMPORTED_MODULE_3_antd_mobile_lib_icon__","__WEBPACK_IMPORTED_MODULE_3_antd_mobile_lib_icon___default","__WEBPACK_IMPORTED_MODULE_4_react__","__WEBPACK_IMPORTED_MODULE_4_react___default","__WEBPACK_IMPORTED_MODULE_5_react_redux__","__WEBPACK_IMPORTED_MODULE_6__views_common_Content__","__WEBPACK_IMPORTED_MODULE_7_react_dom__","__WEBPACK_IMPORTED_MODULE_7_react_dom___default","__WEBPACK_IMPORTED_MODULE_8__core_utils_IConstant__","__WEBPACK_IMPORTED_MODULE_9__store_actions_map_elementMarkerAction__","_createClass","defineProperties","target","props","i","length","descriptor","key","protoProps","staticProps","ElementMarkerScreen","_Component","this","_this","getPrototypeOf","name","address","lat","lng","match","params","state","mapHeight","updateWindowDimensions","nextProps","baiduMapInited","initMap","_this2","a","createElement","mode","className","icon","type","onLeftClick","code","dispatch","history","goBack","ref","view","scrollView","id","style","height","markerIcon","window","BMap","Icon","Size","anchor","imageSize","map","Map","centerAndZoom","Point","addControl","NavigationControl","BMAP_NAVIGATION_CONTROL_SMALL","BMAP_ANCHOR_BOTTOM_RIGHT","enableGeolocation","offset","GeolocationControl","enableAutoLocation","setMapCenter","mapZoom","setZoom","setCenter","centerLng","centerLat","_this3","point","clearOverlays","marker","Marker","lineImageUrl","div","label","Label","setStyle","padding","color","background-color","border","border-radius","transform","setLabel","addEventListener","markerTapped","addOverlay","setMapZoomAndCenterLocation","push","_this4","innerHeight","findDOMNode","parentNode","offsetTop","setState","centerPoint","getCenter","getZoom","mapStateToProps","ownProps","obj","elementMarker","assign","system","912","goBackAction","__WEBPACK_IMPORTED_MODULE_0__core_utils_IConstant__","MAP","ELEMENTMARKER","GO_BACK","mapZoomAndCenterLocationChangeAction","getState","_mapZoomAndCenterLocationChangeAction","Promise","resolve","MAPZOOM_AND_CENTERLOCATION_CHANGE","913","exports","p"],"mappings":"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","file":"static/js/8.b21ff59f.chunk.js","sourcesContent":["webpackJsonp([8],{\n\n/***/ 864:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_antd_mobile_lib_nav_bar_style_css__ = __webpack_require__(11);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_antd_mobile_lib_nav_bar_style_css___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_antd_mobile_lib_nav_bar_style_css__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_antd_mobile_lib_nav_bar__ = __webpack_require__(12);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_antd_mobile_lib_nav_bar___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_antd_mobile_lib_nav_bar__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_antd_mobile_lib_icon_style_css__ = __webpack_require__(9);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_antd_mobile_lib_icon_style_css___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_antd_mobile_lib_icon_style_css__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_antd_mobile_lib_icon__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_antd_mobile_lib_icon___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_antd_mobile_lib_icon__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_react__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_react___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_react__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_react_redux__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__views_common_Content__ = __webpack_require__(13);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_react_dom__ = __webpack_require__(16);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_react_dom___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_react_dom__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__core_utils_IConstant__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__store_actions_map_elementMarkerAction__ = __webpack_require__(912);\nvar _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if(\"value\"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError(\"Cannot call a class as a function\");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");}return call&&(typeof call===\"object\"||typeof call===\"function\")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!==\"function\"&&superClass!==null){throw new TypeError(\"Super expression must either be null or a function, not \"+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var ElementMarkerScreen=function(_Component){_inherits(ElementMarkerScreen,_Component);function ElementMarkerScreen(props){_classCallCheck(this,ElementMarkerScreen);var _this=_possibleConstructorReturn(this,(ElementMarkerScreen.__proto__||Object.getPrototypeOf(ElementMarkerScreen)).call(this,props));_this.name='';_this.address='';_this.lat='';_this.lng='';_this.name=_this.props.match.params.name;_this.address=_this.props.match.params.address;_this.lat=_this.props.match.params.lat;_this.lng=_this.props.match.params.lng;_this.state={mapHeight:0};return _this;}_createClass(ElementMarkerScreen,[{key:'componentDidMount',value:function componentDidMount(){this.updateWindowDimensions();}},{key:'componentWillReceiveProps',value:function componentWillReceiveProps(nextProps){if(!this.props.baiduMapInited&&nextProps.baiduMapInited){this.initMap();}}},{key:'render',value:function render(){var _this2=this;return __WEBPACK_IMPORTED_MODULE_4_react___default.a.createElement('div',null,__WEBPACK_IMPORTED_MODULE_4_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_1_antd_mobile_lib_nav_bar___default.a,{mode:'dark',className:'navBar',icon:__WEBPACK_IMPORTED_MODULE_4_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_3_antd_mobile_lib_icon___default.a,{type:'left'}),onLeftClick:function onLeftClick(){var code=_this2.props.match.params.code;var dispatch=_this2.props.dispatch;_this2.props.history.goBack();dispatch(Object(__WEBPACK_IMPORTED_MODULE_9__store_actions_map_elementMarkerAction__[\"a\" /* goBackAction */])(code));}},this.name),__WEBPACK_IMPORTED_MODULE_4_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_6__views_common_Content__[\"a\" /* default */],{ref:function ref(view){_this2.scrollView=view;}},__WEBPACK_IMPORTED_MODULE_4_react___default.a.createElement('div',{id:'elementMarkerMap',style:{height:this.state.mapHeight+'px'}})));}},{key:'initMap',value:function initMap(){// 地图标记图片\nthis.markerIcon=new window.BMap.Icon(__webpack_require__(273),new window.BMap.Size(30,30),{anchor:new window.BMap.Size(15,30),imageSize:new window.BMap.Size(30,30)});this.map=this.map?this.map:new window.BMap.Map('elementMarkerMap');this.map.centerAndZoom(new window.BMap.Point(__WEBPACK_IMPORTED_MODULE_8__core_utils_IConstant__[\"b\" /* APP_CITY_LONGITUDE */],__WEBPACK_IMPORTED_MODULE_8__core_utils_IConstant__[\"a\" /* APP_CITY_LATITUDE */]),16);this.map.addControl(new window.BMap.NavigationControl({type:window.BMAP_NAVIGATION_CONTROL_SMALL,anchor:window.BMAP_ANCHOR_BOTTOM_RIGHT,enableGeolocation:true,offset:new window.BMap.Size(20,20)}));this.map.addControl(new window.BMap.GeolocationControl({enableAutoLocation:false}));this.setMapCenter();if(this.props.mapZoom){this.map.setZoom(this.props.mapZoom);this.map.setCenter(new window.BMap.Point(this.props.centerLng,this.props.centerLat));}}},{key:'setMapCenter',value:function setMapCenter(){var _this3=this;if(this.map&&this.lat&&this.lng){var point=new window.BMap.Point(this.lng,this.lat);this.map.setCenter(point);this.map.clearOverlays();// 创建标注对象并添加到地图\nvar marker=new window.BMap.Marker(point,{icon:this.markerIcon});var lineImageUrl=__webpack_require__(913);var div='\\n            <div style=\"display: flex; flex-direction: row;\">\\n                <div>\\n                    <div style=\"font-size: 14px; text-align: center; min-width:40vw; max-width: 70vw;\">'+this.name+'</div>\\n                    <div style=\"font-size: 12px; text-align: center; min-width:40vw; max-width: 70vw; margin-top: 5px; white-space: normal;\">'+this.address+'</div>\\n                </div>\\n                <div style=\"width: 25px; margin-left: 6px; display: -webkit-flex;display: flex;flex-flow: row;align-items: center;\">\\n                    <img style=\"width: 25px; height: 20px;\" src=\"'+lineImageUrl+'\">\\n                </div>\\n            </div>\\n            ';var label=new window.BMap.Label(div);label.setStyle({'padding':'5px 10px','color':'white','background-color':'#3988d4','border':'0px','border-radius':'3px','transform':'translate(calc(-50% + 11px), calc(-100% - 2px))'});marker.setLabel(label);marker.addEventListener('click',function(){_this3.markerTapped();});label.addEventListener('click',function(){_this3.markerTapped();});this.map.addOverlay(marker);}}},{key:'markerTapped',value:function markerTapped(){this.setMapZoomAndCenterLocation();//导航点击\nthis.props.history.push('/map/mapNav/'+this.props.match.params.code+'/'+this.lat+'/'+this.lng);}},{key:'updateWindowDimensions',value:function updateWindowDimensions(){var _this4=this;var height=window.innerHeight-__WEBPACK_IMPORTED_MODULE_7_react_dom___default.a.findDOMNode(this).parentNode.offsetTop;this.setState({mapHeight:height},function(){if(_this4.props.baiduMapInited){_this4.initMap();}});}// 保存 地图中心点 和 缩放级\n},{key:'setMapZoomAndCenterLocation',value:function setMapZoomAndCenterLocation(){if(!this.map){return;}var centerPoint=this.map.getCenter();var mapZoom=this.map.getZoom();var centerLat=centerPoint.lat;var centerLng=centerPoint.lng;this.props.dispatch(Object(__WEBPACK_IMPORTED_MODULE_9__store_actions_map_elementMarkerAction__[\"b\" /* mapZoomAndCenterLocationChangeAction */])(this.props.match.params.code,mapZoom,centerLat,centerLng));}}]);return ElementMarkerScreen;}(__WEBPACK_IMPORTED_MODULE_4_react__[\"Component\"]);var mapStateToProps=function mapStateToProps(state,ownProps){var obj=state.map.elementMarker[ownProps.match.params.code];return Object.assign({},obj,{baiduMapInited:state.system.baiduMapInited});};ElementMarkerScreen=Object(__WEBPACK_IMPORTED_MODULE_5_react_redux__[\"b\" /* connect */])(mapStateToProps)(ElementMarkerScreen);/* harmony default export */ __webpack_exports__[\"default\"] = (ElementMarkerScreen);\n\n/***/ }),\n\n/***/ 912:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = goBackAction;\n/* harmony export (immutable) */ __webpack_exports__[\"b\"] = mapZoomAndCenterLocationChangeAction;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__core_utils_IConstant__ = __webpack_require__(1);\nfunction goBackAction(code){return{type:__WEBPACK_IMPORTED_MODULE_0__core_utils_IConstant__[\"c\" /* Actions */].MAP.ELEMENTMARKER.GO_BACK,code:code};}function mapZoomAndCenterLocationChangeAction(code,mapZoom,centerLat,centerLng){return function(dispatch,getState){dispatch(_mapZoomAndCenterLocationChangeAction(code,mapZoom,centerLat,centerLng));return new Promise(function(resolve){resolve();});};}function _mapZoomAndCenterLocationChangeAction(code,mapZoom,centerLat,centerLng){return{type:__WEBPACK_IMPORTED_MODULE_0__core_utils_IConstant__[\"c\" /* Actions */].MAP.ELEMENTMARKER.MAPZOOM_AND_CENTERLOCATION_CHANGE,code:code,mapZoom:mapZoom,centerLat:centerLat,centerLng:centerLng};}\n\n/***/ }),\n\n/***/ 913:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__.p + \"static/media/icon_line.489cc7de.png\";\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/js/8.b21ff59f.chunk.js","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { NavBar, Icon } from 'antd-mobile';\r\nimport Content from '../../views/common/Content';\r\nimport ReactDOM from 'react-dom';\r\nimport { APP_CITY_LATITUDE, APP_CITY_LONGITUDE } from '../../core/utils/IConstant';\r\nimport { \r\n    goBackAction, \r\n    mapZoomAndCenterLocationChangeAction\r\n} from '../../store/actions/map/elementMarkerAction';\r\n\r\nclass ElementMarkerScreen extends Component\r\n{\r\n    name = '';\r\n    address = '';\r\n    lat = '';\r\n    lng = '';\r\n    constructor(props)\r\n    {\r\n        super(props);\r\n        this.name = this.props.match.params.name;\r\n        this.address = this.props.match.params.address;\r\n        this.lat = this.props.match.params.lat;\r\n        this.lng = this.props.match.params.lng;\r\n        this.state = {\r\n            mapHeight: 0,\r\n        };\r\n    }\r\n    componentDidMount()\r\n    {\r\n        this.updateWindowDimensions();\r\n    }\r\n\r\n    componentWillReceiveProps(nextProps)\r\n    {\r\n        if(!this.props.baiduMapInited && nextProps.baiduMapInited)\r\n        {\r\n            this.initMap();\r\n        }\r\n        \r\n    }\r\n\r\n    render()\r\n    {\r\n        return (\r\n            <div>\r\n                <NavBar mode=\"dark\" \r\n                    className=\"navBar\"\r\n                    icon={<Icon type=\"left\" />}\r\n                    onLeftClick={() => {\r\n                        let code = this.props.match.params.code;\r\n                        let dispatch = this.props.dispatch;\r\n                        this.props.history.goBack();\r\n                        dispatch(goBackAction(code));\r\n                    }}>\r\n                    {this.name}\r\n                </NavBar>\r\n                <Content ref={(view)=>{this.scrollView = view;}}>\r\n                    <div id=\"elementMarkerMap\" style={{height: (this.state.mapHeight + 'px')}}></div>\r\n                </Content>\r\n            </div>\r\n        );\r\n    }\r\n    \r\n    initMap()\r\n    {\r\n        // 地图标记图片\r\n        this.markerIcon = new window.BMap.Icon(require('../../assets/images/map/common_poi@2x.png'), new window.BMap.Size(30, 30), {\r\n            anchor: new window.BMap.Size(15, 30),\r\n            imageSize: new window.BMap.Size(30, 30)\r\n        });\r\n\r\n        this.map = this.map ? this.map : new window.BMap.Map('elementMarkerMap');\r\n        this.map.centerAndZoom(new window.BMap.Point(APP_CITY_LONGITUDE, APP_CITY_LATITUDE), 16);\r\n        this.map.addControl(new window.BMap.NavigationControl({type: window.BMAP_NAVIGATION_CONTROL_SMALL, anchor: window.BMAP_ANCHOR_BOTTOM_RIGHT, enableGeolocation: true, offset: new window.BMap.Size(20, 20)}));\r\n        this.map.addControl(new window.BMap.GeolocationControl({enableAutoLocation: false}));\r\n\r\n        this.setMapCenter();\r\n\r\n        if (this.props.mapZoom)\r\n        {\r\n            this.map.setZoom(this.props.mapZoom);\r\n            this.map.setCenter(new window.BMap.Point(this.props.centerLng, this.props.centerLat));\r\n        }\r\n    }\r\n\r\n    setMapCenter()\r\n    {\r\n        if(this.map && this.lat && this.lng)\r\n        {\r\n            let point = new window.BMap.Point(this.lng, this.lat);\r\n            this.map.setCenter(point);\r\n\r\n            this.map.clearOverlays();\r\n\r\n            // 创建标注对象并添加到地图\r\n            let marker = new window.BMap.Marker(point, {icon: this.markerIcon});\r\n            let lineImageUrl = require('../../assets/images/map/icon_line.png');\r\n            let div = `\r\n            <div style=\"display: flex; flex-direction: row;\">\r\n                <div>\r\n                    <div style=\"font-size: 14px; text-align: center; min-width:40vw; max-width: 70vw;\">` + this.name + `</div>\r\n                    <div style=\"font-size: 12px; text-align: center; min-width:40vw; max-width: 70vw; margin-top: 5px; white-space: normal;\">` + this.address + `</div>\r\n                </div>\r\n                <div style=\"width: 25px; margin-left: 6px; display: -webkit-flex;display: flex;flex-flow: row;align-items: center;\">\r\n                    <img style=\"width: 25px; height: 20px;\" src=\"` + lineImageUrl + `\">\r\n                </div>\r\n            </div>\r\n            `;\r\n            let label = new window.BMap.Label(div);\r\n            label.setStyle({'padding': '5px 10px', 'color': 'white', 'background-color': '#3988d4', 'border': '0px', 'border-radius': '3px', 'transform': 'translate(calc(-50% + 11px), calc(-100% - 2px))'});\r\n            marker.setLabel(label);\r\n\r\n            marker.addEventListener('click', ()=>{\r\n                this.markerTapped();\r\n            });\r\n            label.addEventListener('click', ()=>{\r\n                this.markerTapped();\r\n            });\r\n\r\n            this.map.addOverlay(marker);\r\n        }\r\n    }\r\n    markerTapped()\r\n    {\r\n        this.setMapZoomAndCenterLocation();\r\n        //导航点击\r\n        this.props.history.push(`/map/mapNav/${this.props.match.params.code}/${this.lat}/${this.lng}`);\r\n    }\r\n\r\n    updateWindowDimensions()\r\n    {\r\n        const height = window.innerHeight - ReactDOM.findDOMNode(this).parentNode.offsetTop;\r\n        this.setState({ mapHeight: height }, ()=>{\r\n            if (this.props.baiduMapInited)\r\n            {\r\n                this.initMap();\r\n            }\r\n        });\r\n    }\r\n\r\n    // 保存 地图中心点 和 缩放级\r\n    setMapZoomAndCenterLocation()\r\n    {\r\n        if (!this.map)\r\n        {\r\n            return;\r\n        }\r\n        let centerPoint = this.map.getCenter();\r\n        let mapZoom = this.map.getZoom();\r\n        let centerLat = centerPoint.lat;\r\n        let centerLng = centerPoint.lng;\r\n        this.props.dispatch(mapZoomAndCenterLocationChangeAction(this.props.match.params.code,mapZoom,centerLat,centerLng));\r\n    }\r\n}\r\n\r\nconst mapStateToProps = function(state, ownProps)\r\n{\r\n    let obj = state.map.elementMarker[ownProps.match.params.code];\r\n    return {\r\n        ...obj,\r\n        baiduMapInited: state.system.baiduMapInited,\r\n    };\r\n};\r\n\r\nElementMarkerScreen = connect(mapStateToProps)(ElementMarkerScreen);\r\n\r\nexport default ElementMarkerScreen;\n\n\n// WEBPACK FOOTER //\n// ./src/screens/map/ElementMarkerScreen.js","import * as IConstant from '../../../core/utils/IConstant';\r\n\r\nexport function goBackAction(code)\r\n{\r\n    return {\r\n        type: IConstant.Actions.MAP.ELEMENTMARKER.GO_BACK,\r\n        code:code\r\n    };\r\n}\r\n\r\nexport function mapZoomAndCenterLocationChangeAction(code,mapZoom,centerLat,centerLng)\r\n{\r\n    return function(dispatch, getState)\r\n    {\r\n        dispatch(_mapZoomAndCenterLocationChangeAction(code,mapZoom,centerLat,centerLng));\r\n        return new Promise((resolve)=>{\r\n            resolve();\r\n        });\r\n    };\r\n    \r\n}\r\n\r\nfunction _mapZoomAndCenterLocationChangeAction(code,mapZoom,centerLat,centerLng)\r\n{\r\n    return {\r\n        type: IConstant.Actions.MAP.ELEMENTMARKER.MAPZOOM_AND_CENTERLOCATION_CHANGE,\r\n        code:code,\r\n        mapZoom:mapZoom,\r\n        centerLat: centerLat,\r\n        centerLng: centerLng\r\n    };\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/store/actions/map/elementMarkerAction.js","module.exports = __webpack_public_path__ + \"static/media/icon_line.489cc7de.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/images/map/icon_line.png\n// module id = 913\n// module chunks = 8"],"sourceRoot":""}